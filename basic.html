<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.8.26">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="description" content="Fundamental Python utilities for data manipulation, type checking, and common operations">

<title>Basic – pote</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
html { -webkit-text-size-adjust: 100%; }
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<script src="site_libs/quarto-html/quarto.js" type="module"></script>
<script src="site_libs/quarto-html/tabsets/tabsets.js" type="module"></script>
<script src="site_libs/quarto-html/axe/axe-check.js" type="module"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting-587c61ba64f3a5504c4d52d930310e48.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap-000f0825b9c55ed21d14970d810c14a9.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>


<link rel="stylesheet" href="styles.css">
<meta property="og:title" content="Basic – pote">
<meta property="og:description" content="Fundamental Python utilities for data manipulation, type checking, and common operations">
<meta property="og:site_name" content="pote">
<meta name="twitter:title" content="Basic – pote">
<meta name="twitter:description" content="Fundamental Python utilities for data manipulation, type checking, and common operations">
<meta name="twitter:card" content="summary">
</head>

<body class="nav-sidebar floating nav-fixed quarto-light">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg " data-bs-theme="dark">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a class="navbar-brand" href="./index.html">
    <span class="navbar-title">pote</span>
    </a>
  </div>
        <div class="quarto-navbar-tools tools-end">
</div>
          <div id="quarto-search" class="" title="Search"></div>
      </div> <!-- /container-fluid -->
    </nav>
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" role="button" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./basic.html">Basic</a></li></ol></nav>
        <a class="flex-grow-1" role="navigation" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation floating overflow-auto">
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">pote</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./basic.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text">Basic</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./project.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Project</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./logger_loguru.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">logger_loguru</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./test.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Test helpers</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./callback.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Callback</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./config.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Config</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./display.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Display</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./widgets.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Widgets</span></a>
  </div>
</li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#type-utilities" id="toc-type-utilities" class="nav-link active" data-scroll-target="#type-utilities">Type Utilities</a>
  <ul class="collapse">
  <li><a href="#empty" id="toc-empty" class="nav-link" data-scroll-target="#empty">empty</a>
  <ul class="collapse">
  <li><a href="#is_empty" id="toc-is_empty" class="nav-link" data-scroll-target="#is_empty">is_empty</a></li>
  </ul></li>
  </ul></li>
  <li><a href="#data-structures" id="toc-data-structures" class="nav-link" data-scroll-target="#data-structures">Data Structures</a>
  <ul class="collapse">
  <li><a href="#ad" id="toc-ad" class="nav-link" data-scroll-target="#ad">AD</a>
  <ul class="collapse">
  <li><a href="#ad-1" id="toc-ad-1" class="nav-link" data-scroll-target="#ad-1">AD</a></li>
  </ul></li>
  <li><a href="#is_listy" id="toc-is_listy" class="nav-link" data-scroll-target="#is_listy">is_listy</a>
  <ul class="collapse">
  <li><a href="#is_listy_type" id="toc-is_listy_type" class="nav-link" data-scroll-target="#is_listy_type">is_listy_type</a></li>
  <li><a href="#is_listy-1" id="toc-is_listy-1" class="nav-link" data-scroll-target="#is_listy-1">is_listy</a></li>
  </ul></li>
  <li><a href="#flatten" id="toc-flatten" class="nav-link" data-scroll-target="#flatten">flatten</a>
  <ul class="collapse">
  <li><a href="#flatten-1" id="toc-flatten-1" class="nav-link" data-scroll-target="#flatten-1">flatten</a></li>
  </ul></li>
  <li><a href="#almost-dataclass" id="toc-almost-dataclass" class="nav-link" data-scroll-target="#almost-dataclass">Almost dataclass</a>
  <ul class="collapse">
  <li><a href="#fields" id="toc-fields" class="nav-link" data-scroll-target="#fields">Fields</a></li>
  </ul></li>
  </ul></li>
  <li><a href="#string-utilities" id="toc-string-utilities" class="nav-link" data-scroll-target="#string-utilities">String Utilities</a>
  <ul class="collapse">
  <li><a href="#shorten" id="toc-shorten" class="nav-link" data-scroll-target="#shorten">shorten</a>
  <ul class="collapse">
  <li><a href="#shortens" id="toc-shortens" class="nav-link" data-scroll-target="#shortens">shortens</a></li>
  <li><a href="#shorten-1" id="toc-shorten-1" class="nav-link" data-scroll-target="#shorten-1">shorten</a></li>
  </ul></li>
  </ul></li>
  <li><a href="#function-composition" id="toc-function-composition" class="nav-link" data-scroll-target="#function-composition">Function Composition</a>
  <ul class="collapse">
  <li><a href="#runner" id="toc-runner" class="nav-link" data-scroll-target="#runner">Runner</a>
  <ul class="collapse">
  <li><a href="#runner-1" id="toc-runner-1" class="nav-link" data-scroll-target="#runner-1">Runner</a></li>
  </ul></li>
  </ul></li>
  <li><a href="#object-utilities" id="toc-object-utilities" class="nav-link" data-scroll-target="#object-utilities">Object Utilities</a>
  <ul class="collapse">
  <li><a href="#setattrs" id="toc-setattrs" class="nav-link" data-scroll-target="#setattrs">setattrs</a>
  <ul class="collapse">
  <li><a href="#setattrs-1" id="toc-setattrs-1" class="nav-link" data-scroll-target="#setattrs-1">setattrs</a></li>
  </ul></li>
  <li><a href="#val_at---implementation-evolution" id="toc-val_at---implementation-evolution" class="nav-link" data-scroll-target="#val_at---implementation-evolution">val_at - Implementation Evolution</a>
  <ul class="collapse">
  <li><a href="#initial-attempt-simple-dict-only-version" id="toc-initial-attempt-simple-dict-only-version" class="nav-link" data-scroll-target="#initial-attempt-simple-dict-only-version">Initial attempt: Simple dict-only version</a></li>
  </ul></li>
  <li><a href="#vals_at---implementation-evolution" id="toc-vals_at---implementation-evolution" class="nav-link" data-scroll-target="#vals_at---implementation-evolution">vals_at - Implementation Evolution</a>
  <ul class="collapse">
  <li><a href="#early-wildcard-implementation" id="toc-early-wildcard-implementation" class="nav-link" data-scroll-target="#early-wildcard-implementation">Early wildcard implementation</a></li>
  </ul></li>
  </ul></li>
  <li><a href="#nested-data-access" id="toc-nested-data-access" class="nav-link" data-scroll-target="#nested-data-access">Nested Data Access</a>
  <ul class="collapse">
  <li><a href="#val_at-val_atpath" id="toc-val_at-val_atpath" class="nav-link" data-scroll-target="#val_at-val_atpath">val_at, val_atpath</a>
  <ul class="collapse">
  <li><a href="#has_path" id="toc-has_path" class="nav-link" data-scroll-target="#has_path">has_path</a></li>
  <li><a href="#has_key" id="toc-has_key" class="nav-link" data-scroll-target="#has_key">has_key</a></li>
  <li><a href="#val_atpath" id="toc-val_atpath" class="nav-link" data-scroll-target="#val_atpath">val_atpath</a></li>
  <li><a href="#at_" id="toc-at_" class="nav-link" data-scroll-target="#at_">at_</a></li>
  </ul></li>
  <li><a href="#vals_at-vals_atpath" id="toc-vals_at-vals_atpath" class="nav-link" data-scroll-target="#vals_at-vals_atpath">vals_at, vals_atpath</a>
  <ul class="collapse">
  <li><a href="#vals_at" id="toc-vals_at" class="nav-link" data-scroll-target="#vals_at">vals_at</a></li>
  <li><a href="#vals_atpath" id="toc-vals_atpath" class="nav-link" data-scroll-target="#vals_atpath">vals_atpath</a></li>
  </ul></li>
  <li><a href="#deep_in" id="toc-deep_in" class="nav-link" data-scroll-target="#deep_in">deep_in</a>
  <ul class="collapse">
  <li><a href="#performance-exploration" id="toc-performance-exploration" class="nav-link" data-scroll-target="#performance-exploration">Performance exploration</a></li>
  <li><a href="#deep_in-1" id="toc-deep_in-1" class="nav-link" data-scroll-target="#deep_in-1">deep_in</a></li>
  </ul></li>
  </ul></li>
  <li><a href="#dictionary-helpers" id="toc-dictionary-helpers" class="nav-link" data-scroll-target="#dictionary-helpers">Dictionary Helpers</a>
  <ul class="collapse">
  <li><a href="#pops_" id="toc-pops_" class="nav-link" data-scroll-target="#pops_">pops_</a>
  <ul class="collapse">
  <li><a href="#pops_-1" id="toc-pops_-1" class="nav-link" data-scroll-target="#pops_-1">pops_</a></li>
  </ul></li>
  <li><a href="#pops_values_" id="toc-pops_values_" class="nav-link" data-scroll-target="#pops_values_">pops_values_</a>
  <ul class="collapse">
  <li><a href="#pops_values_-1" id="toc-pops_values_-1" class="nav-link" data-scroll-target="#pops_values_-1">pops_values_</a></li>
  </ul></li>
  <li><a href="#gets" id="toc-gets" class="nav-link" data-scroll-target="#gets">gets</a>
  <ul class="collapse">
  <li><a href="#gets-1" id="toc-gets-1" class="nav-link" data-scroll-target="#gets-1">gets</a></li>
  </ul></li>
  <li><a href="#update_" id="toc-update_" class="nav-link" data-scroll-target="#update_">update_</a>
  <ul class="collapse">
  <li><a href="#update_-1" id="toc-update_-1" class="nav-link" data-scroll-target="#update_-1">update_</a></li>
  </ul></li>
  </ul></li>
  <li><a href="#get_globals" id="toc-get_globals" class="nav-link" data-scroll-target="#get_globals">_get_globals</a></li>
  <li><a href="#path-utilities" id="toc-path-utilities" class="nav-link" data-scroll-target="#path-utilities">Path Utilities</a>
  <ul class="collapse">
  <li><a href="#bundle_path" id="toc-bundle_path" class="nav-link" data-scroll-target="#bundle_path">bundle_path</a>
  <ul class="collapse">
  <li><a href="#bundle_path-1" id="toc-bundle_path-1" class="nav-link" data-scroll-target="#bundle_path-1">bundle_path</a></li>
  </ul></li>
  </ul></li>
  <li><a href="#id-generation" id="toc-id-generation" class="nav-link" data-scroll-target="#id-generation">ID Generation</a>
  <ul class="collapse">
  <li><a href="#kounter" id="toc-kounter" class="nav-link" data-scroll-target="#kounter">Kounter</a>
  <ul class="collapse">
  <li><a href="#kounter-1" id="toc-kounter-1" class="nav-link" data-scroll-target="#kounter-1">Kounter</a></li>
  </ul></li>
  <li><a href="#id_gen" id="toc-id_gen" class="nav-link" data-scroll-target="#id_gen">id_gen</a>
  <ul class="collapse">
  <li><a href="#id_gen-1" id="toc-id_gen-1" class="nav-link" data-scroll-target="#id_gen-1">id_gen</a></li>
  <li><a href="#simple_id" id="toc-simple_id" class="nav-link" data-scroll-target="#simple_id">simple_id</a></li>
  </ul></li>
  </ul></li>
  <li><a href="#metaclasses" id="toc-metaclasses" class="nav-link" data-scroll-target="#metaclasses">Metaclasses</a>
  <ul class="collapse">
  <li><a href="#withcountermeta" id="toc-withcountermeta" class="nav-link" data-scroll-target="#withcountermeta">WithCounterMeta</a>
  <ul class="collapse">
  <li><a href="#withcountermeta-1" id="toc-withcountermeta-1" class="nav-link" data-scroll-target="#withcountermeta-1">WithCounterMeta</a></li>
  </ul></li>
  </ul></li>
  </ul>
<div class="toc-actions"><ul><li><a href="https://github.com/civvic/pote/issues/new" class="toc-action"><i class="bi bi-github"></i>Report an issue</a></li></ul></div><div class="quarto-alternate-formats"><h2>Other Formats</h2><ul><li><a href="basic.html.md"><i class="bi bi-file-code"></i>CommonMark</a></li></ul></div></nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Basic</h1>
</div>

<div>
  <div class="description">
    Fundamental Python utilities for data manipulation, type checking, and common operations
  </div>
</div>


<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<!-- WARNING: THIS FILE WAS AUTOGENERATED! DO NOT EDIT! -->
<!-- # Prologue -->
<hr>
<section id="type-utilities" class="level1">
<h1>Type Utilities</h1>
<section id="empty" class="level2">
<h2 class="anchored" data-anchor-id="empty">empty</h2>
<p>A sentinel value for distinguishing “no value provided” from <code>None</code>. Useful in function signatures where <code>None</code> is a valid argument.</p>
<hr>
<p><a href="https://github.com/civvic/pote/blob/main/pote/basic.py#L51" target="_blank" style="float:right; font-size:smaller">source</a></p>
<section id="is_empty" class="level3">
<h3 class="anchored" data-anchor-id="is_empty">is_empty</h3>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb1"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> is_empty(</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a>    x</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a>)<span class="op">-&gt;</span><span class="bu">bool</span>:</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div id="249ca952" class="cell" data-quarto-private-1="{&quot;key&quot;:&quot;brd&quot;,&quot;value&quot;:{&quot;id&quot;:&quot;e23796b6-d20b-4b6e-a233-cb17e0b1e17b&quot;}}" data-execution_count="8">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb2"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a>test_is(<span class="bu">str</span>(empty), <span class="st">'empty'</span>)</span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>empty</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-display" data-execution_count="8">
<pre><code>empty</code></pre>
</div>
</div>
<div id="1a0a79d4" class="cell" data-quarto-private-1="{&quot;key&quot;:&quot;brd&quot;,&quot;value&quot;:{&quot;id&quot;:&quot;3f65821e-4e38-4971-94cb-612bba4091bc&quot;}}" data-execution_count="9">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb4"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> test_empty() <span class="op">-&gt;</span> Empty: <span class="cf">return</span> empty</span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>test_eq_type(test_empty(), empty)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
</section>
</section>
</section>
<section id="data-structures" class="level1">
<h1>Data Structures</h1>
<section id="ad" class="level2">
<h2 class="anchored" data-anchor-id="ad">AD</h2>
<p>Attribute Dict - a dictionary that also allows attribute-style access. Perfect for configuration objects or API responses where you want both <code>config['key']</code> and <code>config.key</code> syntax.</p>
<hr>
<p><a href="https://github.com/civvic/pote/blob/main/pote/basic.py#L56" target="_blank" style="float:right; font-size:smaller">source</a></p>
<section id="ad-1" class="level3">
<h3 class="anchored" data-anchor-id="ad-1">AD</h3>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb5"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> AD(</span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a>    args:VAR_POSITIONAL, kwargs:VAR_KEYWORD</span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a>):</span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<p><em><code>dict</code> subclass that also provides access to keys as attrs</em></p>
<div id="bd027281" class="cell" data-quarto-private-1="{&quot;key&quot;:&quot;brd&quot;,&quot;value&quot;:{&quot;id&quot;:&quot;e845be52-e806-4694-83f3-d847713cd7d1&quot;}}" data-execution_count="11">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb6"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Basic usage: dict and attribute access</span></span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>ad <span class="op">=</span> AD(a<span class="op">=</span><span class="dv">1</span>, b<span class="op">=</span><span class="dv">2</span>)</span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a>test_eq(ad.a, <span class="dv">1</span>)</span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a>test_eq(ad[<span class="st">'a'</span>], <span class="dv">1</span>)</span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-6"><a href="#cb6-6" aria-hidden="true" tabindex="-1"></a>ad.b <span class="op">=</span> <span class="dv">3</span></span>
<span id="cb6-7"><a href="#cb6-7" aria-hidden="true" tabindex="-1"></a>test_eq(ad.b, <span class="dv">3</span>)</span>
<span id="cb6-8"><a href="#cb6-8" aria-hidden="true" tabindex="-1"></a>ad.update(a<span class="op">=</span><span class="dv">4</span>, b<span class="op">=</span><span class="dv">5</span>)</span>
<span id="cb6-9"><a href="#cb6-9" aria-hidden="true" tabindex="-1"></a>test_eq(ad.b, <span class="dv">5</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<div id="42aee333" class="cell" data-quarto-private-1="{&quot;key&quot;:&quot;brd&quot;,&quot;value&quot;:{&quot;id&quot;:&quot;cfcccdda-2ce8-4783-be0e-72b1101c26d2&quot;}}" data-execution_count="12">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb7"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Edge cases: empty dict, missing keys</span></span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a>ad <span class="op">=</span> AD()</span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a>test_fail(<span class="kw">lambda</span>: ad.a)</span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a>test_fail(<span class="kw">lambda</span>: ad[<span class="st">'b'</span>])</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
</section>
</section>
<section id="is_listy" class="level2">
<h2 class="anchored" data-anchor-id="is_listy">is_listy</h2>
<p>Test whether <code>x</code> is iterable but not a string or bytes. Useful for duck-typing checks where you want to handle collections but not strings.</p>
<hr>
<p><a href="https://github.com/civvic/pote/blob/main/pote/basic.py#L68" target="_blank" style="float:right; font-size:smaller">source</a></p>
<section id="is_listy_type" class="level3">
<h3 class="anchored" data-anchor-id="is_listy_type">is_listy_type</h3>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb8"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> is_listy_type(</span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a>    x</span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a>):</span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<hr>
<p><a href="https://github.com/civvic/pote/blob/main/pote/basic.py#L65" target="_blank" style="float:right; font-size:smaller">source</a></p>
</section>
<section id="is_listy-1" class="level3">
<h3 class="anchored" data-anchor-id="is_listy-1">is_listy</h3>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb9"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> is_listy(</span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a>    x</span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a>):</span>
<span id="cb9-5"><a href="#cb9-5" aria-hidden="true" tabindex="-1"></a></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div id="c764b96b" class="cell" data-quarto-private-1="{&quot;key&quot;:&quot;brd&quot;,&quot;value&quot;:{&quot;id&quot;:&quot;4d92adcf-07d0-4b0b-9290-f0ee3aedce25&quot;}}" data-execution_count="14">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb10"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Common usage: distinguish collections from strings</span></span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a>test_is(is_listy([<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>]), <span class="va">True</span>)</span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a>test_is(is_listy((<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>)), <span class="va">True</span>)</span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a>test_is(is_listy({<span class="st">'a'</span>: <span class="dv">1</span>}), <span class="va">True</span>)</span>
<span id="cb10-5"><a href="#cb10-5" aria-hidden="true" tabindex="-1"></a>test_is(is_listy(<span class="st">'hello'</span>), <span class="va">False</span>)  <span class="co"># strings are NOT listy</span></span>
<span id="cb10-6"><a href="#cb10-6" aria-hidden="true" tabindex="-1"></a>test_is(is_listy(<span class="st">b'bytes'</span>), <span class="va">False</span>)  <span class="co"># bytes are NOT listy</span></span>
<span id="cb10-7"><a href="#cb10-7" aria-hidden="true" tabindex="-1"></a>test_is(is_listy(<span class="va">None</span>), <span class="va">False</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<div id="4a8a3c25" class="cell" data-quarto-private-1="{&quot;key&quot;:&quot;brd&quot;,&quot;value&quot;:{&quot;id&quot;:&quot;a0c6d559-0756-4bb6-8a07-24f4e5d3aed8&quot;}}" data-execution_count="15">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb11"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Coverage: ranges, generators, and type checking</span></span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a>test_is(is_listy(<span class="bu">range</span>(<span class="dv">3</span>)), <span class="va">True</span>)</span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a>test_is(is_listy((i <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">3</span>))), <span class="va">True</span>)</span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a>test_is(is_listy(FC.L(<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>)), <span class="va">True</span>)</span>
<span id="cb11-5"><a href="#cb11-5" aria-hidden="true" tabindex="-1"></a>test_is(is_listy({<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>}), <span class="va">True</span>)</span>
<span id="cb11-6"><a href="#cb11-6" aria-hidden="true" tabindex="-1"></a>test_is(is_listy(<span class="vs">r'raw string'</span>), <span class="va">False</span>)</span>
<span id="cb11-7"><a href="#cb11-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-8"><a href="#cb11-8" aria-hidden="true" tabindex="-1"></a>test_is(is_listy_type(<span class="bu">list</span>), <span class="va">True</span>)</span>
<span id="cb11-9"><a href="#cb11-9" aria-hidden="true" tabindex="-1"></a>test_is(is_listy_type(<span class="bu">tuple</span>), <span class="va">True</span>)</span>
<span id="cb11-10"><a href="#cb11-10" aria-hidden="true" tabindex="-1"></a>test_is(is_listy_type(<span class="bu">dict</span>), <span class="va">True</span>)</span>
<span id="cb11-11"><a href="#cb11-11" aria-hidden="true" tabindex="-1"></a>test_is(is_listy_type(<span class="bu">str</span>), <span class="va">False</span>)</span>
<span id="cb11-12"><a href="#cb11-12" aria-hidden="true" tabindex="-1"></a>test_is(is_listy_type(NoneType), <span class="va">False</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
</section>
</section>
<section id="flatten" class="level2">
<h2 class="anchored" data-anchor-id="flatten">flatten</h2>
<p>Recursively flatten nested collections into a single generator. Unlike <code>itertools.chain</code>, handles arbitrarily nested structures.</p>
<hr>
<p><a href="https://github.com/civvic/pote/blob/main/pote/basic.py#L72" target="_blank" style="float:right; font-size:smaller">source</a></p>
<section id="flatten-1" class="level3">
<h3 class="anchored" data-anchor-id="flatten-1">flatten</h3>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb12"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> flatten(</span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a>    o</span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a>):</span>
<span id="cb12-5"><a href="#cb12-5" aria-hidden="true" tabindex="-1"></a></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<p><em>Concatenate all collections and items as a generator</em></p>
<div id="f8855caf" class="cell" data-quarto-private-1="{&quot;key&quot;:&quot;brd&quot;,&quot;value&quot;:{&quot;id&quot;:&quot;a687de07-b15d-4257-8f31-7526af3c5c7d&quot;}}" data-execution_count="17">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb13"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Basic usage: flatten arbitrarily nested structures</span></span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a>test_eq(<span class="bu">list</span>(flatten([<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>])), [<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>])  <span class="co"># already flat</span></span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a>test_eq(<span class="bu">list</span>(flatten([<span class="dv">1</span>, [<span class="dv">2</span>, <span class="dv">3</span>]])), [<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>])</span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a>test_eq(<span class="bu">list</span>(flatten([[<span class="dv">1</span>], [<span class="dv">2</span>], [<span class="dv">3</span>]])), [<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>])</span>
<span id="cb13-5"><a href="#cb13-5" aria-hidden="true" tabindex="-1"></a>test_eq(<span class="bu">list</span>(flatten((<span class="dv">1</span>, (<span class="dv">2</span>, <span class="dv">3</span>)))), [<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>])  <span class="co"># works with tuples</span></span>
<span id="cb13-6"><a href="#cb13-6" aria-hidden="true" tabindex="-1"></a>test_eq(<span class="bu">list</span>(flatten([(<span class="st">'a'</span>, (<span class="dv">2</span>,)), (<span class="st">'c'</span>, (<span class="dv">4</span>,))])), [<span class="st">'a'</span>, <span class="dv">2</span>, <span class="st">'c'</span>, <span class="dv">4</span>])</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<div id="f589bb36" class="cell" data-quarto-private-1="{&quot;key&quot;:&quot;brd&quot;,&quot;value&quot;:{&quot;id&quot;:&quot;2735b85c-0f77-4c7b-9a32-12fbd32c49ff&quot;}}" data-execution_count="18">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb14"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Coverage: empty list</span></span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a>test_eq(<span class="bu">list</span>(flatten([])), [])</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
</section>
</section>
<section id="almost-dataclass" class="level2">
<h2 class="anchored" data-anchor-id="almost-dataclass">Almost dataclass</h2>
<p>A dataclass that allows you to specify fields with default values.</p>
<div id="d498447b" class="cell" data-quarto-private-1="{&quot;key&quot;:&quot;brd&quot;,&quot;value&quot;:{&quot;id&quot;:&quot;cac1f453-6454-4ff6-bfdf-01ef4cd378ab&quot;}}" data-execution_count="19">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb15"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> _flds(o, <span class="op">*</span>args): <span class="cf">return</span> <span class="bu">tuple</span>(_ <span class="cf">for</span> _ <span class="kw">in</span> inspect.get_annotations(o).keys())<span class="op">+</span>args</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<div id="e8743c6b" class="cell" data-quarto-private-1="{&quot;key&quot;:&quot;brd&quot;,&quot;value&quot;:{&quot;id&quot;:&quot;4d966437-3c2f-4501-9c21-35feebac97c4&quot;}}" data-execution_count="20">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb16"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="kw">class</span> A:</span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a>    a: <span class="bu">str</span></span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a>    b: <span class="bu">str</span></span>
<span id="cb16-4"><a href="#cb16-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-5"><a href="#cb16-5" aria-hidden="true" tabindex="-1"></a>_flds(A), _flds(A, <span class="st">'c'</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-display" data-execution_count="20">
<pre><code>(('a', 'b'), ('a', 'b', 'c'))</code></pre>
</div>
</div>
<div id="3bc4bb5a" class="cell" data-quarto-private-1="{&quot;key&quot;:&quot;brd&quot;,&quot;value&quot;:{&quot;id&quot;:&quot;4df32e86-6272-40e4-b06e-e72e1f097713&quot;}}" data-execution_count="22">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb18"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a>_flds(A)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-display" data-execution_count="22">
<pre><code>()</code></pre>
</div>
</div>
<hr>
<p><a href="https://github.com/civvic/pote/blob/main/pote/basic.py#L84" target="_blank" style="float:right; font-size:smaller">source</a></p>
<section id="fields" class="level3">
<h3 class="anchored" data-anchor-id="fields">Fields</h3>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb20"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> Fields(</span>
<span id="cb20-3"><a href="#cb20-3" aria-hidden="true" tabindex="-1"></a>    args:VAR_POSITIONAL, <span class="co"># type: ignore</span></span>
<span id="cb20-4"><a href="#cb20-4" aria-hidden="true" tabindex="-1"></a>    but:<span class="bu">str</span><span class="op">=</span><span class="st">''</span>, cast:<span class="bu">bool</span><span class="op">=</span><span class="va">False</span>, store_args:NoneType<span class="op">=</span><span class="va">None</span></span>
<span id="cb20-5"><a href="#cb20-5" aria-hidden="true" tabindex="-1"></a>):</span>
<span id="cb20-6"><a href="#cb20-6" aria-hidden="true" tabindex="-1"></a></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<p><em>Set annotated fields of <code>self</code> extracted from caller’s locals; <code>*args</code> -&gt; optional (None), <code>**kwargs</code> -&gt; defaults</em></p>
<div id="2ac17f14" class="cell" data-quarto-private-1="{&quot;key&quot;:&quot;brd&quot;,&quot;value&quot;:{&quot;id&quot;:&quot;1e200871-f31b-4dde-8534-a49ba75c2119&quot;}}" data-execution_count="24">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb21"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a><span class="kw">class</span> A:</span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a>    a: <span class="bu">str</span></span>
<span id="cb21-3"><a href="#cb21-3" aria-hidden="true" tabindex="-1"></a>    b: <span class="bu">str</span></span>
<span id="cb21-4"><a href="#cb21-4" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> <span class="fu">__init__</span>(<span class="va">self</span>, a:<span class="bu">str</span>,  b:<span class="bu">str</span>, c<span class="op">=</span><span class="va">None</span>, d<span class="op">=</span><span class="st">'ff'</span>): Fields(<span class="st">'e'</span>, f<span class="op">=</span><span class="fl">7.3</span>)<span class="co">#FC.store_attr(_flds(self), c=None, d=7.3)</span></span>
<span id="cb21-5"><a href="#cb21-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-6"><a href="#cb21-6" aria-hidden="true" tabindex="-1"></a>o <span class="op">=</span> A(<span class="st">'aa'</span>, <span class="st">'bb'</span>)</span>
<span id="cb21-7"><a href="#cb21-7" aria-hidden="true" tabindex="-1"></a><span class="co"># test_eq(vars(o)['__stored_args__'], {'e': None, 'a': 'aa', 'b': 'bb', 'c': None, 'd': 'ff', 'f': 7.3})</span></span>
<span id="cb21-8"><a href="#cb21-8" aria-hidden="true" tabindex="-1"></a>test_eq(A.__fields__, (<span class="st">'a'</span>, <span class="st">'b'</span>, <span class="st">'c'</span>, <span class="st">'d'</span>, <span class="st">'e'</span>, <span class="st">'f'</span>))  <span class="co"># type: ignore</span></span>
<span id="cb21-9"><a href="#cb21-9" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(inspect.signature(A))</span>
<span id="cb21-10"><a href="#cb21-10" aria-hidden="true" tabindex="-1"></a><span class="bu">vars</span>(o)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>(a: 'str', b: 'str', c=None, d='ff')</code></pre>
</div>
<div class="cell-output cell-output-display" data-execution_count="24">
<pre><code>{'a': 'aa', 'b': 'bb', 'c': None, 'd': 'ff', 'e': None, 'f': 7.3}</code></pre>
</div>
</div>
<div id="9bec5367" class="cell" data-quarto-private-1="{&quot;key&quot;:&quot;brd&quot;,&quot;value&quot;:{&quot;id&quot;:&quot;e5ccb737-6c97-4c94-921b-da14b78a7748&quot;}}" data-execution_count="25">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb24"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a><span class="kw">class</span> Chapter(FC.AttrDict):</span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a>    <span class="co">"A chapter of a book"</span></span>
<span id="cb24-3"><a href="#cb24-3" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> <span class="fu">__init__</span>(<span class="va">self</span>, num:<span class="bu">int</span>, lines:<span class="bu">slice</span>, title:<span class="bu">str</span>, pov:<span class="bu">str</span>, content:<span class="bu">str</span>): Fields(ids<span class="op">=</span>{})</span>
<span id="cb24-4"><a href="#cb24-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">@property</span></span>
<span id="cb24-5"><a href="#cb24-5" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> meta(<span class="va">self</span>): <span class="cf">return</span> [<span class="va">self</span>[_] <span class="cf">for</span> _ <span class="kw">in</span> <span class="bu">type</span>(<span class="va">self</span>).__fields__ <span class="cf">if</span> _ <span class="kw">not</span> <span class="kw">in</span> (<span class="st">'ids'</span>, <span class="st">'content'</span>)]  <span class="co"># type: ignore</span></span>
<span id="cb24-6"><a href="#cb24-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">@property</span></span>
<span id="cb24-7"><a href="#cb24-7" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> text(<span class="va">self</span>):</span>
<span id="cb24-8"><a href="#cb24-8" aria-hidden="true" tabindex="-1"></a>        r <span class="op">=</span> <span class="va">self</span>.lines</span>
<span id="cb24-9"><a href="#cb24-9" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> <span class="st">'/n'</span>.join(lines[r.start:r.stop])  <span class="co"># type: ignore</span></span>
<span id="cb24-10"><a href="#cb24-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-11"><a href="#cb24-11" aria-hidden="true" tabindex="-1"></a>_ch <span class="op">=</span> Chapter(<span class="dv">1</span>, <span class="bu">slice</span>(<span class="dv">0</span>, <span class="dv">10</span>), <span class="st">'title'</span>, <span class="st">'pov'</span>, <span class="st">'contents'</span>)</span>
<span id="cb24-12"><a href="#cb24-12" aria-hidden="true" tabindex="-1"></a>_ch</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-display cell-output-markdown" data-execution_count="25">
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb25"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a>{ <span class="st">'content'</span>: <span class="st">'contents'</span>,</span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a>  <span class="st">'ids'</span>: {},</span>
<span id="cb25-3"><a href="#cb25-3" aria-hidden="true" tabindex="-1"></a>  <span class="st">'lines'</span>: <span class="bu">slice</span>(<span class="dv">0</span>, <span class="dv">10</span>, <span class="va">None</span>),</span>
<span id="cb25-4"><a href="#cb25-4" aria-hidden="true" tabindex="-1"></a>  <span class="st">'num'</span>: <span class="dv">1</span>,</span>
<span id="cb25-5"><a href="#cb25-5" aria-hidden="true" tabindex="-1"></a>  <span class="st">'pov'</span>: <span class="st">'pov'</span>,</span>
<span id="cb25-6"><a href="#cb25-6" aria-hidden="true" tabindex="-1"></a>  <span class="st">'title'</span>: <span class="st">'title'</span>}</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
</div>
<div id="339051f7" class="cell" data-quarto-private-1="{&quot;key&quot;:&quot;brd&quot;,&quot;value&quot;:{&quot;id&quot;:&quot;0ce5a15e-7178-4ea8-b6a4-4e515c90d2bb&quot;}}" data-execution_count="26">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb26"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a>inspect.signature(Chapter)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-display" data-execution_count="26">
<pre><code>&lt;Signature (num: 'int', lines: 'slice', title: 'str', pov: 'str', content: 'str')&gt;</code></pre>
</div>
</div>
<div id="f38a7923" class="cell" data-quarto-private-1="{&quot;key&quot;:&quot;brd&quot;,&quot;value&quot;:{&quot;id&quot;:&quot;289bc90e-c357-4a85-94b0-23c790bd993b&quot;}}" data-execution_count="27">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb28"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a>_ch.meta</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-display" data-execution_count="27">
<pre><code>[1, slice(0, 10, None), 'title', 'pov']</code></pre>
</div>
</div>
<div id="d41ba199" class="cell" data-quarto-private-1="{&quot;key&quot;:&quot;brd&quot;,&quot;value&quot;:{&quot;id&quot;:&quot;47b6f888-14fd-4ab8-a838-70c6be3bba89&quot;}}" data-execution_count="28">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb30"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a><span class="kw">class</span> Book(<span class="bu">list</span>):</span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true" tabindex="-1"></a>    <span class="co">"A book"</span></span>
<span id="cb30-3"><a href="#cb30-3" aria-hidden="true" tabindex="-1"></a>    title: <span class="bu">str</span></span>
<span id="cb30-4"><a href="#cb30-4" aria-hidden="true" tabindex="-1"></a>    author: <span class="bu">str</span></span>
<span id="cb30-5"><a href="#cb30-5" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> <span class="fu">__init__</span>(<span class="va">self</span>, title,  author): Fields()</span>
<span id="cb30-6"><a href="#cb30-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">@property</span></span>
<span id="cb30-7"><a href="#cb30-7" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> front_matter(<span class="va">self</span>): <span class="cf">return</span> FC.AttrDict({k:<span class="bu">getattr</span>(<span class="va">self</span>, k) <span class="cf">for</span> k <span class="kw">in</span> (<span class="st">'title'</span>, <span class="st">'author'</span>)})</span>
<span id="cb30-8"><a href="#cb30-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">@property</span></span>
<span id="cb30-9"><a href="#cb30-9" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> body(<span class="va">self</span>) <span class="op">-&gt;</span> Sequence[Chapter]: <span class="cf">return</span> <span class="bu">tuple</span>(<span class="op">*</span><span class="va">self</span>)</span>
<span id="cb30-10"><a href="#cb30-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-11"><a href="#cb30-11" aria-hidden="true" tabindex="-1"></a>bk <span class="op">=</span> Book(<span class="st">'Tiempo Atrás'</span>, <span class="st">'Rafael Marín'</span>)</span>
<span id="cb30-12"><a href="#cb30-12" aria-hidden="true" tabindex="-1"></a>bk, bk.front_matter, bk.body</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-display" data-execution_count="28">
<pre><code>([], {'title': 'Tiempo Atrás', 'author': 'Rafael Marín'}, ())</code></pre>
</div>
</div>
</section>
</section>
</section>
<section id="string-utilities" class="level1">
<h1>String Utilities</h1>
<section id="shorten" class="level2">
<h2 class="anchored" data-anchor-id="shorten">shorten</h2>
<p>Truncate strings intelligently from left, right, or center. Useful for displaying long identifiers, paths, or data in logs and UIs.</p>
<hr>
<p><a href="https://github.com/civvic/pote/blob/main/pote/basic.py#L107" target="_blank" style="float:right; font-size:smaller">source</a></p>
<section id="shortens" class="level3">
<h3 class="anchored" data-anchor-id="shortens">shortens</h3>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb32"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-2"><a href="#cb32-2" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> shortens(</span>
<span id="cb32-3"><a href="#cb32-3" aria-hidden="true" tabindex="-1"></a>    xs:Iterable[Any], mode:Literal[<span class="st">'l'</span>, <span class="st">'r'</span>, <span class="st">'c'</span>]<span class="op">=</span><span class="st">'l'</span>, limit:<span class="bu">int</span><span class="op">=</span><span class="dv">40</span>, trunc:<span class="bu">str</span><span class="op">=</span><span class="st">'…'</span>, empty:<span class="bu">str</span><span class="op">=</span><span class="st">''</span></span>
<span id="cb32-4"><a href="#cb32-4" aria-hidden="true" tabindex="-1"></a>):</span>
<span id="cb32-5"><a href="#cb32-5" aria-hidden="true" tabindex="-1"></a></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<hr>
<p><a href="https://github.com/civvic/pote/blob/main/pote/basic.py#L97" target="_blank" style="float:right; font-size:smaller">source</a></p>
</section>
<section id="shorten-1" class="level3">
<h3 class="anchored" data-anchor-id="shorten-1">shorten</h3>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb33"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-2"><a href="#cb33-2" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> shorten(</span>
<span id="cb33-3"><a href="#cb33-3" aria-hidden="true" tabindex="-1"></a>    x:Any, mode:Literal[<span class="st">'l'</span>, <span class="st">'r'</span>, <span class="st">'c'</span>]<span class="op">=</span><span class="st">'l'</span>, limit:<span class="bu">int</span><span class="op">=</span><span class="dv">40</span>, trunc:<span class="bu">str</span><span class="op">=</span><span class="st">'…'</span>, empty:<span class="bu">str</span><span class="op">=</span><span class="st">''</span></span>
<span id="cb33-4"><a href="#cb33-4" aria-hidden="true" tabindex="-1"></a>)<span class="op">-&gt;</span><span class="bu">str</span>:</span>
<span id="cb33-5"><a href="#cb33-5" aria-hidden="true" tabindex="-1"></a></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div id="540ab910" class="cell" data-quarto-private-1="{&quot;key&quot;:&quot;brd&quot;,&quot;value&quot;:{&quot;id&quot;:&quot;b82f8d54-ef02-4d74-986c-2471e3850b00&quot;}}" data-execution_count="30">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb34"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Basic usage: truncate from left (default), right, or center</span></span>
<span id="cb34-2"><a href="#cb34-2" aria-hidden="true" tabindex="-1"></a>uuid <span class="op">=</span> <span class="st">'ad2663b4-5ff5-40e3-a6ed-cc35f5627f8d'</span></span>
<span id="cb34-3"><a href="#cb34-3" aria-hidden="true" tabindex="-1"></a>test_eq(shorten(uuid, limit<span class="op">=</span><span class="dv">17</span>), <span class="st">'…a6ed-cc35f5627f8d'</span>)  <span class="co"># left truncation (default)</span></span>
<span id="cb34-4"><a href="#cb34-4" aria-hidden="true" tabindex="-1"></a>test_eq(shorten(uuid, <span class="st">'r'</span>, limit<span class="op">=</span><span class="dv">17</span>), <span class="st">'ad2663b4-5ff5-40e…'</span>)  <span class="co"># right truncation</span></span>
<span id="cb34-5"><a href="#cb34-5" aria-hidden="true" tabindex="-1"></a>test_eq(shorten(uuid, <span class="st">'c'</span>, limit<span class="op">=</span><span class="dv">17</span>), <span class="st">'ad2663b … 5627f8d'</span>)  <span class="co"># center truncation</span></span>
<span id="cb34-6"><a href="#cb34-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-7"><a href="#cb34-7" aria-hidden="true" tabindex="-1"></a>test_eq(shorten(<span class="st">'It was the best of times'</span>, limit<span class="op">=</span><span class="dv">12</span>), <span class="st">'…est of times'</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<div id="d0d5399a" class="cell" data-quarto-private-1="{&quot;key&quot;:&quot;brd&quot;,&quot;value&quot;:{&quot;id&quot;:&quot;6be48cdc-6194-457a-b4b0-0ea8863acaef&quot;}}" data-execution_count="31">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb35"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Coverage: short strings (no truncation), numbers, empty</span></span>
<span id="cb35-2"><a href="#cb35-2" aria-hidden="true" tabindex="-1"></a>test_eq(shorten(<span class="dv">0</span>), <span class="st">'0'</span>)</span>
<span id="cb35-3"><a href="#cb35-3" aria-hidden="true" tabindex="-1"></a>test_eq(shorten(<span class="dv">234</span>), <span class="st">'234'</span>)</span>
<span id="cb35-4"><a href="#cb35-4" aria-hidden="true" tabindex="-1"></a>test_eq(shorten(<span class="st">'asdfgh'</span>), <span class="st">'asdfgh'</span>)  <span class="co"># under limit, no change</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<div id="156c3491" class="cell" data-quarto-private-1="{&quot;key&quot;:&quot;brd&quot;,&quot;value&quot;:{&quot;id&quot;:&quot;00e46849-8190-44c0-9cea-0f29e55b2fa0&quot;}}" data-execution_count="32">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb36"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a>test_eq(<span class="bu">list</span>(shortens([<span class="st">'ad2663b4-5ff5-40e3-a6ed-cc35f5627f8d'</span>], <span class="st">'l'</span>, <span class="dv">10</span>)), [<span class="st">'…35f5627f8d'</span>])</span>
<span id="cb36-2"><a href="#cb36-2" aria-hidden="true" tabindex="-1"></a>test_eq(<span class="bu">list</span>(shortens((<span class="st">'abcdef'</span>, <span class="st">'wertyu'</span>, <span class="st">'sd'</span>), <span class="st">'r'</span>, <span class="dv">4</span>)), [<span class="st">'abcd…'</span>, <span class="st">'wert…'</span>, <span class="st">'sd'</span>])</span>
<span id="cb36-3"><a href="#cb36-3" aria-hidden="true" tabindex="-1"></a>test_eq(<span class="st">''</span>.join(shortens(<span class="st">'It was the best of times...'</span>.split(), <span class="st">'r'</span>, <span class="dv">1</span>, <span class="st">''</span>)), <span class="st">'Iwtbot'</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
</section>
</section>
</section>
<section id="function-composition" class="level1">
<h1>Function Composition</h1>
<section id="runner" class="level2">
<h2 class="anchored" data-anchor-id="runner">Runner</h2>
<p>Create a function that runs multiple callables in sequence with the same arguments. Useful for side-effects like logging, validation, and updates without explicit chaining.</p>
<hr>
<p><a href="https://github.com/civvic/pote/blob/main/pote/basic.py#L114" target="_blank" style="float:right; font-size:smaller">source</a></p>
<section id="runner-1" class="level3">
<h3 class="anchored" data-anchor-id="runner-1">Runner</h3>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb37"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-2"><a href="#cb37-2" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> Runner(</span>
<span id="cb37-3"><a href="#cb37-3" aria-hidden="true" tabindex="-1"></a>    fns:_FuncItem</span>
<span id="cb37-4"><a href="#cb37-4" aria-hidden="true" tabindex="-1"></a>)<span class="op">-&gt;</span>Callable:</span>
<span id="cb37-5"><a href="#cb37-5" aria-hidden="true" tabindex="-1"></a></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<p><em>Return a function that runs callables <code>fns</code> in sequence with same arguments. </em> Only side-effects, no composition.</p>
<div id="d8058f63" class="cell" data-quarto-private-1="{&quot;key&quot;:&quot;brd&quot;,&quot;value&quot;:{&quot;id&quot;:&quot;d6350d54-b1b6-4041-a40f-c1cd65e1eaae&quot;}}" data-execution_count="34">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb38"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> f1(o,x,y<span class="op">=</span><span class="dv">0</span>): o.r <span class="op">+=</span> x<span class="op">+</span>y</span>
<span id="cb38-2"><a href="#cb38-2" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> f2(o,x,y<span class="op">=</span><span class="dv">0</span>): o.r <span class="op">+=</span> x<span class="op">*</span>y</span>
<span id="cb38-3"><a href="#cb38-3" aria-hidden="true" tabindex="-1"></a>f3 <span class="op">=</span> <span class="kw">lambda</span> o, x,y: <span class="bu">print</span>(o.r)</span>
<span id="cb38-4"><a href="#cb38-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-5"><a href="#cb38-5" aria-hidden="true" tabindex="-1"></a>o <span class="op">=</span> SimpleNamespace(r<span class="op">=</span><span class="dv">0</span>)</span>
<span id="cb38-6"><a href="#cb38-6" aria-hidden="true" tabindex="-1"></a>runner <span class="op">=</span> Runner(f1, f2, f3)</span>
<span id="cb38-7"><a href="#cb38-7" aria-hidden="true" tabindex="-1"></a>runner(o, <span class="dv">2</span>, <span class="dv">3</span>)  <span class="co"># 11</span></span>
<span id="cb38-8"><a href="#cb38-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-9"><a href="#cb38-9" aria-hidden="true" tabindex="-1"></a>Runner()(o, <span class="dv">2</span>, <span class="dv">3</span>)</span>
<span id="cb38-10"><a href="#cb38-10" aria-hidden="true" tabindex="-1"></a>test_eq(o.r, <span class="dv">11</span>)</span>
<span id="cb38-11"><a href="#cb38-11" aria-hidden="true" tabindex="-1"></a>Runner([f1, f2], f3)(o, <span class="dv">2</span>, <span class="dv">3</span>)</span>
<span id="cb38-12"><a href="#cb38-12" aria-hidden="true" tabindex="-1"></a>test_eq(o.r, <span class="dv">22</span>)</span>
<span id="cb38-13"><a href="#cb38-13" aria-hidden="true" tabindex="-1"></a>Runner([f1, [f2, f3]])(o, <span class="dv">2</span>, <span class="dv">3</span>)</span>
<span id="cb38-14"><a href="#cb38-14" aria-hidden="true" tabindex="-1"></a>test_eq(o.r, <span class="dv">33</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>11
22
33</code></pre>
</div>
</div>
</section>
</section>
</section>
<section id="object-utilities" class="level1">
<h1>Object Utilities</h1>
<p>Helpers for manipulating objects and their attributes.</p>
<section id="setattrs" class="level2">
<h2 class="anchored" data-anchor-id="setattrs">setattrs</h2>
<p>Copy attributes from one object/dict to another. Works bidirectionally: can copy from dict→object, object→dict, object→object, or dict→dict.</p>
<p><strong>Common use cases:</strong> - Initialize objects from configuration dicts - Copy specific fields between instances - Hydrate objects from API responses</p>
<p><strong>Parameters:</strong> - <code>dest</code>: Target object or dict to set attributes on - <code>src</code>: Source object or dict to read from - <code>flds</code>: Comma-separated field names (optional; defaults to all keys/public attrs)</p>
<hr>
<p><a href="https://github.com/civvic/pote/blob/main/pote/basic.py#L125" target="_blank" style="float:right; font-size:smaller">source</a></p>
<section id="setattrs-1" class="level3">
<h3 class="anchored" data-anchor-id="setattrs-1">setattrs</h3>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb40"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-2"><a href="#cb40-2" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> setattrs(</span>
<span id="cb40-3"><a href="#cb40-3" aria-hidden="true" tabindex="-1"></a>    dest, src, flds:<span class="bu">str</span><span class="op">=</span><span class="st">''</span></span>
<span id="cb40-4"><a href="#cb40-4" aria-hidden="true" tabindex="-1"></a>):</span>
<span id="cb40-5"><a href="#cb40-5" aria-hidden="true" tabindex="-1"></a></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<p><em>Set <code>flds</code> or keys() or dir() attributes from <code>src</code> into <code>dest</code></em></p>
<div id="ff566d05" class="cell" data-quarto-private-1="{&quot;key&quot;:&quot;brd&quot;,&quot;value&quot;:{&quot;id&quot;:&quot;7be96f33-33fe-4f4d-a578-70d8e868794f&quot;}}" data-execution_count="36">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb41"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a><span class="kw">class</span> A: a <span class="op">=</span> <span class="dv">1</span><span class="op">;</span> b <span class="op">=</span> <span class="dv">2</span><span class="op">;</span> c <span class="op">=</span> <span class="dv">3</span></span>
<span id="cb41-2"><a href="#cb41-2" aria-hidden="true" tabindex="-1"></a>a <span class="op">=</span> A()</span>
<span id="cb41-3"><a href="#cb41-3" aria-hidden="true" tabindex="-1"></a>setattrs(a, {<span class="st">'b'</span>: <span class="dv">22</span>, <span class="st">'d'</span>: <span class="dv">44</span>})</span>
<span id="cb41-4"><a href="#cb41-4" aria-hidden="true" tabindex="-1"></a>test_eq(a.a, <span class="dv">1</span>)</span>
<span id="cb41-5"><a href="#cb41-5" aria-hidden="true" tabindex="-1"></a>test_eq(a.b, <span class="dv">22</span>)</span>
<span id="cb41-6"><a href="#cb41-6" aria-hidden="true" tabindex="-1"></a>test_eq(a.c, <span class="dv">3</span>)</span>
<span id="cb41-7"><a href="#cb41-7" aria-hidden="true" tabindex="-1"></a>test_eq(a.d, <span class="dv">44</span>)  <span class="co"># type: ignore</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
</section>
</section>
<section id="val_at---implementation-evolution" class="level2 hidden">
<h2 class="hidden anchored" data-anchor-id="val_at---implementation-evolution">val_at - Implementation Evolution</h2>
<p>The following cells document the development process of <code>val_at</code>, showing how the implementation evolved to handle increasingly complex cases (dicts → lists → mixed → JSON strings). This section is preserved for design rationale but can be skipped by most users.</p>
<p><strong>Skip to <a href="#nested-data-access">Nested Data Access</a> if you just want to use the function.</strong></p>
<section id="initial-attempt-simple-dict-only-version" class="level3">
<h3 class="anchored" data-anchor-id="initial-attempt-simple-dict-only-version">Initial attempt: Simple dict-only version</h3>
<div id="de570a37" class="cell" data-quarto-private-1="{&quot;key&quot;:&quot;brd&quot;,&quot;value&quot;:{&quot;id&quot;:&quot;f3baca7e-24c1-467a-902d-fc330555199d&quot;}}" data-execution_count="37">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb42"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> val_at(element, json):</span>
<span id="cb42-2"><a href="#cb42-2" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="bu">reduce</span>(operator.getitem, element.split(<span class="st">'.'</span>), json)</span>
<span id="cb42-3"><a href="#cb42-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-4"><a href="#cb42-4" aria-hidden="true" tabindex="-1"></a>j <span class="op">=</span> {<span class="st">"app"</span>: {</span>
<span id="cb42-5"><a href="#cb42-5" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Garden"</span>: {</span>
<span id="cb42-6"><a href="#cb42-6" aria-hidden="true" tabindex="-1"></a>        <span class="st">"Flowers"</span>: {</span>
<span id="cb42-7"><a href="#cb42-7" aria-hidden="true" tabindex="-1"></a>            <span class="st">"Red flower"</span>: <span class="st">"Rose"</span>,</span>
<span id="cb42-8"><a href="#cb42-8" aria-hidden="true" tabindex="-1"></a>            <span class="st">"White Flower"</span>: <span class="st">"Jasmine"</span>,</span>
<span id="cb42-9"><a href="#cb42-9" aria-hidden="true" tabindex="-1"></a>            <span class="st">"Yellow Flower"</span>: <span class="st">"Marigold"</span></span>
<span id="cb42-10"><a href="#cb42-10" aria-hidden="true" tabindex="-1"></a>        }</span>
<span id="cb42-11"><a href="#cb42-11" aria-hidden="true" tabindex="-1"></a>    },</span>
<span id="cb42-12"><a href="#cb42-12" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Fruits"</span>: {</span>
<span id="cb42-13"><a href="#cb42-13" aria-hidden="true" tabindex="-1"></a>        <span class="st">"Yellow fruit"</span>: <span class="st">"Mango"</span>,</span>
<span id="cb42-14"><a href="#cb42-14" aria-hidden="true" tabindex="-1"></a>        <span class="st">"Green fruit"</span>: <span class="st">"Guava"</span>,</span>
<span id="cb42-15"><a href="#cb42-15" aria-hidden="true" tabindex="-1"></a>        <span class="st">"White Flower"</span>: <span class="st">"groovy"</span></span>
<span id="cb42-16"><a href="#cb42-16" aria-hidden="true" tabindex="-1"></a>    },</span>
<span id="cb42-17"><a href="#cb42-17" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Trees"</span>: {</span>
<span id="cb42-18"><a href="#cb42-18" aria-hidden="true" tabindex="-1"></a>        <span class="st">"label"</span>: {</span>
<span id="cb42-19"><a href="#cb42-19" aria-hidden="true" tabindex="-1"></a>            <span class="st">"Yellow fruit"</span>: <span class="st">"Pumpkin"</span>,</span>
<span id="cb42-20"><a href="#cb42-20" aria-hidden="true" tabindex="-1"></a>            <span class="st">"White Flower"</span>: <span class="st">"Bogan"</span></span>
<span id="cb42-21"><a href="#cb42-21" aria-hidden="true" tabindex="-1"></a>        }</span>
<span id="cb42-22"><a href="#cb42-22" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb42-23"><a href="#cb42-23" aria-hidden="true" tabindex="-1"></a>}}</span>
<span id="cb42-24"><a href="#cb42-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-25"><a href="#cb42-25" aria-hidden="true" tabindex="-1"></a>test_eq(val_at(<span class="st">'app.Garden.Flowers.White Flower'</span>, j), <span class="st">'Jasmine'</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<div id="234f9ca4" class="cell" data-quarto-private-1="{&quot;key&quot;:&quot;brd&quot;,&quot;value&quot;:{&quot;id&quot;:&quot;832f371b-ef8a-45f1-99cf-370f14501894&quot;}}" data-execution_count="38">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb43"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb43-1"><a href="#cb43-1" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>((dp <span class="op">:=</span> <span class="st">'app.Garden.Flowers'</span>), <span class="bu">reduce</span>(operator.getitem, dp.split(<span class="st">'.'</span>), j))</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>app.Garden.Flowers {'Red flower': 'Rose', 'White Flower': 'Jasmine', 'Yellow Flower': 'Marigold'}</code></pre>
</div>
</div>
<div id="dee07976" class="cell" data-quarto-private-1="{&quot;key&quot;:&quot;brd&quot;,&quot;value&quot;:{&quot;id&quot;:&quot;6c58821b-9d85-4243-bf99-8ad2de0baa7a&quot;}}" data-execution_count="39">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb45"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb45-1"><a href="#cb45-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> val_at(element, j:<span class="bu">str</span>):</span>
<span id="cb45-2"><a href="#cb45-2" aria-hidden="true" tabindex="-1"></a>    d <span class="op">=</span> json.loads(j)</span>
<span id="cb45-3"><a href="#cb45-3" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="bu">reduce</span>(<span class="kw">lambda</span> d, k: d[k] <span class="cf">if</span> <span class="bu">isinstance</span>(d, Mapping) <span class="cf">else</span> d[<span class="bu">int</span>(k)], element.split(<span class="st">'.'</span>), d)</span>
<span id="cb45-4"><a href="#cb45-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-5"><a href="#cb45-5" aria-hidden="true" tabindex="-1"></a>j2 <span class="op">=</span> {<span class="st">"app"</span>: {</span>
<span id="cb45-6"><a href="#cb45-6" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Garden"</span>: {</span>
<span id="cb45-7"><a href="#cb45-7" aria-hidden="true" tabindex="-1"></a>        <span class="st">"Flowers"</span>: {</span>
<span id="cb45-8"><a href="#cb45-8" aria-hidden="true" tabindex="-1"></a>            <span class="st">"Red flower"</span>: <span class="st">"Rose"</span>,</span>
<span id="cb45-9"><a href="#cb45-9" aria-hidden="true" tabindex="-1"></a>            <span class="st">"White Flower"</span>: <span class="st">"Jasmine"</span>,</span>
<span id="cb45-10"><a href="#cb45-10" aria-hidden="true" tabindex="-1"></a>            <span class="st">"Yellow Flower"</span>: <span class="st">"Marigold"</span></span>
<span id="cb45-11"><a href="#cb45-11" aria-hidden="true" tabindex="-1"></a>        }</span>
<span id="cb45-12"><a href="#cb45-12" aria-hidden="true" tabindex="-1"></a>    },</span>
<span id="cb45-13"><a href="#cb45-13" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Fruits"</span>: {</span>
<span id="cb45-14"><a href="#cb45-14" aria-hidden="true" tabindex="-1"></a>        <span class="st">"Yellow fruit"</span>: [<span class="st">"Mango"</span>, {<span class="st">"Banana"</span>: [<span class="st">"Canary Island"</span>, <span class="st">"Puerto Rico"</span>]}],</span>
<span id="cb45-15"><a href="#cb45-15" aria-hidden="true" tabindex="-1"></a>        <span class="st">"Green fruit"</span>: <span class="st">"Guava"</span>,</span>
<span id="cb45-16"><a href="#cb45-16" aria-hidden="true" tabindex="-1"></a>        <span class="st">"White Flower"</span>: <span class="st">"groovy"</span></span>
<span id="cb45-17"><a href="#cb45-17" aria-hidden="true" tabindex="-1"></a>    },</span>
<span id="cb45-18"><a href="#cb45-18" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Trees"</span>: {</span>
<span id="cb45-19"><a href="#cb45-19" aria-hidden="true" tabindex="-1"></a>        <span class="st">"label"</span>: {</span>
<span id="cb45-20"><a href="#cb45-20" aria-hidden="true" tabindex="-1"></a>            <span class="st">"Yellow fruit"</span>: <span class="st">"Pumpkin"</span>,</span>
<span id="cb45-21"><a href="#cb45-21" aria-hidden="true" tabindex="-1"></a>            <span class="st">"White Flower"</span>: <span class="st">"Bogan"</span></span>
<span id="cb45-22"><a href="#cb45-22" aria-hidden="true" tabindex="-1"></a>        }</span>
<span id="cb45-23"><a href="#cb45-23" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb45-24"><a href="#cb45-24" aria-hidden="true" tabindex="-1"></a>}}</span>
<span id="cb45-25"><a href="#cb45-25" aria-hidden="true" tabindex="-1"></a>test_eq(val_at(<span class="st">'app.Fruits.Yellow fruit.1.Banana.0'</span>, json.dumps(j2)), <span class="st">'Canary Island'</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<div id="a130078c" class="cell" data-quarto-private-1="{&quot;key&quot;:&quot;brd&quot;,&quot;value&quot;:{&quot;id&quot;:&quot;a1ef2b11-1da0-412c-982e-3e8da91f8353&quot;}}" data-execution_count="40">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb46"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb46-1"><a href="#cb46-1" aria-hidden="true" tabindex="-1"></a>apollo_astronauts <span class="op">=</span> json.loads(Path(<span class="st">'static/apollo_astronauts.json'</span>).read_text())</span>
<span id="cb46-2"><a href="#cb46-2" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>((dp <span class="op">:=</span> <span class="st">'Apollo 11.Michael Collins'</span>), <span class="bu">reduce</span>(operator.getitem, dp.split(<span class="st">'.'</span>), apollo_astronauts))</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>Apollo 11.Michael Collins {'Experience': 'Pilot on Gemini 10 and Command Module pilot on Apollo 11.', 'Place in history': 'Collins was the first person to perform two EVAs in one mission.', 'Fast fact': 'Collins says his "secret terror" was returning to Earth alone if the surface mission failed.', 'Lunar wisdom': 'I really believe that if the political leaders of the world could see their planet from a distance of 100,000 miles their outlook could be fundamentally changed. That all-important border would be invisible, that noisy argument silenced.'}</code></pre>
</div>
</div>
<div id="3b4f8465" class="cell" data-quarto-private-1="{&quot;key&quot;:&quot;brd&quot;,&quot;value&quot;:{&quot;id&quot;:&quot;0f1606ae-c833-4a30-bea4-2e8e3ab6301d&quot;}}" data-execution_count="41">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb48"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb48-1"><a href="#cb48-1" aria-hidden="true" tabindex="-1"></a>_T <span class="op">=</span> TypeVar(<span class="st">'_T'</span>)</span>
<span id="cb48-2"><a href="#cb48-2" aria-hidden="true" tabindex="-1"></a>_II <span class="op">=</span> <span class="bu">isinstance</span></span>
<span id="cb48-3"><a href="#cb48-3" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> _at(d: Mapping<span class="op">|</span>Sequence, k: <span class="bu">str</span>) <span class="op">-&gt;</span> Any: <span class="cf">return</span> (</span>
<span id="cb48-4"><a href="#cb48-4" aria-hidden="true" tabindex="-1"></a>    d[k] <span class="cf">if</span> _II(d, Mapping) <span class="cf">else</span> </span>
<span id="cb48-5"><a href="#cb48-5" aria-hidden="true" tabindex="-1"></a>    d[<span class="bu">int</span>(k)] <span class="cf">if</span> _II(d, Sequence) <span class="kw">and</span> <span class="kw">not</span> _II(d, (<span class="bu">str</span>, <span class="bu">bytes</span>)) <span class="cf">else</span> </span>
<span id="cb48-6"><a href="#cb48-6" aria-hidden="true" tabindex="-1"></a>    FC.stop(<span class="pp">KeyError</span>))  <span class="co"># type: ignore</span></span>
<span id="cb48-7"><a href="#cb48-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-8"><a href="#cb48-8" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> val_at(key_path: <span class="bu">str</span>, j: Mapping<span class="op">|</span>Sequence<span class="op">|</span><span class="bu">str</span><span class="op">|</span><span class="bu">bytes</span><span class="op">|</span><span class="bu">bytearray</span>, default:_T<span class="op">=</span>empty, sep:<span class="bu">str</span><span class="op">=</span><span class="st">'.'</span>) <span class="op">-&gt;</span> _T:</span>
<span id="cb48-9"><a href="#cb48-9" aria-hidden="true" tabindex="-1"></a>    <span class="co">"Return nested value at `key_path` from `j`. Raise if not found or `default` if not `empty`."</span></span>
<span id="cb48-10"><a href="#cb48-10" aria-hidden="true" tabindex="-1"></a>    <span class="cf">try</span>: <span class="cf">return</span> <span class="bu">reduce</span>(_at, key_path.split(sep), json.loads(j) <span class="cf">if</span> _II(j, (<span class="bu">str</span>, <span class="bu">bytes</span>, <span class="bu">bytearray</span>)) <span class="cf">else</span> j)</span>
<span id="cb48-11"><a href="#cb48-11" aria-hidden="true" tabindex="-1"></a>    <span class="cf">except</span> (<span class="pp">KeyError</span>, <span class="pp">IndexError</span>, <span class="pp">ValueError</span>) <span class="im">as</span> e:</span>
<span id="cb48-12"><a href="#cb48-12" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> default <span class="kw">is</span> <span class="kw">not</span> empty: <span class="cf">return</span> default</span>
<span id="cb48-13"><a href="#cb48-13" aria-hidden="true" tabindex="-1"></a>        <span class="cf">raise</span> e</span>
<span id="cb48-14"><a href="#cb48-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-15"><a href="#cb48-15" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> key_at(key_path: <span class="bu">str</span>, j: Mapping<span class="op">|</span>Sequence<span class="op">|</span><span class="bu">str</span><span class="op">|</span><span class="bu">bytes</span><span class="op">|</span><span class="bu">bytearray</span>, sep:<span class="bu">str</span><span class="op">=</span><span class="st">'.'</span>) <span class="op">-&gt;</span> <span class="bu">bool</span>:</span>
<span id="cb48-16"><a href="#cb48-16" aria-hidden="true" tabindex="-1"></a>    <span class="co">"Return `True` if nested `key_path` exists in `j`."</span></span>
<span id="cb48-17"><a href="#cb48-17" aria-hidden="true" tabindex="-1"></a>    <span class="cf">try</span>:</span>
<span id="cb48-18"><a href="#cb48-18" aria-hidden="true" tabindex="-1"></a>        <span class="bu">reduce</span>(_at, key_path.split(sep), json.loads(j) <span class="cf">if</span> _II(j, (<span class="bu">str</span>, <span class="bu">bytes</span>, <span class="bu">bytearray</span>)) <span class="cf">else</span> j)</span>
<span id="cb48-19"><a href="#cb48-19" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> <span class="va">True</span></span>
<span id="cb48-20"><a href="#cb48-20" aria-hidden="true" tabindex="-1"></a>    <span class="cf">except</span> (<span class="pp">KeyError</span>, <span class="pp">IndexError</span>):</span>
<span id="cb48-21"><a href="#cb48-21" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> <span class="va">False</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<div id="b13be48b" class="cell" data-quarto-private-1="{&quot;key&quot;:&quot;brd&quot;,&quot;value&quot;:{&quot;id&quot;:&quot;26499cca-d8da-43f3-982f-b2b257b37621&quot;}}" data-execution_count="42">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb49"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb49-1"><a href="#cb49-1" aria-hidden="true" tabindex="-1"></a>FC.test_fail(<span class="kw">lambda</span>: val_at(<span class="bu">object</span>, {}))  <span class="co"># type: ignore</span></span>
<span id="cb49-2"><a href="#cb49-2" aria-hidden="true" tabindex="-1"></a>FC.test_fail(<span class="kw">lambda</span>: val_at(<span class="bu">object</span>, []))  <span class="co"># type: ignore</span></span>
<span id="cb49-3"><a href="#cb49-3" aria-hidden="true" tabindex="-1"></a>FC.test_fail(<span class="kw">lambda</span>: val_at(<span class="bu">object</span>, <span class="bu">object</span>))  <span class="co"># type: ignore</span></span>
<span id="cb49-4"><a href="#cb49-4" aria-hidden="true" tabindex="-1"></a>FC.test_fail(<span class="kw">lambda</span>: val_at(<span class="st">''</span>, {}))</span>
<span id="cb49-5"><a href="#cb49-5" aria-hidden="true" tabindex="-1"></a>FC.test_fail(<span class="kw">lambda</span>: val_at(<span class="st">''</span>, []))</span>
<span id="cb49-6"><a href="#cb49-6" aria-hidden="true" tabindex="-1"></a>FC.test_fail(<span class="kw">lambda</span>: val_at(<span class="st">''</span>, <span class="bu">object</span>))   <span class="co"># type: ignore</span></span>
<span id="cb49-7"><a href="#cb49-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-8"><a href="#cb49-8" aria-hidden="true" tabindex="-1"></a>FC.test_fail(<span class="kw">lambda</span>: val_at(<span class="st">'a.b'</span>, {<span class="st">'a'</span>: <span class="dv">1</span>}))</span>
<span id="cb49-9"><a href="#cb49-9" aria-hidden="true" tabindex="-1"></a>test_eq(val_at(<span class="st">'a.b'</span>, {<span class="st">'a'</span>: <span class="dv">1</span>}, <span class="va">None</span>), <span class="va">None</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<div id="5166346b" class="cell" data-quarto-private-1="{&quot;key&quot;:&quot;brd&quot;,&quot;value&quot;:{&quot;id&quot;:&quot;288986b1-597d-48ab-944a-6c224d9993a3&quot;}}" data-execution_count="43">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb50"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb50-1"><a href="#cb50-1" aria-hidden="true" tabindex="-1"></a>d <span class="op">=</span> [</span>
<span id="cb50-2"><a href="#cb50-2" aria-hidden="true" tabindex="-1"></a>    {<span class="st">'a'</span>: <span class="dv">1</span>, <span class="st">'b'</span>: [<span class="dv">2</span>,  <span class="dv">3</span>], <span class="st">'c'</span>: {<span class="st">'d'</span>:   <span class="dv">4</span>}}, </span>
<span id="cb50-3"><a href="#cb50-3" aria-hidden="true" tabindex="-1"></a>    {<span class="st">'a'</span>: <span class="dv">5</span>, <span class="st">'b'</span>: [<span class="dv">6</span>,  <span class="dv">7</span>],                 <span class="st">'d'</span>: [{<span class="st">'e'</span>: <span class="dv">81</span>}, {<span class="st">'e'</span>: <span class="dv">82</span>}]}, </span>
<span id="cb50-4"><a href="#cb50-4" aria-hidden="true" tabindex="-1"></a>    {<span class="st">'a'</span>: <span class="dv">9</span>, <span class="st">'b'</span>: [<span class="dv">10</span>, <span class="dv">11</span>], <span class="st">'c'</span>: {<span class="st">'d'</span>: <span class="dv">12</span>}}</span>
<span id="cb50-5"><a href="#cb50-5" aria-hidden="true" tabindex="-1"></a>]</span>
<span id="cb50-6"><a href="#cb50-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-7"><a href="#cb50-7" aria-hidden="true" tabindex="-1"></a>test_fail(<span class="kw">lambda</span>: val_at(<span class="st">''</span>, d))</span>
<span id="cb50-8"><a href="#cb50-8" aria-hidden="true" tabindex="-1"></a>test_fail(<span class="kw">lambda</span>: val_at(<span class="bu">object</span>, d))  <span class="co"># type: ignore</span></span>
<span id="cb50-9"><a href="#cb50-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-10"><a href="#cb50-10" aria-hidden="true" tabindex="-1"></a>test_fail(<span class="kw">lambda</span>: val_at(<span class="st">''</span>, <span class="bu">object</span>))  <span class="co"># type: ignore</span></span>
<span id="cb50-11"><a href="#cb50-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-12"><a href="#cb50-12" aria-hidden="true" tabindex="-1"></a>test_eq(val_at(<span class="st">'0.a'</span>, d), <span class="dv">1</span>)</span>
<span id="cb50-13"><a href="#cb50-13" aria-hidden="true" tabindex="-1"></a>test_eq(val_at(<span class="st">'1.b'</span>, d), [<span class="dv">6</span>, <span class="dv">7</span>])</span>
<span id="cb50-14"><a href="#cb50-14" aria-hidden="true" tabindex="-1"></a>test_eq(val_at(<span class="st">'2.c'</span>, d), {<span class="st">'d'</span>: <span class="dv">12</span>})</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<div id="6176ec6b" class="cell" data-quarto-private-1="{&quot;key&quot;:&quot;brd&quot;,&quot;value&quot;:{&quot;id&quot;:&quot;c0053746-e9ea-404f-880f-10363db7fd63&quot;}}" data-execution_count="44">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb51"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb51-1"><a href="#cb51-1" aria-hidden="true" tabindex="-1"></a>j2 <span class="op">=</span> {</span>
<span id="cb51-2"><a href="#cb51-2" aria-hidden="true" tabindex="-1"></a>    <span class="st">"app"</span>: {</span>
<span id="cb51-3"><a href="#cb51-3" aria-hidden="true" tabindex="-1"></a>        <span class="st">"Garden"</span>: {</span>
<span id="cb51-4"><a href="#cb51-4" aria-hidden="true" tabindex="-1"></a>            <span class="st">"Flowers"</span>: {</span>
<span id="cb51-5"><a href="#cb51-5" aria-hidden="true" tabindex="-1"></a>                <span class="st">"Red flower"</span>: <span class="st">"Rose"</span>,</span>
<span id="cb51-6"><a href="#cb51-6" aria-hidden="true" tabindex="-1"></a>                <span class="st">"White Flower"</span>: <span class="st">"Jasmine"</span>,</span>
<span id="cb51-7"><a href="#cb51-7" aria-hidden="true" tabindex="-1"></a>                <span class="st">"Yellow Flower"</span>: <span class="st">"Marigold"</span></span>
<span id="cb51-8"><a href="#cb51-8" aria-hidden="true" tabindex="-1"></a>            }</span>
<span id="cb51-9"><a href="#cb51-9" aria-hidden="true" tabindex="-1"></a>        },</span>
<span id="cb51-10"><a href="#cb51-10" aria-hidden="true" tabindex="-1"></a>        <span class="st">"Fruits"</span>: {</span>
<span id="cb51-11"><a href="#cb51-11" aria-hidden="true" tabindex="-1"></a>            <span class="st">"Yellow fruit"</span>: [<span class="st">"Mango"</span>, {<span class="st">"Banana"</span>: [<span class="st">"Canary Island"</span>, <span class="st">"Puerto Rico"</span>]}],</span>
<span id="cb51-12"><a href="#cb51-12" aria-hidden="true" tabindex="-1"></a>            <span class="st">"Green fruit"</span>: <span class="st">"Guava"</span>,</span>
<span id="cb51-13"><a href="#cb51-13" aria-hidden="true" tabindex="-1"></a>            <span class="st">"White Flower"</span>: <span class="st">"groovy"</span></span>
<span id="cb51-14"><a href="#cb51-14" aria-hidden="true" tabindex="-1"></a>        },</span>
<span id="cb51-15"><a href="#cb51-15" aria-hidden="true" tabindex="-1"></a>        <span class="st">"Trees"</span>: {</span>
<span id="cb51-16"><a href="#cb51-16" aria-hidden="true" tabindex="-1"></a>            <span class="st">"label"</span>: {</span>
<span id="cb51-17"><a href="#cb51-17" aria-hidden="true" tabindex="-1"></a>                <span class="st">"Yellow fruit"</span>: <span class="st">"Pumpkin"</span>,</span>
<span id="cb51-18"><a href="#cb51-18" aria-hidden="true" tabindex="-1"></a>                <span class="st">"White Flower"</span>: <span class="st">"Bogan"</span></span>
<span id="cb51-19"><a href="#cb51-19" aria-hidden="true" tabindex="-1"></a>            }</span>
<span id="cb51-20"><a href="#cb51-20" aria-hidden="true" tabindex="-1"></a>        },</span>
<span id="cb51-21"><a href="#cb51-21" aria-hidden="true" tabindex="-1"></a>        <span class="st">"Numbers"</span>: [<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">4</span>, <span class="dv">5</span>],</span>
<span id="cb51-22"><a href="#cb51-22" aria-hidden="true" tabindex="-1"></a>        <span class="st">"Boolean"</span>: <span class="va">True</span>,</span>
<span id="cb51-23"><a href="#cb51-23" aria-hidden="true" tabindex="-1"></a>        <span class="st">"Null"</span>: <span class="va">None</span></span>
<span id="cb51-24"><a href="#cb51-24" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb51-25"><a href="#cb51-25" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb51-26"><a href="#cb51-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-27"><a href="#cb51-27" aria-hidden="true" tabindex="-1"></a>j2_str <span class="op">=</span> json.dumps(j2)</span>
<span id="cb51-28"><a href="#cb51-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-29"><a href="#cb51-29" aria-hidden="true" tabindex="-1"></a>test_eq(val_at(<span class="st">'app.Fruits.Yellow fruit.1.Banana.0'</span>, j2_str), <span class="st">'Canary Island'</span>)</span>
<span id="cb51-30"><a href="#cb51-30" aria-hidden="true" tabindex="-1"></a>test_eq(val_at(<span class="st">'app.Garden.Flowers.Red flower'</span>, j2_str), <span class="st">'Rose'</span>)</span>
<span id="cb51-31"><a href="#cb51-31" aria-hidden="true" tabindex="-1"></a>test_eq(val_at(<span class="st">'app.Numbers.2'</span>, j2_str), <span class="dv">3</span>)</span>
<span id="cb51-32"><a href="#cb51-32" aria-hidden="true" tabindex="-1"></a>test_eq(val_at(<span class="st">'app.Boolean'</span>, j2_str), <span class="va">True</span>)</span>
<span id="cb51-33"><a href="#cb51-33" aria-hidden="true" tabindex="-1"></a>test_eq(val_at(<span class="st">'app.Null'</span>, j2_str), <span class="va">None</span>)</span>
<span id="cb51-34"><a href="#cb51-34" aria-hidden="true" tabindex="-1"></a>test_fail(<span class="kw">lambda</span>: val_at(<span class="st">'app.NonExistent'</span>, j2_str))</span>
<span id="cb51-35"><a href="#cb51-35" aria-hidden="true" tabindex="-1"></a>test_fail(<span class="kw">lambda</span>: val_at(<span class="st">'app.Fruits.Yellow fruit.3'</span>, j2_str))</span>
<span id="cb51-36"><a href="#cb51-36" aria-hidden="true" tabindex="-1"></a>test_is(val_at(<span class="st">'app.Fruits.Yellow fruit.3'</span>, j2_str, <span class="va">None</span>), <span class="va">None</span>)</span>
<span id="cb51-37"><a href="#cb51-37" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-38"><a href="#cb51-38" aria-hidden="true" tabindex="-1"></a>test_eq(key_at(<span class="st">'app.Garden.Flowers.Red flower'</span>, j2_str), <span class="va">True</span>)</span>
<span id="cb51-39"><a href="#cb51-39" aria-hidden="true" tabindex="-1"></a>test_eq(key_at(<span class="st">'app.Numbers.2'</span>, j2_str), <span class="va">True</span>)</span>
<span id="cb51-40"><a href="#cb51-40" aria-hidden="true" tabindex="-1"></a>test_eq(key_at(<span class="st">'app.Fruits.Yellow fruit.1.Banana.0'</span>, j2_str), <span class="va">True</span>)</span>
<span id="cb51-41"><a href="#cb51-41" aria-hidden="true" tabindex="-1"></a>test_eq(key_at(<span class="st">'app.NonExistent'</span>, j2_str), <span class="va">False</span>)</span>
<span id="cb51-42"><a href="#cb51-42" aria-hidden="true" tabindex="-1"></a>test_eq(key_at(<span class="st">'app.Fruits.Yellow fruit.3'</span>, j2_str), <span class="va">False</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
</section>
</section>
<section id="vals_at---implementation-evolution" class="level2 hidden">
<h2 class="hidden anchored" data-anchor-id="vals_at---implementation-evolution">vals_at - Implementation Evolution</h2>
<p>Similar to <code>val_at</code>, this section shows the iterative development of wildcard path traversal. The implementation needed to handle returning empty sentinels for missing paths while still extracting values from partial matches.</p>
<p><strong>Skip to <a href="#vals_at-vals_atpath">vals_at, vals_atpath</a> for the final implementation and usage examples.</strong></p>
<section id="early-wildcard-implementation" class="level3">
<h3 class="anchored" data-anchor-id="early-wildcard-implementation">Early wildcard implementation</h3>
<div id="0137adb4" class="cell" data-quarto-private-1="{&quot;key&quot;:&quot;brd&quot;,&quot;value&quot;:{&quot;id&quot;:&quot;656ca64d-9ede-43a2-9290-b24ae80500ea&quot;}}" data-execution_count="45">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb52"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb52-1"><a href="#cb52-1" aria-hidden="true" tabindex="-1"></a>_E <span class="op">=</span> <span class="bu">object</span>()</span>
<span id="cb52-2"><a href="#cb52-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-3"><a href="#cb52-3" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> vals_at(path, d) <span class="op">-&gt;</span> empty <span class="op">|</span> <span class="bu">tuple</span>[empty <span class="op">|</span> <span class="bu">object</span>, ...] <span class="op">|</span> <span class="bu">object</span>:</span>
<span id="cb52-4"><a href="#cb52-4" aria-hidden="true" tabindex="-1"></a>    <span class="co">"Return nested values-- or empty|(empty, ...)-- at `path` with wildcards '*' from `d`."</span></span>
<span id="cb52-5"><a href="#cb52-5" aria-hidden="true" tabindex="-1"></a>    curr, wc, rest <span class="op">=</span> <span class="bu">str</span>(path).partition(<span class="st">'*'</span>)</span>
<span id="cb52-6"><a href="#cb52-6" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="kw">not</span> wc <span class="kw">and</span> <span class="kw">not</span> rest:  <span class="cf">return</span> o <span class="cf">if</span> (o <span class="op">:=</span> val_at(curr, d, _E)) <span class="kw">is</span> <span class="kw">not</span> _E <span class="cf">else</span> empty</span>
<span id="cb52-7"><a href="#cb52-7" aria-hidden="true" tabindex="-1"></a>    o <span class="op">=</span> val_at(curr.rstrip(<span class="st">'.'</span>), d, _E) <span class="cf">if</span> curr <span class="cf">else</span> d</span>
<span id="cb52-8"><a href="#cb52-8" aria-hidden="true" tabindex="-1"></a>    <span class="cf">try</span>: <span class="cf">return</span> (<span class="bu">tuple</span>(<span class="bu">map</span>(<span class="kw">lambda</span> x: empty <span class="cf">if</span> (res <span class="op">:=</span> vals_at(rest.lstrip(<span class="st">'.'</span>), x)) <span class="kw">is</span> _E <span class="cf">else</span> res, o))  <span class="co"># type: ignore</span></span>
<span id="cb52-9"><a href="#cb52-9" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> rest <span class="kw">and</span> o <span class="kw">is</span> <span class="kw">not</span> _E <span class="cf">else</span> o)</span>
<span id="cb52-10"><a href="#cb52-10" aria-hidden="true" tabindex="-1"></a>    <span class="cf">except</span> <span class="pp">TypeError</span>: <span class="cf">return</span> empty</span>
<span id="cb52-11"><a href="#cb52-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-12"><a href="#cb52-12" aria-hidden="true" tabindex="-1"></a>test_eq(vals_at(<span class="st">'a'</span>, <span class="bu">object</span>), empty)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<div id="d255041e" class="cell" data-quarto-private-1="{&quot;key&quot;:&quot;brd&quot;,&quot;value&quot;:{&quot;id&quot;:&quot;951f1d94-f497-4a7c-87d5-e89355194c4e&quot;}}" data-execution_count="46">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb53"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb53-1"><a href="#cb53-1" aria-hidden="true" tabindex="-1"></a>d <span class="op">=</span> [</span>
<span id="cb53-2"><a href="#cb53-2" aria-hidden="true" tabindex="-1"></a>    {<span class="st">'a'</span>: <span class="dv">1</span>, <span class="st">'b'</span>: [<span class="dv">2</span>,  <span class="dv">3</span>],  <span class="st">'c'</span>: {<span class="st">'d'</span>:   <span class="dv">4</span>}}, </span>
<span id="cb53-3"><a href="#cb53-3" aria-hidden="true" tabindex="-1"></a>    {<span class="st">'a'</span>: <span class="dv">5</span>, <span class="st">'b'</span>: [<span class="dv">6</span>,  <span class="dv">7</span>],                  <span class="st">'d'</span>: [{<span class="st">'e'</span>: <span class="dv">81</span>}, {<span class="st">'e'</span>: <span class="dv">82</span>}]}, </span>
<span id="cb53-4"><a href="#cb53-4" aria-hidden="true" tabindex="-1"></a>    {<span class="st">'a'</span>: <span class="dv">9</span>, <span class="st">'b'</span>: [<span class="dv">10</span>, <span class="dv">11</span>], <span class="st">'c'</span>: {<span class="st">'d'</span>: <span class="dv">12</span>}}</span>
<span id="cb53-5"><a href="#cb53-5" aria-hidden="true" tabindex="-1"></a>]</span>
<span id="cb53-6"><a href="#cb53-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-7"><a href="#cb53-7" aria-hidden="true" tabindex="-1"></a>test_eq(vals_at(<span class="st">''</span>, d), empty)</span>
<span id="cb53-8"><a href="#cb53-8" aria-hidden="true" tabindex="-1"></a>test_eq(vals_at(<span class="bu">object</span>, d), empty)</span>
<span id="cb53-9"><a href="#cb53-9" aria-hidden="true" tabindex="-1"></a>test_eq(vals_at(<span class="st">'*'</span>, d), (<span class="op">*</span>d,))</span>
<span id="cb53-10"><a href="#cb53-10" aria-hidden="true" tabindex="-1"></a>test_eq(vals_at(<span class="dv">2</span>, d), d[<span class="dv">2</span>])</span>
<span id="cb53-11"><a href="#cb53-11" aria-hidden="true" tabindex="-1"></a>test_eq(vals_at(<span class="st">'a'</span>, d), empty)</span>
<span id="cb53-12"><a href="#cb53-12" aria-hidden="true" tabindex="-1"></a>test_eq(vals_at(<span class="st">'*.a'</span>, []), ())</span>
<span id="cb53-13"><a href="#cb53-13" aria-hidden="true" tabindex="-1"></a>test_eq(vals_at(<span class="st">'*.a.*.b'</span>, [{<span class="st">'a'</span>: <span class="bu">object</span>}]), (empty,))</span>
<span id="cb53-14"><a href="#cb53-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-15"><a href="#cb53-15" aria-hidden="true" tabindex="-1"></a>test_eq(vals_at(<span class="st">'*,a'</span>, d), (empty, empty, empty))</span>
<span id="cb53-16"><a href="#cb53-16" aria-hidden="true" tabindex="-1"></a>test_eq(vals_at(<span class="st">'*.a'</span>, d), (<span class="dv">1</span>, <span class="dv">5</span>, <span class="dv">9</span>))</span>
<span id="cb53-17"><a href="#cb53-17" aria-hidden="true" tabindex="-1"></a>test_eq(vals_at(<span class="st">'*.a.*'</span>, d), (<span class="dv">1</span>,<span class="dv">5</span>,<span class="dv">9</span>))</span>
<span id="cb53-18"><a href="#cb53-18" aria-hidden="true" tabindex="-1"></a>test_eq(vals_at(<span class="st">'*.b.1'</span>, d), (<span class="dv">3</span>, <span class="dv">7</span>, <span class="dv">11</span>))</span>
<span id="cb53-19"><a href="#cb53-19" aria-hidden="true" tabindex="-1"></a>test_eq(vals_at(<span class="st">'*.c.d'</span>, d), (<span class="dv">4</span>, empty, <span class="dv">12</span>))</span>
<span id="cb53-20"><a href="#cb53-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-21"><a href="#cb53-21" aria-hidden="true" tabindex="-1"></a>test_eq(vals_at(<span class="st">'*.d.*.e'</span>, d), (empty, (<span class="dv">81</span>, <span class="dv">82</span>), empty))</span>
<span id="cb53-22"><a href="#cb53-22" aria-hidden="true" tabindex="-1"></a>test_eq(vals_at(<span class="st">'*.d.*.f'</span>, d), (empty, (empty, empty), empty))</span>
<span id="cb53-23"><a href="#cb53-23" aria-hidden="true" tabindex="-1"></a>test_eq(vals_at(<span class="st">'1.d.*.e'</span>, d), (<span class="dv">81</span>, <span class="dv">82</span>))</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<div id="78b8d035" class="cell" data-quarto-private-1="{&quot;key&quot;:&quot;brd&quot;,&quot;value&quot;:{&quot;id&quot;:&quot;97c5fec7-70fc-45fb-92c1-a52228f3869b&quot;}}" data-execution_count="47">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb54"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb54-1"><a href="#cb54-1" aria-hidden="true" tabindex="-1"></a>vals_at(<span class="st">'*'</span>, d)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-display" data-execution_count="47">
<pre><code>[{'a': 1, 'b': [2, 3], 'c': {'d': 4}},
 {'a': 5, 'b': [6, 7], 'd': [{'e': 81}, {'e': 82}]},
 {'a': 9, 'b': [10, 11], 'c': {'d': 12}}]</code></pre>
</div>
</div>
</section>
</section>
</section>
<section id="nested-data-access" class="level1">
<h1>Nested Data Access</h1>
<p>Working with deeply nested data (JSON, API responses, config files) often requires verbose, error-prone access patterns. These utilities provide clean, safe access using dot notation or path sequences.</p>
<section id="val_at-val_atpath" class="level2">
<h2 class="anchored" data-anchor-id="val_at-val_atpath">val_at, val_atpath</h2>
<p>Lookup values in nested structures using dot notation (<code>val_at</code>) or path sequences (<a href="https://civvic.github.io/pote/basic.html#val_atpath"><code>val_atpath</code></a>).</p>
<p><strong>Why use these?</strong> - Cleaner than chained <code>['key1']['key2'][0]</code> access - Safe default values instead of try/except blocks - Works with dicts, lists, objects, and JSON strings - Handles mixed nesting (lists within dicts, etc.)</p>
<p><strong>Use <code>val_at</code></strong> when you have a dot-separated path string: <code>'user.addresses.0.city'</code><br>
<strong>Use <a href="https://civvic.github.io/pote/basic.html#val_atpath"><code>val_atpath</code></a></strong> when you have individual path components: <code>'user', 'addresses', 0, 'city'</code></p>
<p><strong>Related utilities:</strong> - <code>has_key(o, 'dot.path')</code> / <code>has_path(o, *path)</code> - Check if path exists without retrieving value - <code>vals_at(o, 'path.*.with.wildcards')</code> - Extract multiple values using wildcards (see below)</p>
<hr>
<p><a href="https://github.com/civvic/pote/blob/main/pote/basic.py#L197" target="_blank" style="float:right; font-size:smaller">source</a></p>
<section id="has_path" class="level3">
<h3 class="anchored" data-anchor-id="has_path">has_path</h3>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb56"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb56-1"><a href="#cb56-1" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-2"><a href="#cb56-2" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> has_path(</span>
<span id="cb56-3"><a href="#cb56-3" aria-hidden="true" tabindex="-1"></a>    o, path:<span class="bu">str</span> \<span class="op">|</span> <span class="bu">int</span></span>
<span id="cb56-4"><a href="#cb56-4" aria-hidden="true" tabindex="-1"></a>)<span class="op">-&gt;</span><span class="bu">bool</span>:</span>
<span id="cb56-5"><a href="#cb56-5" aria-hidden="true" tabindex="-1"></a></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<p><em>Return <code>True</code> if nested <code>path</code> exists.</em></p>
<hr>
<p><a href="https://github.com/civvic/pote/blob/main/pote/basic.py#L193" target="_blank" style="float:right; font-size:smaller">source</a></p>
</section>
<section id="has_key" class="level3">
<h3 class="anchored" data-anchor-id="has_key">has_key</h3>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb57"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb57-1"><a href="#cb57-1" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb57-2"><a href="#cb57-2" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> has_key(</span>
<span id="cb57-3"><a href="#cb57-3" aria-hidden="true" tabindex="-1"></a>    o, attr:<span class="bu">str</span>, sep:<span class="bu">str</span><span class="op">=</span><span class="st">'.'</span></span>
<span id="cb57-4"><a href="#cb57-4" aria-hidden="true" tabindex="-1"></a>)<span class="op">-&gt;</span><span class="bu">bool</span>:</span>
<span id="cb57-5"><a href="#cb57-5" aria-hidden="true" tabindex="-1"></a></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<p><em>Return <code>True</code> if nested dot-separated <code>attr</code> exists.</em></p>
<hr>
<p><a href="https://github.com/civvic/pote/blob/main/pote/basic.py#L180" target="_blank" style="float:right; font-size:smaller">source</a></p>
</section>
<section id="val_atpath" class="level3">
<h3 class="anchored" data-anchor-id="val_atpath">val_atpath</h3>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb58"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb58-1"><a href="#cb58-1" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-2"><a href="#cb58-2" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> val_atpath(</span>
<span id="cb58-3"><a href="#cb58-3" aria-hidden="true" tabindex="-1"></a>    o, path:<span class="bu">str</span> \<span class="op">|</span> <span class="bu">int</span>, default:Any<span class="op">=</span>empty</span>
<span id="cb58-4"><a href="#cb58-4" aria-hidden="true" tabindex="-1"></a>):</span>
<span id="cb58-5"><a href="#cb58-5" aria-hidden="true" tabindex="-1"></a></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<p><em>Traverse nested <code>o</code> looking for attributes/items specified in <code>path</code>.</em></p>
<hr>
<p><a href="https://github.com/civvic/pote/blob/main/pote/basic.py#L156" target="_blank" style="float:right; font-size:smaller">source</a></p>
</section>
<section id="at_" class="level3">
<h3 class="anchored" data-anchor-id="at_">at_</h3>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb59"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb59-1"><a href="#cb59-1" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-2"><a href="#cb59-2" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> at_(</span>
<span id="cb59-3"><a href="#cb59-3" aria-hidden="true" tabindex="-1"></a>    o, <span class="co"># Object to traverse (dict, list, object, or nested combination)</span></span>
<span id="cb59-4"><a href="#cb59-4" aria-hidden="true" tabindex="-1"></a>    sym:<span class="bu">str</span>, <span class="co"># Path using dots and/or brackets (e.g., 'a.b[0].c' or 'a[b][c]')",</span></span>
<span id="cb59-5"><a href="#cb59-5" aria-hidden="true" tabindex="-1"></a>    default:Any, <span class="co"># Value to return if path not found (raises exception if not provided)</span></span>
<span id="cb59-6"><a href="#cb59-6" aria-hidden="true" tabindex="-1"></a>    sep:<span class="bu">str</span><span class="op">=</span><span class="st">'.'</span>, <span class="co"># Separator for path segments</span></span>
<span id="cb59-7"><a href="#cb59-7" aria-hidden="true" tabindex="-1"></a>)<span class="op">-&gt;</span>Any: <span class="co"># Value at the specified path</span></span>
<span id="cb59-8"><a href="#cb59-8" aria-hidden="true" tabindex="-1"></a></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<p><em>Traverse nested <code>o</code> using path <code>sym</code> with dot notation and/or bracket indexing</em></p>
<p><a href="https://civvic.github.io/pote/basic.html#at_"><code>at_</code></a> provides flexible path-based access to nested data structures:</p>
<p><strong>Supported types:</strong> <code>o</code> can be/contains any combination of <code>Sequence</code>, <code>Mapping</code> (dicts, lists, tuples, L, etc), objects with __getitem__, and/or dataclasses, objects with attributes accesible by <code>getattr</code>.</p>
<p><strong>Path syntax:</strong> - Dot notation: <code>'a.b.c'</code> accesses <code>o['a']['b']['c']</code> or <code>o.a.b.c</code> - Bracket notation: <code>'a[b][c]'</code> is equivalent to <code>'a.b.c'</code>: <code>[x]</code> is a shorthand for <code>.x</code> - Mixed: <code>'a.b[0].c'</code> combines both styles - Numeric indices: <code>'items.2'</code> or <code>'items[2]'</code> for list/array access - Empty path: <code>''</code> returns the object itself</p>
<p><strong>Access priority:</strong> Item access (<code>[]</code>) is tried before attribute access (<code>.</code>)</p>
<p><strong>Error handling:</strong> Raises exception if path not found, unless <code>default</code> is provided</p>
<div id="44189615" class="cell" data-quarto-private-1="{&quot;key&quot;:&quot;brd&quot;,&quot;value&quot;:{&quot;id&quot;:&quot;a8e884db-326c-42a9-97d5-f5179dd2dab4&quot;}}" data-execution_count="50">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb60"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb60-1"><a href="#cb60-1" aria-hidden="true" tabindex="-1"></a>test_eq(at_({<span class="st">'a'</span>: <span class="dv">13</span>}, <span class="st">'a'</span>), <span class="dv">13</span>)</span>
<span id="cb60-2"><a href="#cb60-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-3"><a href="#cb60-3" aria-hidden="true" tabindex="-1"></a>test_eq(at_({<span class="st">'a'</span>: {<span class="st">'b'</span>: <span class="dv">13</span>}}, <span class="st">'a.b'</span>), <span class="dv">13</span>)</span>
<span id="cb60-4"><a href="#cb60-4" aria-hidden="true" tabindex="-1"></a>test_eq(at_({<span class="st">'a'</span>: dict2obj({<span class="st">'b'</span>: <span class="dv">13</span>})}, <span class="st">'a.b'</span>), <span class="dv">13</span>)</span>
<span id="cb60-5"><a href="#cb60-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-6"><a href="#cb60-6" aria-hidden="true" tabindex="-1"></a>test_eq(at_({<span class="st">'a'</span>: {<span class="st">'3'</span>: <span class="dv">7</span>}}, <span class="st">'a.3'</span>), <span class="dv">7</span>)</span>
<span id="cb60-7"><a href="#cb60-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-8"><a href="#cb60-8" aria-hidden="true" tabindex="-1"></a>test_fail(<span class="kw">lambda</span>: at_(o, <span class="st">'app.NonExistent'</span>))</span>
<span id="cb60-9"><a href="#cb60-9" aria-hidden="true" tabindex="-1"></a>test_fail(<span class="kw">lambda</span>: at_(o, <span class="st">'[0'</span>))</span>
<span id="cb60-10"><a href="#cb60-10" aria-hidden="true" tabindex="-1"></a>test_fail(<span class="kw">lambda</span>: at_(<span class="va">None</span>, <span class="st">'a'</span>))</span>
<span id="cb60-11"><a href="#cb60-11" aria-hidden="true" tabindex="-1"></a>test_eq(at_(<span class="va">None</span>, <span class="st">'a'</span>, <span class="va">None</span>), <span class="va">None</span>)</span>
<span id="cb60-12"><a href="#cb60-12" aria-hidden="true" tabindex="-1"></a>test_fail(<span class="kw">lambda</span>: at_(<span class="va">None</span>, <span class="st">'a'</span>))</span>
<span id="cb60-13"><a href="#cb60-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-14"><a href="#cb60-14" aria-hidden="true" tabindex="-1"></a>test_eq(at_(o <span class="op">:=</span> {<span class="st">'meta'</span>: [<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>]}, <span class="st">''</span>), o)</span>
<span id="cb60-15"><a href="#cb60-15" aria-hidden="true" tabindex="-1"></a>test_eq(at_(o, <span class="st">'meta[2]'</span>), <span class="dv">3</span>)</span>
<span id="cb60-16"><a href="#cb60-16" aria-hidden="true" tabindex="-1"></a>test_eq(at_(o, <span class="st">'meta.2'</span>), <span class="dv">3</span>)</span>
<span id="cb60-17"><a href="#cb60-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-18"><a href="#cb60-18" aria-hidden="true" tabindex="-1"></a>test_eq(at_(<span class="st">'xyz'</span>, <span class="st">'a'</span>, <span class="va">None</span>), <span class="va">None</span>)</span>
<span id="cb60-19"><a href="#cb60-19" aria-hidden="true" tabindex="-1"></a>test_eq(at_((s <span class="op">:=</span> <span class="st">'xyz'</span>), <span class="st">'split'</span>), s.split)</span>
<span id="cb60-20"><a href="#cb60-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-21"><a href="#cb60-21" aria-hidden="true" tabindex="-1"></a>test_eq(at_([{<span class="st">'a'</span>:<span class="dv">1</span>}], <span class="st">'[0][a]'</span>), <span class="dv">1</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<div id="58439781" class="cell" data-quarto-private-1="{&quot;key&quot;:&quot;brd&quot;,&quot;value&quot;:{&quot;id&quot;:&quot;2a2e695a-fe43-4435-90d9-592a0be3e043&quot;}}" data-execution_count="51">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb61"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb61-1"><a href="#cb61-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Basic usage: access nested data with dot notation</span></span>
<span id="cb61-2"><a href="#cb61-2" aria-hidden="true" tabindex="-1"></a>data <span class="op">=</span> {<span class="st">'user'</span>: {<span class="st">'name'</span>: <span class="st">'Alice'</span>, <span class="st">'scores'</span>: [<span class="dv">10</span>, <span class="dv">20</span>, <span class="dv">30</span>]}}</span>
<span id="cb61-3"><a href="#cb61-3" aria-hidden="true" tabindex="-1"></a>test_eq(val_at(data, <span class="st">'user.name'</span>), <span class="st">'Alice'</span>)</span>
<span id="cb61-4"><a href="#cb61-4" aria-hidden="true" tabindex="-1"></a>test_eq(val_at(data, <span class="st">'user.scores.1'</span>), <span class="dv">20</span>)  <span class="co"># list index</span></span>
<span id="cb61-5"><a href="#cb61-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-6"><a href="#cb61-6" aria-hidden="true" tabindex="-1"></a>j2_list <span class="op">=</span> [{<span class="st">'a'</span>:<span class="dv">1</span>}, {<span class="st">'b'</span>:<span class="dv">2</span>}]</span>
<span id="cb61-7"><a href="#cb61-7" aria-hidden="true" tabindex="-1"></a>test_eq(val_at(j2_list, <span class="st">'0'</span>), {<span class="st">'a'</span>:<span class="dv">1</span>})</span>
<span id="cb61-8"><a href="#cb61-8" aria-hidden="true" tabindex="-1"></a>test_eq(val_at(j2_list, <span class="st">'0.a'</span>), <span class="dv">1</span>)</span>
<span id="cb61-9"><a href="#cb61-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-10"><a href="#cb61-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Safe default instead of exception</span></span>
<span id="cb61-11"><a href="#cb61-11" aria-hidden="true" tabindex="-1"></a>test_eq(val_at(data, <span class="st">'user.age'</span>, default<span class="op">=</span><span class="dv">25</span>), <span class="dv">25</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<div id="6a48f708" class="cell" data-quarto-private-1="{&quot;key&quot;:&quot;brd&quot;,&quot;value&quot;:{&quot;id&quot;:&quot;f60ff402-fc5e-4383-bd30-3fbbe374f184&quot;}}" data-execution_count="52">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb62"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb62-1"><a href="#cb62-1" aria-hidden="true" tabindex="-1"></a>test_eq(at_(j2_list, <span class="st">'0'</span>), {<span class="st">'a'</span>:<span class="dv">1</span>})</span>
<span id="cb62-2"><a href="#cb62-2" aria-hidden="true" tabindex="-1"></a>test_eq(at_(j2_list, <span class="st">'1'</span>), {<span class="st">'b'</span>:<span class="dv">2</span>})</span>
<span id="cb62-3"><a href="#cb62-3" aria-hidden="true" tabindex="-1"></a>test_eq(at_(j2_list, <span class="st">'[0][a]'</span>), <span class="dv">1</span>)</span>
<span id="cb62-4"><a href="#cb62-4" aria-hidden="true" tabindex="-1"></a>test_eq(at_(j2_list, <span class="st">'0.a'</span>), <span class="dv">1</span>)</span>
<span id="cb62-5"><a href="#cb62-5" aria-hidden="true" tabindex="-1"></a>test_eq(at_(j2_list, <span class="st">'[1].b'</span>), <span class="dv">2</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<div id="70f9c41a" class="cell" data-quarto-private-1="{&quot;key&quot;:&quot;brd&quot;,&quot;value&quot;:{&quot;id&quot;:&quot;e7019ad1-fba7-4b54-975d-f3ba7720eed8&quot;}}" data-execution_count="53">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb63"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb63-1"><a href="#cb63-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Basic usage: access nested data with dot notation</span></span>
<span id="cb63-2"><a href="#cb63-2" aria-hidden="true" tabindex="-1"></a>data <span class="op">=</span> {<span class="st">'user'</span>: {<span class="st">'name'</span>: <span class="st">'Alice'</span>, <span class="st">'scores'</span>: [<span class="dv">10</span>, <span class="dv">20</span>, <span class="dv">30</span>]}}</span>
<span id="cb63-3"><a href="#cb63-3" aria-hidden="true" tabindex="-1"></a>test_eq(val_at(data, <span class="st">'user.name'</span>), <span class="st">'Alice'</span>)</span>
<span id="cb63-4"><a href="#cb63-4" aria-hidden="true" tabindex="-1"></a>test_eq(val_at(data, <span class="st">'user.scores.1'</span>), <span class="dv">20</span>)  <span class="co"># list index</span></span>
<span id="cb63-5"><a href="#cb63-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-6"><a href="#cb63-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Safe default instead of exception</span></span>
<span id="cb63-7"><a href="#cb63-7" aria-hidden="true" tabindex="-1"></a>test_eq(val_at(data, <span class="st">'user.age'</span>, default<span class="op">=</span><span class="dv">25</span>), <span class="dv">25</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<div id="58152c76" class="cell" data-quarto-private-1="{&quot;key&quot;:&quot;brd&quot;,&quot;value&quot;:{&quot;id&quot;:&quot;684eba3a-9933-4a3e-bc43-a67fd67efb28&quot;}}" data-execution_count="54">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb64"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb64-1"><a href="#cb64-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Works with lists of dicts (common in API responses)</span></span>
<span id="cb64-2"><a href="#cb64-2" aria-hidden="true" tabindex="-1"></a>records <span class="op">=</span> [</span>
<span id="cb64-3"><a href="#cb64-3" aria-hidden="true" tabindex="-1"></a>    {<span class="st">'id'</span>: <span class="dv">1</span>, <span class="st">'items'</span>: [<span class="dv">2</span>, <span class="dv">3</span>], <span class="st">'meta'</span>: {<span class="st">'count'</span>: <span class="dv">4</span>}}, </span>
<span id="cb64-4"><a href="#cb64-4" aria-hidden="true" tabindex="-1"></a>    {<span class="st">'id'</span>: <span class="dv">5</span>, <span class="st">'items'</span>: [<span class="dv">6</span>, <span class="dv">7</span>], <span class="st">'nested'</span>: [{<span class="st">'val'</span>: <span class="dv">81</span>}, {<span class="st">'val'</span>: <span class="dv">82</span>}]}, </span>
<span id="cb64-5"><a href="#cb64-5" aria-hidden="true" tabindex="-1"></a>    {<span class="st">'id'</span>: <span class="dv">9</span>, <span class="st">'items'</span>: [<span class="dv">10</span>, <span class="dv">11</span>], <span class="st">'meta'</span>: {<span class="st">'count'</span>: <span class="dv">12</span>}}</span>
<span id="cb64-6"><a href="#cb64-6" aria-hidden="true" tabindex="-1"></a>]</span>
<span id="cb64-7"><a href="#cb64-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-8"><a href="#cb64-8" aria-hidden="true" tabindex="-1"></a>test_eq(val_at(records, <span class="st">'0.id'</span>), <span class="dv">1</span>)</span>
<span id="cb64-9"><a href="#cb64-9" aria-hidden="true" tabindex="-1"></a>test_eq(val_at(records, <span class="st">'1.items'</span>), [<span class="dv">6</span>, <span class="dv">7</span>])</span>
<span id="cb64-10"><a href="#cb64-10" aria-hidden="true" tabindex="-1"></a>test_eq(val_at(records, <span class="st">'2.meta'</span>), {<span class="st">'count'</span>: <span class="dv">12</span>})</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<div id="b39b178d" class="cell" data-quarto-private-1="{&quot;key&quot;:&quot;brd&quot;,&quot;value&quot;:{&quot;id&quot;:&quot;d6d11fea-7b83-4b5e-9b76-b7eb6608a265&quot;}}" data-execution_count="55">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb65"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb65-1"><a href="#cb65-1" aria-hidden="true" tabindex="-1"></a>test_eq(at_(records, <span class="st">'[2].meta'</span>), {<span class="st">'count'</span>: <span class="dv">12</span>})</span>
<span id="cb65-2"><a href="#cb65-2" aria-hidden="true" tabindex="-1"></a>test_eq(at_(records, <span class="st">'2[meta]'</span>), {<span class="st">'count'</span>: <span class="dv">12</span>})</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<div id="b1e8e852" class="cell" data-quarto-private-1="{&quot;key&quot;:&quot;brd&quot;,&quot;value&quot;:{&quot;id&quot;:&quot;62f648de-2356-441e-8c44-87d5dbe9f369&quot;}}" data-execution_count="56">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb66"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb66-1"><a href="#cb66-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Error handling: raises when path not found (unless default provided)</span></span>
<span id="cb66-2"><a href="#cb66-2" aria-hidden="true" tabindex="-1"></a>test_fail(<span class="kw">lambda</span>: val_at({}, <span class="st">'a.b'</span>))</span>
<span id="cb66-3"><a href="#cb66-3" aria-hidden="true" tabindex="-1"></a>test_fail(<span class="kw">lambda</span>: val_at([], <span class="st">'a.b'</span>))</span>
<span id="cb66-4"><a href="#cb66-4" aria-hidden="true" tabindex="-1"></a>test_fail(<span class="kw">lambda</span>: val_at({<span class="st">'a'</span>: <span class="dv">1</span>}, <span class="st">'a.b'</span>))</span>
<span id="cb66-5"><a href="#cb66-5" aria-hidden="true" tabindex="-1"></a>test_fail(<span class="kw">lambda</span>: val_atpath({<span class="st">'a'</span>: <span class="dv">1</span>}, <span class="st">'a'</span>, <span class="st">'b'</span>))</span>
<span id="cb66-6"><a href="#cb66-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb66-7"><a href="#cb66-7" aria-hidden="true" tabindex="-1"></a><span class="co"># With default, no error</span></span>
<span id="cb66-8"><a href="#cb66-8" aria-hidden="true" tabindex="-1"></a>test_eq(val_at({<span class="st">'a'</span>: <span class="dv">1</span>}, <span class="st">'a.b'</span>, <span class="va">None</span>), <span class="va">None</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<div id="6a17feef" class="cell" data-quarto-private-1="{&quot;key&quot;:&quot;brd&quot;,&quot;value&quot;:{&quot;id&quot;:&quot;88e56441-9008-40df-869b-c44e404b009c&quot;}}" data-execution_count="57">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb67"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb67-1"><a href="#cb67-1" aria-hidden="true" tabindex="-1"></a>j2 <span class="op">=</span> {</span>
<span id="cb67-2"><a href="#cb67-2" aria-hidden="true" tabindex="-1"></a>    <span class="st">"app"</span>: {</span>
<span id="cb67-3"><a href="#cb67-3" aria-hidden="true" tabindex="-1"></a>        <span class="st">"Garden"</span>: {</span>
<span id="cb67-4"><a href="#cb67-4" aria-hidden="true" tabindex="-1"></a>            <span class="st">"Flowers"</span>: {</span>
<span id="cb67-5"><a href="#cb67-5" aria-hidden="true" tabindex="-1"></a>                <span class="st">"Red flower"</span>: <span class="st">"Rose"</span>,</span>
<span id="cb67-6"><a href="#cb67-6" aria-hidden="true" tabindex="-1"></a>                <span class="st">"White Flower"</span>: <span class="st">"Jasmine"</span>,</span>
<span id="cb67-7"><a href="#cb67-7" aria-hidden="true" tabindex="-1"></a>                <span class="st">"Yellow Flower"</span>: <span class="st">"Marigold"</span></span>
<span id="cb67-8"><a href="#cb67-8" aria-hidden="true" tabindex="-1"></a>            }</span>
<span id="cb67-9"><a href="#cb67-9" aria-hidden="true" tabindex="-1"></a>        },</span>
<span id="cb67-10"><a href="#cb67-10" aria-hidden="true" tabindex="-1"></a>        <span class="st">"Fruits"</span>: {</span>
<span id="cb67-11"><a href="#cb67-11" aria-hidden="true" tabindex="-1"></a>            <span class="st">"Yellow fruit"</span>: [<span class="st">"Mango"</span>, {<span class="st">"Banana"</span>: [<span class="st">"Canary Island"</span>, <span class="st">"Puerto Rico"</span>]}],</span>
<span id="cb67-12"><a href="#cb67-12" aria-hidden="true" tabindex="-1"></a>            <span class="st">"Green fruit"</span>: <span class="st">"Guava"</span>,</span>
<span id="cb67-13"><a href="#cb67-13" aria-hidden="true" tabindex="-1"></a>            <span class="st">"White Flower"</span>: <span class="st">"groovy"</span></span>
<span id="cb67-14"><a href="#cb67-14" aria-hidden="true" tabindex="-1"></a>        },</span>
<span id="cb67-15"><a href="#cb67-15" aria-hidden="true" tabindex="-1"></a>        <span class="st">"Trees"</span>: {</span>
<span id="cb67-16"><a href="#cb67-16" aria-hidden="true" tabindex="-1"></a>            <span class="st">"label"</span>: {</span>
<span id="cb67-17"><a href="#cb67-17" aria-hidden="true" tabindex="-1"></a>                <span class="st">"Yellow fruit"</span>: <span class="st">"Pumpkin"</span>,</span>
<span id="cb67-18"><a href="#cb67-18" aria-hidden="true" tabindex="-1"></a>                <span class="st">"White Flower"</span>: <span class="st">"Bogan"</span></span>
<span id="cb67-19"><a href="#cb67-19" aria-hidden="true" tabindex="-1"></a>            }</span>
<span id="cb67-20"><a href="#cb67-20" aria-hidden="true" tabindex="-1"></a>        },</span>
<span id="cb67-21"><a href="#cb67-21" aria-hidden="true" tabindex="-1"></a>        <span class="st">"Numbers"</span>: [<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">4</span>, <span class="dv">5</span>],</span>
<span id="cb67-22"><a href="#cb67-22" aria-hidden="true" tabindex="-1"></a>        <span class="st">"Boolean"</span>: <span class="va">True</span>,</span>
<span id="cb67-23"><a href="#cb67-23" aria-hidden="true" tabindex="-1"></a>        <span class="st">"Null"</span>: <span class="va">None</span></span>
<span id="cb67-24"><a href="#cb67-24" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb67-25"><a href="#cb67-25" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb67-26"><a href="#cb67-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-27"><a href="#cb67-27" aria-hidden="true" tabindex="-1"></a>j2_str <span class="op">=</span> j2<span class="co">#json.dumps(j2)</span></span>
<span id="cb67-28"><a href="#cb67-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-29"><a href="#cb67-29" aria-hidden="true" tabindex="-1"></a>test_eq(val_at(j2_str, <span class="st">'app.Fruits.Yellow fruit.1.Banana.0'</span>), <span class="st">'Canary Island'</span>)</span>
<span id="cb67-30"><a href="#cb67-30" aria-hidden="true" tabindex="-1"></a>test_eq(val_at(j2_str, <span class="st">'app.Garden.Flowers.Red flower'</span>), <span class="st">'Rose'</span>)</span>
<span id="cb67-31"><a href="#cb67-31" aria-hidden="true" tabindex="-1"></a>test_eq(val_at(j2_str, <span class="st">'app.Numbers.2'</span>), <span class="dv">3</span>)</span>
<span id="cb67-32"><a href="#cb67-32" aria-hidden="true" tabindex="-1"></a>test_eq(val_at(j2_str, <span class="st">'app.Boolean'</span>), <span class="va">True</span>)</span>
<span id="cb67-33"><a href="#cb67-33" aria-hidden="true" tabindex="-1"></a>test_eq(val_at(j2_str, <span class="st">'app.Null'</span>), <span class="va">None</span>)</span>
<span id="cb67-34"><a href="#cb67-34" aria-hidden="true" tabindex="-1"></a>test_fail(<span class="kw">lambda</span>: val_at(j2_str, <span class="st">'app.NonExistent'</span>))</span>
<span id="cb67-35"><a href="#cb67-35" aria-hidden="true" tabindex="-1"></a>test_fail(<span class="kw">lambda</span>: val_at(j2_str, <span class="st">'app.Fruits.Yellow fruit.3'</span>))</span>
<span id="cb67-36"><a href="#cb67-36" aria-hidden="true" tabindex="-1"></a>test_is(val_at(j2_str, <span class="st">'app.Fruits.Yellow fruit.3'</span>, <span class="va">None</span>), <span class="va">None</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<div id="fe233f30" class="cell" data-quarto-private-1="{&quot;key&quot;:&quot;brd&quot;,&quot;value&quot;:{&quot;id&quot;:&quot;6b5a4108-d710-4497-a555-3669e9536fa7&quot;}}" data-execution_count="58">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb68"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb68-1"><a href="#cb68-1" aria-hidden="true" tabindex="-1"></a>j2_obj <span class="op">=</span> dict2obj(j2)</span>
<span id="cb68-2"><a href="#cb68-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-3"><a href="#cb68-3" aria-hidden="true" tabindex="-1"></a>val_at(j2_obj, <span class="st">'app.Fruits.Yellow fruit.1.Banana.0'</span>)</span>
<span id="cb68-4"><a href="#cb68-4" aria-hidden="true" tabindex="-1"></a>test_eq(val_at(j2_str, <span class="st">'app.Null'</span>), <span class="va">None</span>)</span>
<span id="cb68-5"><a href="#cb68-5" aria-hidden="true" tabindex="-1"></a>test_eq(val_at(j2_str, <span class="st">'app.Boolean'</span>), <span class="va">True</span>)</span>
<span id="cb68-6"><a href="#cb68-6" aria-hidden="true" tabindex="-1"></a>test_fail(<span class="kw">lambda</span>: val_at(j2_str, <span class="st">'app.NonExistent'</span>))</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<div id="46ac2694" class="cell" data-quarto-private-1="{&quot;key&quot;:&quot;brd&quot;,&quot;value&quot;:{&quot;id&quot;:&quot;1c804134-1ae2-44f2-ab96-db92116f8864&quot;}}" data-execution_count="59">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb69"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb69-1"><a href="#cb69-1" aria-hidden="true" tabindex="-1"></a>test_eq(has_key(j2_str, <span class="st">'app.Garden.Flowers.Red flower'</span>), <span class="va">True</span>)</span>
<span id="cb69-2"><a href="#cb69-2" aria-hidden="true" tabindex="-1"></a>test_eq(has_key(j2_str, <span class="st">'app.Numbers.2'</span>), <span class="va">True</span>)</span>
<span id="cb69-3"><a href="#cb69-3" aria-hidden="true" tabindex="-1"></a>test_eq(has_key(j2_str, <span class="st">'app.Fruits.Yellow fruit.1.Banana.0'</span>), <span class="va">True</span>)</span>
<span id="cb69-4"><a href="#cb69-4" aria-hidden="true" tabindex="-1"></a>test_eq(has_key(j2_str, <span class="st">'app.NonExistent'</span>), <span class="va">False</span>)</span>
<span id="cb69-5"><a href="#cb69-5" aria-hidden="true" tabindex="-1"></a>test_eq(has_key(j2_str, <span class="st">'app.Fruits.Yellow fruit.3'</span>), <span class="va">False</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<div id="e8a6a5de" class="cell" data-quarto-private-1="{&quot;key&quot;:&quot;brd&quot;,&quot;value&quot;:{&quot;id&quot;:&quot;9b66f0d8-22d6-408c-9825-904efcc8317d&quot;}}" data-execution_count="60">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb70"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb70-1"><a href="#cb70-1" aria-hidden="true" tabindex="-1"></a>test_eq(at_(j2, <span class="st">'app[Numbers][2]'</span>), <span class="dv">3</span>)</span>
<span id="cb70-2"><a href="#cb70-2" aria-hidden="true" tabindex="-1"></a>test_eq(at_(j2, <span class="st">'app[Fruits][Yellow fruit][1][Banana][0]'</span>), <span class="st">'Canary Island'</span>)</span>
<span id="cb70-3"><a href="#cb70-3" aria-hidden="true" tabindex="-1"></a>test_eq(at_(j2, <span class="st">'app.Fruits[Yellow fruit].1.Banana[0]'</span>), <span class="st">'Canary Island'</span>)</span>
<span id="cb70-4"><a href="#cb70-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-5"><a href="#cb70-5" aria-hidden="true" tabindex="-1"></a>test_eq(at_(dict2obj(j2), <span class="st">'app[Fruits][Yellow fruit][1][Banana][0]'</span>), <span class="st">'Canary Island'</span>)</span>
<span id="cb70-6"><a href="#cb70-6" aria-hidden="true" tabindex="-1"></a>test_eq(at_(dict2obj(j2), <span class="st">'app.Fruits[Yellow fruit].1.Banana[0]'</span>), <span class="st">'Canary Island'</span>)</span>
<span id="cb70-7"><a href="#cb70-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-8"><a href="#cb70-8" aria-hidden="true" tabindex="-1"></a>test_is(at_(j2, <span class="st">'[bad][path]'</span>, <span class="st">'default'</span>), <span class="st">'default'</span>)</span>
<span id="cb70-9"><a href="#cb70-9" aria-hidden="true" tabindex="-1"></a>test_is(at_(j2, <span class="st">'[missing]'</span>, <span class="va">None</span>), <span class="va">None</span>)</span>
<span id="cb70-10"><a href="#cb70-10" aria-hidden="true" tabindex="-1"></a>test_is(at_(j2, <span class="st">'app[missing]'</span>, <span class="st">'default'</span>), <span class="st">'default'</span>)</span>
<span id="cb70-11"><a href="#cb70-11" aria-hidden="true" tabindex="-1"></a>test_is(at_(j2, <span class="st">'app[NonExistent]'</span>, <span class="va">None</span>), <span class="va">None</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<div id="5add77c4" class="cell" data-quarto-private-1="{&quot;key&quot;:&quot;brd&quot;,&quot;value&quot;:{&quot;id&quot;:&quot;82939eca-b2ec-404c-9a7f-67b2770e1af5&quot;}}" data-execution_count="61">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb71"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb71-1"><a href="#cb71-1" aria-hidden="true" tabindex="-1"></a>test_fail(<span class="kw">lambda</span>:val_at(<span class="va">None</span>, <span class="st">'0'</span>))</span>
<span id="cb71-2"><a href="#cb71-2" aria-hidden="true" tabindex="-1"></a>test_eq(val_at(<span class="va">None</span>, <span class="st">'0'</span>, <span class="va">None</span>), <span class="va">None</span>)</span>
<span id="cb71-3"><a href="#cb71-3" aria-hidden="true" tabindex="-1"></a>test_fail(<span class="kw">lambda</span>:val_atpath(<span class="va">None</span>, <span class="dv">2</span>))</span>
<span id="cb71-4"><a href="#cb71-4" aria-hidden="true" tabindex="-1"></a>test_eq(val_atpath(<span class="va">None</span>, <span class="dv">2</span>, default<span class="op">=</span><span class="va">None</span>), <span class="va">None</span>)</span>
<span id="cb71-5"><a href="#cb71-5" aria-hidden="true" tabindex="-1"></a>test_fail(<span class="kw">lambda</span>:val_atpath(<span class="va">None</span>, <span class="op">-</span><span class="dv">1</span>))</span>
<span id="cb71-6"><a href="#cb71-6" aria-hidden="true" tabindex="-1"></a>test_eq(val_atpath(<span class="va">None</span>, <span class="op">-</span><span class="dv">1</span>, default<span class="op">=</span><span class="va">None</span>), <span class="va">None</span>)</span>
<span id="cb71-7"><a href="#cb71-7" aria-hidden="true" tabindex="-1"></a>test_fail(<span class="kw">lambda</span>:val_at(<span class="va">None</span>, <span class="st">'0.1'</span>))</span>
<span id="cb71-8"><a href="#cb71-8" aria-hidden="true" tabindex="-1"></a>test_eq(val_at(<span class="va">None</span>, <span class="st">'0.1'</span>, <span class="va">None</span>), <span class="va">None</span>)</span>
<span id="cb71-9"><a href="#cb71-9" aria-hidden="true" tabindex="-1"></a>test_fail(<span class="kw">lambda</span>:val_atpath(<span class="va">None</span>, <span class="dv">4</span>, <span class="st">'b'</span>))</span>
<span id="cb71-10"><a href="#cb71-10" aria-hidden="true" tabindex="-1"></a>test_eq(val_atpath(<span class="va">None</span>, <span class="dv">4</span>, <span class="st">'b'</span>, default<span class="op">=</span><span class="va">None</span>), <span class="va">None</span>)</span>
<span id="cb71-11"><a href="#cb71-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb71-12"><a href="#cb71-12" aria-hidden="true" tabindex="-1"></a>test_fail(<span class="kw">lambda</span>:val_atpath([], <span class="dv">1</span>))</span>
<span id="cb71-13"><a href="#cb71-13" aria-hidden="true" tabindex="-1"></a>test_eq(val_atpath([], <span class="dv">1</span>, default<span class="op">=</span><span class="va">None</span>), <span class="va">None</span>)</span>
<span id="cb71-14"><a href="#cb71-14" aria-hidden="true" tabindex="-1"></a>test_fail(<span class="kw">lambda</span>:val_atpath([], <span class="st">'a'</span>, <span class="dv">2</span>))</span>
<span id="cb71-15"><a href="#cb71-15" aria-hidden="true" tabindex="-1"></a>test_eq(val_atpath([], (<span class="st">'a'</span>, <span class="dv">2</span>), default<span class="op">=</span><span class="va">None</span>), <span class="va">None</span>)  <span class="co"># type: ignore</span></span>
<span id="cb71-16"><a href="#cb71-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb71-17"><a href="#cb71-17" aria-hidden="true" tabindex="-1"></a>test_fail(<span class="kw">lambda</span>:val_atpath({}, <span class="dv">1</span>))</span>
<span id="cb71-18"><a href="#cb71-18" aria-hidden="true" tabindex="-1"></a>test_eq(val_atpath({}, <span class="dv">1</span>, default<span class="op">=</span><span class="va">None</span>), <span class="va">None</span>)</span>
<span id="cb71-19"><a href="#cb71-19" aria-hidden="true" tabindex="-1"></a>test_fail(<span class="kw">lambda</span>:val_atpath(<span class="bu">object</span>(), <span class="st">'2'</span>))</span>
<span id="cb71-20"><a href="#cb71-20" aria-hidden="true" tabindex="-1"></a>test_eq(val_at(<span class="bu">object</span>(), <span class="st">'0'</span>, <span class="va">None</span>), <span class="va">None</span>)</span>
<span id="cb71-21"><a href="#cb71-21" aria-hidden="true" tabindex="-1"></a>test_fail(<span class="kw">lambda</span>:val_at(<span class="bu">object</span>(), <span class="st">'a.1'</span>))</span>
<span id="cb71-22"><a href="#cb71-22" aria-hidden="true" tabindex="-1"></a>test_eq(val_at(<span class="bu">object</span>(), <span class="st">'a.1'</span>, <span class="va">None</span>), <span class="va">None</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<div id="c06f6646" class="cell" data-quarto-private-1="{&quot;key&quot;:&quot;brd&quot;,&quot;value&quot;:{&quot;id&quot;:&quot;e4633e4e-61f0-42fb-900e-cf3b837fd8c1&quot;}}" data-execution_count="62">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb72"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb72-1"><a href="#cb72-1" aria-hidden="true" tabindex="-1"></a>o <span class="op">=</span> [<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>, [<span class="dv">4</span>, <span class="dv">5</span>, <span class="dv">6</span>], <span class="dv">7</span>]</span>
<span id="cb72-2"><a href="#cb72-2" aria-hidden="true" tabindex="-1"></a>test_eq(val_at(o, <span class="st">'0'</span>), <span class="dv">1</span>)</span>
<span id="cb72-3"><a href="#cb72-3" aria-hidden="true" tabindex="-1"></a>test_eq(val_at(o, <span class="st">'-1'</span>), <span class="dv">7</span>)</span>
<span id="cb72-4"><a href="#cb72-4" aria-hidden="true" tabindex="-1"></a>test_eq(val_atpath(o, <span class="op">-</span><span class="dv">1</span>), <span class="dv">7</span>)</span>
<span id="cb72-5"><a href="#cb72-5" aria-hidden="true" tabindex="-1"></a>test_eq(val_atpath(o, <span class="dv">2</span>), <span class="dv">3</span>)</span>
<span id="cb72-6"><a href="#cb72-6" aria-hidden="true" tabindex="-1"></a>test_eq(val_atpath(o, <span class="dv">3</span>, <span class="dv">2</span>), <span class="dv">6</span>)</span>
<span id="cb72-7"><a href="#cb72-7" aria-hidden="true" tabindex="-1"></a>test_eq(val_atpath(o, <span class="dv">5</span>, default<span class="op">=</span><span class="va">None</span>), <span class="va">None</span>)</span>
<span id="cb72-8"><a href="#cb72-8" aria-hidden="true" tabindex="-1"></a>test_eq(val_at(o, <span class="st">'3.4'</span>, <span class="va">None</span>), <span class="va">None</span>)</span>
<span id="cb72-9"><a href="#cb72-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-10"><a href="#cb72-10" aria-hidden="true" tabindex="-1"></a>o <span class="op">=</span> <span class="bu">dict</span>(a<span class="op">=</span><span class="dv">1</span>, b<span class="op">=</span><span class="dv">2</span>, c<span class="op">=</span><span class="dv">3</span>, d<span class="op">=</span><span class="bu">dict</span>(e<span class="op">=</span><span class="dv">4</span>, f<span class="op">=</span><span class="dv">5</span>), g<span class="op">=</span><span class="dv">6</span>)</span>
<span id="cb72-11"><a href="#cb72-11" aria-hidden="true" tabindex="-1"></a>test_eq(val_atpath(o, <span class="st">'b'</span>), <span class="dv">2</span>)</span>
<span id="cb72-12"><a href="#cb72-12" aria-hidden="true" tabindex="-1"></a>test_eq(val_atpath(o, <span class="st">'d'</span>, <span class="st">'f'</span>), <span class="dv">5</span>)</span>
<span id="cb72-13"><a href="#cb72-13" aria-hidden="true" tabindex="-1"></a>test_eq(val_at(o, <span class="st">'d.f'</span>), <span class="dv">5</span>)</span>
<span id="cb72-14"><a href="#cb72-14" aria-hidden="true" tabindex="-1"></a>test_eq(val_at(o, <span class="st">'d.g'</span>, <span class="va">None</span>), <span class="va">None</span>)</span>
<span id="cb72-15"><a href="#cb72-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-16"><a href="#cb72-16" aria-hidden="true" tabindex="-1"></a>(s <span class="op">:=</span> json.dumps([<span class="st">'foo'</span>, (<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>), {<span class="st">'bar'</span>: (<span class="st">'baz'</span>, <span class="va">None</span>, <span class="fl">1.0</span>, <span class="dv">2</span>)}]))</span>
<span id="cb72-17"><a href="#cb72-17" aria-hidden="true" tabindex="-1"></a>o <span class="op">=</span> json.loads(s)</span>
<span id="cb72-18"><a href="#cb72-18" aria-hidden="true" tabindex="-1"></a>test_eq(val_at(o, <span class="st">'0'</span>), <span class="st">'foo'</span>)</span>
<span id="cb72-19"><a href="#cb72-19" aria-hidden="true" tabindex="-1"></a>test_eq(val_atpath(o, <span class="dv">0</span>), <span class="st">'foo'</span>)</span>
<span id="cb72-20"><a href="#cb72-20" aria-hidden="true" tabindex="-1"></a>test_eq(val_at(o, <span class="st">'2.bar'</span>), [<span class="st">'baz'</span>, <span class="va">None</span>, <span class="fl">1.0</span>, <span class="dv">2</span>])</span>
<span id="cb72-21"><a href="#cb72-21" aria-hidden="true" tabindex="-1"></a>test_eq(val_atpath(o, <span class="dv">2</span>, <span class="st">'bar'</span>), [<span class="st">'baz'</span>, <span class="va">None</span>, <span class="fl">1.0</span>, <span class="dv">2</span>])</span>
<span id="cb72-22"><a href="#cb72-22" aria-hidden="true" tabindex="-1"></a>test_eq(val_at(o, <span class="st">'2.bar.3'</span>), <span class="dv">2</span>)</span>
<span id="cb72-23"><a href="#cb72-23" aria-hidden="true" tabindex="-1"></a>test_eq(val_at(o, <span class="st">'3.bar'</span>, <span class="va">None</span>), <span class="va">None</span>)</span>
<span id="cb72-24"><a href="#cb72-24" aria-hidden="true" tabindex="-1"></a>test_eq(val_atpath(o, <span class="dv">2</span>, <span class="st">'foo'</span>, default<span class="op">=</span><span class="va">None</span>), <span class="va">None</span>)</span>
<span id="cb72-25"><a href="#cb72-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-26"><a href="#cb72-26" aria-hidden="true" tabindex="-1"></a><span class="at">@dataclasses.dataclass</span></span>
<span id="cb72-27"><a href="#cb72-27" aria-hidden="true" tabindex="-1"></a><span class="kw">class</span> _D:</span>
<span id="cb72-28"><a href="#cb72-28" aria-hidden="true" tabindex="-1"></a>    a: <span class="bu">int</span></span>
<span id="cb72-29"><a href="#cb72-29" aria-hidden="true" tabindex="-1"></a>    b: <span class="bu">str</span></span>
<span id="cb72-30"><a href="#cb72-30" aria-hidden="true" tabindex="-1"></a>    c: <span class="bu">float</span></span>
<span id="cb72-31"><a href="#cb72-31" aria-hidden="true" tabindex="-1"></a>    d: <span class="bu">dict</span>[<span class="bu">str</span>, Any]</span>
<span id="cb72-32"><a href="#cb72-32" aria-hidden="true" tabindex="-1"></a>_d <span class="op">=</span> _D(<span class="dv">1</span>, <span class="st">'2'</span>, <span class="fl">3.0</span>, {<span class="st">'e'</span>: <span class="dv">4</span>, <span class="st">'f'</span>: <span class="st">'5'</span>, <span class="st">'g'</span>: <span class="fl">6.0</span>})</span>
<span id="cb72-33"><a href="#cb72-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-34"><a href="#cb72-34" aria-hidden="true" tabindex="-1"></a>o <span class="op">=</span> [<span class="dv">0</span>, <span class="dv">1</span>, _d, <span class="st">'a'</span>]</span>
<span id="cb72-35"><a href="#cb72-35" aria-hidden="true" tabindex="-1"></a>test_eq(val_atpath(o, <span class="dv">1</span>), <span class="dv">1</span>)</span>
<span id="cb72-36"><a href="#cb72-36" aria-hidden="true" tabindex="-1"></a>test_eq(val_at(o, <span class="st">'3'</span>), <span class="st">'a'</span>)</span>
<span id="cb72-37"><a href="#cb72-37" aria-hidden="true" tabindex="-1"></a>test_eq(val_atpath(o, <span class="dv">2</span>), _d)</span>
<span id="cb72-38"><a href="#cb72-38" aria-hidden="true" tabindex="-1"></a>test_eq(val_at(o, <span class="st">'2.c'</span>), <span class="fl">3.0</span>)</span>
<span id="cb72-39"><a href="#cb72-39" aria-hidden="true" tabindex="-1"></a>test_eq(val_at(o, <span class="st">'2.d.f'</span>), <span class="st">'5'</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
</section>
</section>
<section id="vals_at-vals_atpath" class="level2">
<h2 class="anchored" data-anchor-id="vals_at-vals_atpath">vals_at, vals_atpath</h2>
<p>Lookup <strong>multiple</strong> values using wildcards in paths. Think of it as a lightweight JSONPath for common cases.</p>
<p><strong>When to use:</strong> Extract values from all items in a collection without explicit loops.</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb73"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb73-1"><a href="#cb73-1" aria-hidden="true" tabindex="-1"></a>data <span class="op">=</span> [</span>
<span id="cb73-2"><a href="#cb73-2" aria-hidden="true" tabindex="-1"></a>    {<span class="st">'user'</span>: {<span class="st">'name'</span>: <span class="st">'Alice'</span>, <span class="st">'age'</span>: <span class="dv">30</span>}},</span>
<span id="cb73-3"><a href="#cb73-3" aria-hidden="true" tabindex="-1"></a>    {<span class="st">'user'</span>: {<span class="st">'name'</span>: <span class="st">'Bob'</span>, <span class="st">'age'</span>: <span class="dv">25</span>}},</span>
<span id="cb73-4"><a href="#cb73-4" aria-hidden="true" tabindex="-1"></a>]</span>
<span id="cb73-5"><a href="#cb73-5" aria-hidden="true" tabindex="-1"></a>vals_at(data, <span class="st">'*.user.name'</span>)  <span class="co"># ('Alice', 'Bob')</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<p><strong>Related utilities:</strong> - <code>val_at</code> / <a href="https://civvic.github.io/pote/basic.html#val_atpath"><code>val_atpath</code></a> - Single value extraction (see above) - <code>filter_empty=True</code> parameter - Remove <code>empty</code> sentinels from results for cleaner output</p>
<hr>
<p><a href="https://github.com/civvic/pote/blob/main/pote/basic.py#L234" target="_blank" style="float:right; font-size:smaller">source</a></p>
<section id="vals_at" class="level3">
<h3 class="anchored" data-anchor-id="vals_at">vals_at</h3>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb74"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb74-1"><a href="#cb74-1" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb74-2"><a href="#cb74-2" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> vals_at(</span>
<span id="cb74-3"><a href="#cb74-3" aria-hidden="true" tabindex="-1"></a>    o, path:<span class="bu">str</span>, filter_empty:<span class="bu">bool</span><span class="op">=</span><span class="va">False</span></span>
<span id="cb74-4"><a href="#cb74-4" aria-hidden="true" tabindex="-1"></a>)<span class="op">-&gt;</span><span class="bu">tuple</span>[Any, ...]:</span>
<span id="cb74-5"><a href="#cb74-5" aria-hidden="true" tabindex="-1"></a></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<p><em>Return nested values– or empty|(empty, …)– at <code>path</code> with wildcards ’</em>’ from <code>o</code>.*</p>
<hr>
<p><a href="https://github.com/civvic/pote/blob/main/pote/basic.py#L216" target="_blank" style="float:right; font-size:smaller">source</a></p>
</section>
<section id="vals_atpath" class="level3">
<h3 class="anchored" data-anchor-id="vals_atpath">vals_atpath</h3>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb75"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb75-1"><a href="#cb75-1" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb75-2"><a href="#cb75-2" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> vals_atpath(</span>
<span id="cb75-3"><a href="#cb75-3" aria-hidden="true" tabindex="-1"></a>    o, path:Any, filter_empty:<span class="bu">bool</span><span class="op">=</span><span class="va">False</span></span>
<span id="cb75-4"><a href="#cb75-4" aria-hidden="true" tabindex="-1"></a>)<span class="op">-&gt;</span><span class="bu">tuple</span>[Any, ...]:</span>
<span id="cb75-5"><a href="#cb75-5" aria-hidden="true" tabindex="-1"></a></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<p><em>Return nested values– or empty|(empty, …)– at <code>path</code> with wildcards ’</em>’ from <code>d</code>.*</p>
<div id="fd2abaa3" class="cell" data-quarto-private-1="{&quot;key&quot;:&quot;brd&quot;,&quot;value&quot;:{&quot;id&quot;:&quot;ce212af1-26ed-4d15-991e-5fa95c998567&quot;}}" data-execution_count="64">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb76"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb76-1"><a href="#cb76-1" aria-hidden="true" tabindex="-1"></a>test_eq(vals_atpath(<span class="bu">object</span>, <span class="st">''</span>), ())</span>
<span id="cb76-2"><a href="#cb76-2" aria-hidden="true" tabindex="-1"></a>test_eq(vals_atpath(<span class="bu">object</span>, <span class="st">'a'</span>), ())</span>
<span id="cb76-3"><a href="#cb76-3" aria-hidden="true" tabindex="-1"></a>test_eq(vals_atpath(<span class="bu">object</span>, <span class="st">'*'</span>, <span class="st">'a'</span>), ())</span>
<span id="cb76-4"><a href="#cb76-4" aria-hidden="true" tabindex="-1"></a>test_eq(vals_atpath(<span class="bu">object</span>, <span class="st">'*'</span>, <span class="st">'a'</span>, <span class="st">'*'</span>), ())</span>
<span id="cb76-5"><a href="#cb76-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb76-6"><a href="#cb76-6" aria-hidden="true" tabindex="-1"></a>test_eq(vals_atpath([<span class="st">'a'</span>, <span class="st">'b'</span>], <span class="st">'a'</span>), ())</span>
<span id="cb76-7"><a href="#cb76-7" aria-hidden="true" tabindex="-1"></a>test_eq(vals_atpath([<span class="st">'a'</span>, <span class="st">'b'</span>], <span class="st">'*'</span>), (<span class="st">'a'</span>, <span class="st">'b'</span>))</span>
<span id="cb76-8"><a href="#cb76-8" aria-hidden="true" tabindex="-1"></a>test_eq(vals_atpath([<span class="st">'a'</span>, <span class="st">'b'</span>], <span class="st">'*'</span>, <span class="st">'a'</span>), ())</span>
<span id="cb76-9"><a href="#cb76-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb76-10"><a href="#cb76-10" aria-hidden="true" tabindex="-1"></a>test_eq(vals_atpath([<span class="st">'a'</span>, <span class="st">'b'</span>], <span class="dv">0</span>), (<span class="st">'a'</span>,))</span>
<span id="cb76-11"><a href="#cb76-11" aria-hidden="true" tabindex="-1"></a>test_eq(vals_atpath([<span class="st">'a'</span>, <span class="st">'b'</span>], <span class="dv">2</span>), ())</span>
<span id="cb76-12"><a href="#cb76-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb76-13"><a href="#cb76-13" aria-hidden="true" tabindex="-1"></a>test_eq(vals_atpath([{<span class="st">'a'</span>:<span class="dv">1</span>}], <span class="st">'a'</span>), ())</span>
<span id="cb76-14"><a href="#cb76-14" aria-hidden="true" tabindex="-1"></a>test_eq(vals_atpath([{<span class="st">'a'</span>:<span class="dv">1</span>}], <span class="st">'*'</span>), [{<span class="st">'a'</span>:<span class="dv">1</span>}])</span>
<span id="cb76-15"><a href="#cb76-15" aria-hidden="true" tabindex="-1"></a>test_eq(vals_atpath([{<span class="st">'a'</span>:<span class="dv">1</span>}, {<span class="st">'a'</span>:<span class="dv">2</span>}], <span class="st">'*'</span>, <span class="st">'a'</span>), (<span class="dv">1</span>, <span class="dv">2</span>))</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<div id="22be6074" class="cell" data-quarto-private-1="{&quot;key&quot;:&quot;brd&quot;,&quot;value&quot;:{&quot;id&quot;:&quot;d75ac5d2-b949-4691-a2f6-f0b075be437f&quot;}}" data-execution_count="65">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb77"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb77-1"><a href="#cb77-1" aria-hidden="true" tabindex="-1"></a>test_eq(vals_at(<span class="bu">object</span>, <span class="st">''</span>), (<span class="bu">object</span>,))</span>
<span id="cb77-2"><a href="#cb77-2" aria-hidden="true" tabindex="-1"></a>test_eq(vals_at(<span class="bu">object</span>, <span class="st">'a'</span>), ())</span>
<span id="cb77-3"><a href="#cb77-3" aria-hidden="true" tabindex="-1"></a>test_eq(vals_at(<span class="bu">object</span>, <span class="st">'*.a'</span>), ())</span>
<span id="cb77-4"><a href="#cb77-4" aria-hidden="true" tabindex="-1"></a>test_eq(vals_at(<span class="bu">object</span>, <span class="st">'*.a.*'</span>), ())</span>
<span id="cb77-5"><a href="#cb77-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb77-6"><a href="#cb77-6" aria-hidden="true" tabindex="-1"></a>test_eq(vals_at([<span class="st">'a'</span>, <span class="st">'b'</span>], <span class="st">'a'</span>), ())</span>
<span id="cb77-7"><a href="#cb77-7" aria-hidden="true" tabindex="-1"></a>test_eq(vals_at([<span class="st">'a'</span>, <span class="st">'b'</span>], <span class="st">'*'</span>), (<span class="st">'a'</span>, <span class="st">'b'</span>))</span>
<span id="cb77-8"><a href="#cb77-8" aria-hidden="true" tabindex="-1"></a>test_eq(vals_at([<span class="st">'a'</span>, <span class="st">'b'</span>], <span class="st">'*.a'</span>), ())</span>
<span id="cb77-9"><a href="#cb77-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb77-10"><a href="#cb77-10" aria-hidden="true" tabindex="-1"></a>test_eq(vals_at([<span class="st">'a'</span>, <span class="st">'b'</span>], <span class="st">'0'</span>), (<span class="st">'a'</span>,))</span>
<span id="cb77-11"><a href="#cb77-11" aria-hidden="true" tabindex="-1"></a>test_eq(vals_at([<span class="st">'a'</span>, <span class="st">'b'</span>], <span class="st">'2'</span>), ())</span>
<span id="cb77-12"><a href="#cb77-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb77-13"><a href="#cb77-13" aria-hidden="true" tabindex="-1"></a>test_eq(vals_at([{<span class="st">'a'</span>:<span class="dv">1</span>}], <span class="st">'a'</span>), ())</span>
<span id="cb77-14"><a href="#cb77-14" aria-hidden="true" tabindex="-1"></a>test_eq(vals_at([{<span class="st">'a'</span>:<span class="dv">1</span>}], <span class="st">'*'</span>), [{<span class="st">'a'</span>:<span class="dv">1</span>}])</span>
<span id="cb77-15"><a href="#cb77-15" aria-hidden="true" tabindex="-1"></a>test_eq(vals_at([{<span class="st">'a'</span>:<span class="dv">1</span>}, {<span class="st">'a'</span>:<span class="dv">2</span>}], <span class="st">'*.a'</span>), (<span class="dv">1</span>, <span class="dv">2</span>))</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<div id="d4e34af1" class="cell" data-quarto-private-1="{&quot;key&quot;:&quot;brd&quot;,&quot;value&quot;:{&quot;id&quot;:&quot;4387d882-1c15-452e-b6ae-b902f2d7b584&quot;}}" data-execution_count="66">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb78"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb78-1"><a href="#cb78-1" aria-hidden="true" tabindex="-1"></a>d <span class="op">=</span> [</span>
<span id="cb78-2"><a href="#cb78-2" aria-hidden="true" tabindex="-1"></a>    {<span class="st">'a'</span>: <span class="dv">1</span>, <span class="st">'b'</span>: [<span class="dv">2</span>,  <span class="dv">3</span>],  <span class="st">'c'</span>: {<span class="st">'d'</span>:   <span class="dv">4</span>}}, </span>
<span id="cb78-3"><a href="#cb78-3" aria-hidden="true" tabindex="-1"></a>    {<span class="st">'a'</span>: <span class="dv">5</span>, <span class="st">'b'</span>: [<span class="dv">6</span>,  <span class="dv">7</span>],                  <span class="st">'d'</span>: [{<span class="st">'e'</span>: <span class="dv">81</span>}, {<span class="st">'e'</span>: <span class="dv">82</span>}]}, </span>
<span id="cb78-4"><a href="#cb78-4" aria-hidden="true" tabindex="-1"></a>    {<span class="st">'a'</span>: <span class="dv">9</span>, <span class="st">'b'</span>: [<span class="dv">10</span>, <span class="dv">11</span>], <span class="st">'c'</span>: {<span class="st">'d'</span>: <span class="dv">12</span>}}</span>
<span id="cb78-5"><a href="#cb78-5" aria-hidden="true" tabindex="-1"></a>]</span>
<span id="cb78-6"><a href="#cb78-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb78-7"><a href="#cb78-7" aria-hidden="true" tabindex="-1"></a>test_eq(vals_atpath(d, <span class="st">''</span>), ())</span>
<span id="cb78-8"><a href="#cb78-8" aria-hidden="true" tabindex="-1"></a>test_eq(vals_atpath(d, <span class="bu">object</span>), ())  <span class="co"># type: ignore</span></span>
<span id="cb78-9"><a href="#cb78-9" aria-hidden="true" tabindex="-1"></a>test_eq(vals_atpath(d, <span class="st">'*'</span>), (<span class="op">*</span>d,))</span>
<span id="cb78-10"><a href="#cb78-10" aria-hidden="true" tabindex="-1"></a>test_eq(vals_atpath(d, <span class="dv">2</span>), (d[<span class="dv">2</span>],))</span>
<span id="cb78-11"><a href="#cb78-11" aria-hidden="true" tabindex="-1"></a>test_eq(vals_atpath(d, <span class="st">'2'</span>), ())</span>
<span id="cb78-12"><a href="#cb78-12" aria-hidden="true" tabindex="-1"></a>test_eq(vals_atpath(d, <span class="st">'a'</span>), ())</span>
<span id="cb78-13"><a href="#cb78-13" aria-hidden="true" tabindex="-1"></a>test_eq(vals_atpath([], <span class="st">'*'</span>, <span class="st">'a'</span>), ())<span class="co">#())</span></span>
<span id="cb78-14"><a href="#cb78-14" aria-hidden="true" tabindex="-1"></a>test_eq(vals_atpath([{<span class="st">'a'</span>: <span class="bu">object</span>}], <span class="st">'*'</span>, <span class="st">'a'</span>, <span class="st">'*'</span>, <span class="st">'b'</span>), ())</span>
<span id="cb78-15"><a href="#cb78-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb78-16"><a href="#cb78-16" aria-hidden="true" tabindex="-1"></a>test_eq(vals_atpath(d, <span class="st">'*'</span>, <span class="st">'a'</span>), (<span class="dv">1</span>, <span class="dv">5</span>, <span class="dv">9</span>))</span>
<span id="cb78-17"><a href="#cb78-17" aria-hidden="true" tabindex="-1"></a>test_eq(vals_atpath(d, <span class="st">'*'</span>, <span class="st">'a'</span>, <span class="st">'*'</span>), (<span class="dv">1</span>,<span class="dv">5</span>,<span class="dv">9</span>))</span>
<span id="cb78-18"><a href="#cb78-18" aria-hidden="true" tabindex="-1"></a>test_eq(vals_atpath(d, <span class="st">'*'</span>, <span class="st">'b'</span>, <span class="dv">1</span>), (<span class="dv">3</span>, <span class="dv">7</span>, <span class="dv">11</span>))</span>
<span id="cb78-19"><a href="#cb78-19" aria-hidden="true" tabindex="-1"></a>test_eq(vals_atpath(d, <span class="st">'*'</span>, <span class="st">'c'</span>, <span class="st">'d'</span>), (<span class="dv">4</span>, empty, <span class="dv">12</span>))</span>
<span id="cb78-20"><a href="#cb78-20" aria-hidden="true" tabindex="-1"></a>test_eq(vals_atpath(d, <span class="st">'*'</span>, <span class="st">'c'</span>, <span class="st">'d'</span>, filter_empty<span class="op">=</span><span class="va">True</span>), (<span class="dv">4</span>, <span class="dv">12</span>))</span>
<span id="cb78-21"><a href="#cb78-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb78-22"><a href="#cb78-22" aria-hidden="true" tabindex="-1"></a>test_eq(vals_atpath(d, <span class="st">'*'</span>, <span class="st">'d'</span>, <span class="st">'*'</span>, <span class="st">'e'</span>), (empty, (<span class="dv">81</span>, <span class="dv">82</span>), empty))</span>
<span id="cb78-23"><a href="#cb78-23" aria-hidden="true" tabindex="-1"></a>test_eq(vals_atpath(d, <span class="st">'*'</span>, <span class="st">'d'</span>, <span class="st">'*'</span>, <span class="st">'e'</span>, filter_empty<span class="op">=</span><span class="va">True</span>), ((<span class="dv">81</span>, <span class="dv">82</span>),))</span>
<span id="cb78-24"><a href="#cb78-24" aria-hidden="true" tabindex="-1"></a>test_eq(vals_atpath(d, <span class="st">'*'</span>, <span class="st">'d'</span>, <span class="st">'*'</span>, <span class="st">'f'</span>), ())</span>
<span id="cb78-25"><a href="#cb78-25" aria-hidden="true" tabindex="-1"></a>test_eq(vals_atpath(d, <span class="dv">1</span>, <span class="st">'d'</span>, <span class="st">'*'</span>, <span class="st">'e'</span>), (<span class="dv">81</span>, <span class="dv">82</span>))</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<div id="656488c8" class="cell" data-quarto-private-1="{&quot;key&quot;:&quot;brd&quot;,&quot;value&quot;:{&quot;id&quot;:&quot;1f8488df-4a3e-422d-8153-ca7bd4f7d0ac&quot;}}" data-execution_count="67">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb79"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb79-1"><a href="#cb79-1" aria-hidden="true" tabindex="-1"></a>d <span class="op">=</span> [</span>
<span id="cb79-2"><a href="#cb79-2" aria-hidden="true" tabindex="-1"></a>    {<span class="st">'a'</span>: <span class="dv">1</span>, <span class="st">'b'</span>: [<span class="dv">2</span>,  <span class="dv">3</span>],  <span class="st">'c'</span>: {<span class="st">'d'</span>:   <span class="dv">4</span>}}, </span>
<span id="cb79-3"><a href="#cb79-3" aria-hidden="true" tabindex="-1"></a>    {<span class="st">'a'</span>: <span class="dv">5</span>, <span class="st">'b'</span>: [<span class="dv">6</span>,  <span class="dv">7</span>],                  <span class="st">'d'</span>: [{<span class="st">'e'</span>: <span class="dv">81</span>}, {<span class="st">'e'</span>: <span class="dv">82</span>}]}, </span>
<span id="cb79-4"><a href="#cb79-4" aria-hidden="true" tabindex="-1"></a>    {<span class="st">'a'</span>: <span class="dv">9</span>, <span class="st">'b'</span>: [<span class="dv">10</span>, <span class="dv">11</span>], <span class="st">'c'</span>: {<span class="st">'d'</span>: <span class="dv">12</span>}}</span>
<span id="cb79-5"><a href="#cb79-5" aria-hidden="true" tabindex="-1"></a>]</span>
<span id="cb79-6"><a href="#cb79-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-7"><a href="#cb79-7" aria-hidden="true" tabindex="-1"></a>test_eq(vals_at(d, <span class="st">''</span>), (d,))</span>
<span id="cb79-8"><a href="#cb79-8" aria-hidden="true" tabindex="-1"></a>test_fail(<span class="kw">lambda</span>: vals_at(d, <span class="bu">object</span>))  <span class="co"># type: ignore</span></span>
<span id="cb79-9"><a href="#cb79-9" aria-hidden="true" tabindex="-1"></a>test_eq(vals_at(d, <span class="st">'*'</span>), (<span class="op">*</span>d,))</span>
<span id="cb79-10"><a href="#cb79-10" aria-hidden="true" tabindex="-1"></a>test_eq(vals_at(d, <span class="st">'2'</span>), (d[<span class="dv">2</span>],))</span>
<span id="cb79-11"><a href="#cb79-11" aria-hidden="true" tabindex="-1"></a>test_eq(vals_at(d, <span class="st">'a'</span>), ())</span>
<span id="cb79-12"><a href="#cb79-12" aria-hidden="true" tabindex="-1"></a>test_eq(vals_at([], <span class="st">'*.a'</span>), ())<span class="co">#())</span></span>
<span id="cb79-13"><a href="#cb79-13" aria-hidden="true" tabindex="-1"></a>test_eq(vals_at([{<span class="st">'a'</span>: <span class="bu">object</span>}], <span class="st">'*.a.*.b'</span>), ())</span>
<span id="cb79-14"><a href="#cb79-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-15"><a href="#cb79-15" aria-hidden="true" tabindex="-1"></a>test_eq(vals_at(d, <span class="st">'*,a'</span>), ())</span>
<span id="cb79-16"><a href="#cb79-16" aria-hidden="true" tabindex="-1"></a>test_eq(vals_at(d, <span class="st">'*.a'</span>), (<span class="dv">1</span>, <span class="dv">5</span>, <span class="dv">9</span>))</span>
<span id="cb79-17"><a href="#cb79-17" aria-hidden="true" tabindex="-1"></a>test_eq(vals_at(d, <span class="st">'*.a.*'</span>), (<span class="dv">1</span>,<span class="dv">5</span>,<span class="dv">9</span>))</span>
<span id="cb79-18"><a href="#cb79-18" aria-hidden="true" tabindex="-1"></a>test_eq(vals_at(d, <span class="st">'*.b.1'</span>), (<span class="dv">3</span>, <span class="dv">7</span>, <span class="dv">11</span>))</span>
<span id="cb79-19"><a href="#cb79-19" aria-hidden="true" tabindex="-1"></a>test_eq(vals_at(d, <span class="st">'*.c.d'</span>), (<span class="dv">4</span>, empty, <span class="dv">12</span>))</span>
<span id="cb79-20"><a href="#cb79-20" aria-hidden="true" tabindex="-1"></a>test_eq(vals_at(d, <span class="st">'*.c.d'</span>, filter_empty<span class="op">=</span><span class="va">True</span>), (<span class="dv">4</span>, <span class="dv">12</span>))</span>
<span id="cb79-21"><a href="#cb79-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-22"><a href="#cb79-22" aria-hidden="true" tabindex="-1"></a>test_eq(vals_at(d, <span class="st">'*.d.*.e'</span>), (empty, (<span class="dv">81</span>, <span class="dv">82</span>), empty))</span>
<span id="cb79-23"><a href="#cb79-23" aria-hidden="true" tabindex="-1"></a>test_eq(vals_at(d, <span class="st">'*.d.*.e'</span>, filter_empty<span class="op">=</span><span class="va">True</span>), ((<span class="dv">81</span>, <span class="dv">82</span>),))</span>
<span id="cb79-24"><a href="#cb79-24" aria-hidden="true" tabindex="-1"></a>test_eq(vals_at(d, <span class="st">'*.d.*.f'</span>), ())</span>
<span id="cb79-25"><a href="#cb79-25" aria-hidden="true" tabindex="-1"></a>test_eq(vals_at(d, <span class="st">'1.d.*.e'</span>), (<span class="dv">81</span>, <span class="dv">82</span>))</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
</section>
</section>
<section id="deep_in" class="level2">
<h2 class="anchored" data-anchor-id="deep_in">deep_in</h2>
<p>Check if a value exists anywhere in a nested structure (recursively searches dicts and iterables).</p>
<div id="d1c7bf30" class="cell" data-quarto-private-1="{&quot;key&quot;:&quot;brd&quot;,&quot;value&quot;:{&quot;id&quot;:&quot;8bb0fdeb-8d05-4ca0-9e05-a118262120e2&quot;}}" data-execution_count="68">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb80"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb80-1"><a href="#cb80-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> deep_in(o:Mapping<span class="op">|</span>Iterable, val):</span>
<span id="cb80-2"><a href="#cb80-2" aria-hidden="true" tabindex="-1"></a>    <span class="co">"return True if val is in nested collections"</span></span>
<span id="cb80-3"><a href="#cb80-3" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="bu">isinstance</span>(o, Mapping):</span>
<span id="cb80-4"><a href="#cb80-4" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> val <span class="kw">in</span> o.values() <span class="kw">or</span> <span class="bu">any</span>(deep_in(v, val) <span class="cf">for</span> v <span class="kw">in</span> o.values() <span class="cf">if</span> <span class="bu">isinstance</span>(v, (Mapping, Iterable)))</span>
<span id="cb80-5"><a href="#cb80-5" aria-hidden="true" tabindex="-1"></a>    <span class="cf">elif</span> <span class="bu">isinstance</span>(o, Iterable):</span>
<span id="cb80-6"><a href="#cb80-6" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> val <span class="kw">in</span> o <span class="kw">or</span> <span class="bu">any</span>(deep_in(v, val) <span class="cf">for</span> v <span class="kw">in</span> o <span class="cf">if</span> <span class="bu">isinstance</span>(v, (Mapping, Iterable)))</span>
<span id="cb80-7"><a href="#cb80-7" aria-hidden="true" tabindex="-1"></a>    <span class="cf">raise</span> <span class="pp">ValueError</span>(<span class="ss">f"deep_in: o must be a Mapping or Iterable, got </span><span class="sc">{</span><span class="bu">type</span>(o)<span class="sc">}</span><span class="ss">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<div id="d55100ce" class="cell" data-quarto-private-1="{&quot;key&quot;:&quot;brd&quot;,&quot;value&quot;:{&quot;id&quot;:&quot;c080dcce-ccbe-4d2c-aab9-8d6e184776fe&quot;}}" data-execution_count="69">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb81"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb81-1"><a href="#cb81-1" aria-hidden="true" tabindex="-1"></a>test_fail(<span class="kw">lambda</span>:deep_in(<span class="va">None</span>, <span class="dv">1</span>))  <span class="co"># type: ignore</span></span>
<span id="cb81-2"><a href="#cb81-2" aria-hidden="true" tabindex="-1"></a>test_eq(deep_in((), <span class="dv">1</span>), <span class="va">False</span>)</span>
<span id="cb81-3"><a href="#cb81-3" aria-hidden="true" tabindex="-1"></a>test_eq(deep_in((<span class="dv">1</span>,), <span class="dv">1</span>), <span class="va">True</span>)</span>
<span id="cb81-4"><a href="#cb81-4" aria-hidden="true" tabindex="-1"></a>test_eq(deep_in((<span class="dv">1</span>,), <span class="dv">2</span>), <span class="va">False</span>)</span>
<span id="cb81-5"><a href="#cb81-5" aria-hidden="true" tabindex="-1"></a>test_eq(deep_in({<span class="st">'a'</span>: <span class="dv">1</span>}, <span class="dv">1</span>), <span class="va">True</span>)</span>
<span id="cb81-6"><a href="#cb81-6" aria-hidden="true" tabindex="-1"></a>test_eq(deep_in({<span class="st">'a'</span>: <span class="dv">1</span>}, <span class="dv">2</span>), <span class="va">False</span>)</span>
<span id="cb81-7"><a href="#cb81-7" aria-hidden="true" tabindex="-1"></a>test_eq(deep_in({<span class="st">'a'</span>: (<span class="dv">1</span>,)}, <span class="dv">1</span>), <span class="va">True</span>)</span>
<span id="cb81-8"><a href="#cb81-8" aria-hidden="true" tabindex="-1"></a>test_eq(deep_in({<span class="st">'a'</span>: (<span class="dv">1</span>,)}, <span class="dv">2</span>), <span class="va">False</span>)</span>
<span id="cb81-9"><a href="#cb81-9" aria-hidden="true" tabindex="-1"></a>test_eq(deep_in({<span class="st">'a'</span>: {<span class="st">'b'</span>: <span class="dv">1</span>}}, <span class="dv">1</span>), <span class="va">True</span>)</span>
<span id="cb81-10"><a href="#cb81-10" aria-hidden="true" tabindex="-1"></a>test_eq(deep_in({<span class="st">'a'</span>: {<span class="st">'b'</span>: <span class="dv">1</span>}}, <span class="dv">2</span>), <span class="va">False</span>)</span>
<span id="cb81-11"><a href="#cb81-11" aria-hidden="true" tabindex="-1"></a>test_eq(deep_in({<span class="st">'a'</span>: {<span class="st">'b'</span>: (<span class="dv">1</span>,)}}, <span class="dv">1</span>), <span class="va">True</span>)</span>
<span id="cb81-12"><a href="#cb81-12" aria-hidden="true" tabindex="-1"></a>test_eq(deep_in({<span class="st">'a'</span>: {<span class="st">'b'</span>: (<span class="dv">1</span>,)}}, <span class="dv">2</span>), <span class="va">False</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<div id="9bbd663e" class="cell" data-quarto-private-1="{&quot;key&quot;:&quot;brd&quot;,&quot;value&quot;:{&quot;id&quot;:&quot;50882f77-8d95-47cf-a9df-0e0b8817f92c&quot;}}" data-execution_count="70">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb82"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb82-1"><a href="#cb82-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> deep_in_v1(o:Mapping<span class="op">|</span>Iterable, val):</span>
<span id="cb82-2"><a href="#cb82-2" aria-hidden="true" tabindex="-1"></a>    <span class="co">"return True if val is in o"</span></span>
<span id="cb82-3"><a href="#cb82-3" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="bu">isinstance</span>(o, Mapping):</span>
<span id="cb82-4"><a href="#cb82-4" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> v <span class="kw">in</span> o.values():</span>
<span id="cb82-5"><a href="#cb82-5" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> v <span class="op">==</span> val <span class="kw">or</span> (is_listy(v) <span class="kw">and</span> deep_in_v1(v, val)): <span class="cf">return</span> <span class="va">True</span></span>
<span id="cb82-6"><a href="#cb82-6" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> <span class="va">False</span></span>
<span id="cb82-7"><a href="#cb82-7" aria-hidden="true" tabindex="-1"></a>    <span class="cf">elif</span> <span class="bu">isinstance</span>(o, Iterable):</span>
<span id="cb82-8"><a href="#cb82-8" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> val <span class="kw">in</span> o: <span class="cf">return</span> <span class="va">True</span></span>
<span id="cb82-9"><a href="#cb82-9" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> <span class="bu">any</span>(deep_in_v1(v, val) <span class="cf">for</span> v <span class="kw">in</span> o <span class="cf">if</span> is_listy(v))</span>
<span id="cb82-10"><a href="#cb82-10" aria-hidden="true" tabindex="-1"></a>    <span class="cf">raise</span> <span class="pp">ValueError</span>(<span class="ss">f"deep_in: o must be a Mapping or Iterable, got </span><span class="sc">{</span><span class="bu">type</span>(o)<span class="sc">}</span><span class="ss">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<div id="b219f0be" class="cell" data-quarto-private-1="{&quot;key&quot;:&quot;brd&quot;,&quot;value&quot;:{&quot;id&quot;:&quot;5d951f8a-21bb-4891-8b08-68734e76dbe7&quot;}}" data-execution_count="71">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb83"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb83-1"><a href="#cb83-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> deep_in_v2(o:Mapping<span class="op">|</span>Iterable, val):</span>
<span id="cb83-2"><a href="#cb83-2" aria-hidden="true" tabindex="-1"></a>    stack <span class="op">=</span> deque([o])</span>
<span id="cb83-3"><a href="#cb83-3" aria-hidden="true" tabindex="-1"></a>    <span class="cf">while</span> stack:</span>
<span id="cb83-4"><a href="#cb83-4" aria-hidden="true" tabindex="-1"></a>        curr <span class="op">=</span> stack.popleft()</span>
<span id="cb83-5"><a href="#cb83-5" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="bu">isinstance</span>(curr, Mapping):</span>
<span id="cb83-6"><a href="#cb83-6" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> val <span class="kw">in</span> curr.values(): <span class="cf">return</span> <span class="va">True</span></span>
<span id="cb83-7"><a href="#cb83-7" aria-hidden="true" tabindex="-1"></a>            stack.extend(v <span class="cf">for</span> v <span class="kw">in</span> curr.values() <span class="cf">if</span> is_listy(v))</span>
<span id="cb83-8"><a href="#cb83-8" aria-hidden="true" tabindex="-1"></a>        <span class="cf">elif</span> <span class="bu">isinstance</span>(curr, Iterable):</span>
<span id="cb83-9"><a href="#cb83-9" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> val <span class="kw">in</span> curr: <span class="cf">return</span> <span class="va">True</span>  </span>
<span id="cb83-10"><a href="#cb83-10" aria-hidden="true" tabindex="-1"></a>            stack.extend(v <span class="cf">for</span> v <span class="kw">in</span> curr <span class="cf">if</span> is_listy(v))</span>
<span id="cb83-11"><a href="#cb83-11" aria-hidden="true" tabindex="-1"></a>        <span class="cf">else</span>:</span>
<span id="cb83-12"><a href="#cb83-12" aria-hidden="true" tabindex="-1"></a>            <span class="cf">raise</span> <span class="pp">ValueError</span>(<span class="ss">f"deep_in: o must be a Mapping or Iterable, got </span><span class="sc">{</span><span class="bu">type</span>(curr)<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb83-13"><a href="#cb83-13" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="va">False</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<div id="c90d1569" class="cell" data-quarto-private-1="{&quot;key&quot;:&quot;brd&quot;,&quot;value&quot;:{&quot;id&quot;:&quot;a3fe3a4e-4020-4191-b8a3-e5173d277d35&quot;}}" data-execution_count="72">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb84"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb84-1"><a href="#cb84-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> deep_in_v3(o:Mapping<span class="op">|</span>Iterable, val):</span>
<span id="cb84-2"><a href="#cb84-2" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> _search(obj):</span>
<span id="cb84-3"><a href="#cb84-3" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="bu">isinstance</span>(obj, Mapping):</span>
<span id="cb84-4"><a href="#cb84-4" aria-hidden="true" tabindex="-1"></a>            <span class="cf">yield</span> <span class="cf">from</span> obj.values()</span>
<span id="cb84-5"><a href="#cb84-5" aria-hidden="true" tabindex="-1"></a>            <span class="cf">for</span> v <span class="kw">in</span> obj.values():</span>
<span id="cb84-6"><a href="#cb84-6" aria-hidden="true" tabindex="-1"></a>                <span class="cf">if</span> is_listy(v): <span class="cf">yield</span> <span class="cf">from</span> _search(v)</span>
<span id="cb84-7"><a href="#cb84-7" aria-hidden="true" tabindex="-1"></a>        <span class="cf">elif</span> <span class="bu">isinstance</span>(obj, Iterable):</span>
<span id="cb84-8"><a href="#cb84-8" aria-hidden="true" tabindex="-1"></a>            <span class="cf">yield</span> <span class="cf">from</span> obj</span>
<span id="cb84-9"><a href="#cb84-9" aria-hidden="true" tabindex="-1"></a>            <span class="cf">for</span> v <span class="kw">in</span> obj:</span>
<span id="cb84-10"><a href="#cb84-10" aria-hidden="true" tabindex="-1"></a>                <span class="cf">if</span> is_listy(v): <span class="cf">yield</span> <span class="cf">from</span> _search(v)</span>
<span id="cb84-11"><a href="#cb84-11" aria-hidden="true" tabindex="-1"></a>        <span class="cf">else</span>:</span>
<span id="cb84-12"><a href="#cb84-12" aria-hidden="true" tabindex="-1"></a>            <span class="cf">raise</span> <span class="pp">ValueError</span>(<span class="ss">f"deep_in: o must be a Mapping or Iterable, got </span><span class="sc">{</span><span class="bu">type</span>(obj)<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb84-13"><a href="#cb84-13" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb84-14"><a href="#cb84-14" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> val <span class="kw">in</span> _search(o)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<div id="ad7091c9" class="cell" data-quarto-private-1="{&quot;key&quot;:&quot;brd&quot;,&quot;value&quot;:{&quot;id&quot;:&quot;85b500d9-17bc-41ff-a81f-79d532785953&quot;}}" data-execution_count="73">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb85"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb85-1"><a href="#cb85-1" aria-hidden="true" tabindex="-1"></a>test_data <span class="op">=</span> [</span>
<span id="cb85-2"><a href="#cb85-2" aria-hidden="true" tabindex="-1"></a>    ((), <span class="dv">1</span>), ((<span class="dv">1</span>,), <span class="dv">1</span>), ((<span class="dv">1</span>,), <span class="dv">2</span>), ({<span class="st">'a'</span>: <span class="dv">1</span>}, <span class="dv">1</span>), ({<span class="st">'a'</span>: <span class="dv">1</span>}, <span class="dv">2</span>),  </span>
<span id="cb85-3"><a href="#cb85-3" aria-hidden="true" tabindex="-1"></a>    ({<span class="st">'a'</span>: (<span class="dv">1</span>,)}, <span class="dv">1</span>), ({<span class="st">'a'</span>: (<span class="dv">1</span>,)}, <span class="dv">2</span>), ({<span class="st">'a'</span>: {<span class="st">'b'</span>: <span class="dv">1</span>}}, <span class="dv">1</span>), </span>
<span id="cb85-4"><a href="#cb85-4" aria-hidden="true" tabindex="-1"></a>    ({<span class="st">'a'</span>: {<span class="st">'b'</span>: <span class="dv">1</span>}}, <span class="dv">2</span>), ({<span class="st">'a'</span>: {<span class="st">'b'</span>: (<span class="dv">1</span>,)}}, <span class="dv">1</span>), ({<span class="st">'a'</span>: {<span class="st">'b'</span>: (<span class="dv">1</span>,)}}, <span class="dv">2</span>)</span>
<span id="cb85-5"><a href="#cb85-5" aria-hidden="true" tabindex="-1"></a>]</span>
<span id="cb85-6"><a href="#cb85-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb85-7"><a href="#cb85-7" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> o, val <span class="kw">in</span> test_data:</span>
<span id="cb85-8"><a href="#cb85-8" aria-hidden="true" tabindex="-1"></a>    orig <span class="op">=</span> deep_in(o, val)</span>
<span id="cb85-9"><a href="#cb85-9" aria-hidden="true" tabindex="-1"></a>    test_eq(deep_in_v1(o, val), orig)</span>
<span id="cb85-10"><a href="#cb85-10" aria-hidden="true" tabindex="-1"></a>    test_eq(deep_in_v2(o, val), orig) </span>
<span id="cb85-11"><a href="#cb85-11" aria-hidden="true" tabindex="-1"></a>    test_eq(deep_in_v3(o, val), orig)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<section id="performance-exploration" class="level3">
<h3 class="anchored" data-anchor-id="performance-exploration">Performance exploration</h3>
<p>The following cells test alternative implementations of <a href="https://civvic.github.io/pote/basic.html#deep_in"><code>deep_in</code></a> to find the best balance between clarity and speed. The chosen implementation (exported above) uses recursive traversal with early termination.</p>
<div id="bf292ef1" class="cell" data-quarto-private-1="{&quot;key&quot;:&quot;brd&quot;,&quot;value&quot;:{&quot;id&quot;:&quot;2e3ac79d-4c41-4168-828d-d451b9091593&quot;}}" data-execution_count="74">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb86"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb86-1"><a href="#cb86-1" aria-hidden="true" tabindex="-1"></a>deep_data <span class="op">=</span> {<span class="st">'level1'</span>: {<span class="st">'level2'</span>: {<span class="st">'level3'</span>: {<span class="st">'level4'</span>: [<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>, {<span class="st">'deep'</span>: <span class="st">'target'</span>}]}}}}</span>
<span id="cb86-2"><a href="#cb86-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-3"><a href="#cb86-3" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> time_function(func, data, target, iterations<span class="op">=</span><span class="dv">10000</span>):</span>
<span id="cb86-4"><a href="#cb86-4" aria-hidden="true" tabindex="-1"></a>    start <span class="op">=</span> time.time()</span>
<span id="cb86-5"><a href="#cb86-5" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> _ <span class="kw">in</span> <span class="bu">range</span>(iterations):</span>
<span id="cb86-6"><a href="#cb86-6" aria-hidden="true" tabindex="-1"></a>        func(data, target)</span>
<span id="cb86-7"><a href="#cb86-7" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> time.time() <span class="op">-</span> start</span>
<span id="cb86-8"><a href="#cb86-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-9"><a href="#cb86-9" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"</span><span class="ch">\n</span><span class="st">Performance comparison (10000 iterations):"</span>)</span>
<span id="cb86-10"><a href="#cb86-10" aria-hidden="true" tabindex="-1"></a>target <span class="op">=</span> <span class="st">'target'</span></span>
<span id="cb86-11"><a href="#cb86-11" aria-hidden="true" tabindex="-1"></a>times <span class="op">=</span> {}</span>
<span id="cb86-12"><a href="#cb86-12" aria-hidden="true" tabindex="-1"></a>times[<span class="st">'original'</span>] <span class="op">=</span> time_function(deep_in, deep_data, target)</span>
<span id="cb86-13"><a href="#cb86-13" aria-hidden="true" tabindex="-1"></a>times[<span class="st">'v1_single_iter'</span>] <span class="op">=</span> time_function(deep_in_v1, deep_data, target)</span>
<span id="cb86-14"><a href="#cb86-14" aria-hidden="true" tabindex="-1"></a>times[<span class="st">'v2_stack_based'</span>] <span class="op">=</span> time_function(deep_in_v2, deep_data, target)</span>
<span id="cb86-15"><a href="#cb86-15" aria-hidden="true" tabindex="-1"></a>times[<span class="st">'v3_generator'</span>] <span class="op">=</span> time_function(deep_in_v3, deep_data, target)</span>
<span id="cb86-16"><a href="#cb86-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-17"><a href="#cb86-17" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> name, t <span class="kw">in</span> times.items():</span>
<span id="cb86-18"><a href="#cb86-18" aria-hidden="true" tabindex="-1"></a>    speedup <span class="op">=</span> times[<span class="st">'original'</span>] <span class="op">/</span> t <span class="cf">if</span> t <span class="op">&gt;</span> <span class="dv">0</span> <span class="cf">else</span> <span class="bu">float</span>(<span class="st">'inf'</span>)</span>
<span id="cb86-19"><a href="#cb86-19" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="ss">f"</span><span class="sc">{</span>name<span class="sc">:15}</span><span class="ss">: </span><span class="sc">{</span>t<span class="sc">:.4f}</span><span class="ss">s (speedup: </span><span class="sc">{</span>speedup<span class="sc">:.2f}</span><span class="ss">x)"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Performance comparison (10000 iterations):
original       : 0.0899s (speedup: 1.00x)
v1_single_iter : 0.0554s (speedup: 1.62x)
v2_stack_based : 0.0628s (speedup: 1.43x)
v3_generator   : 0.0764s (speedup: 1.18x)</code></pre>
</div>
</div>
<hr>
<p><a href="https://github.com/civvic/pote/blob/main/pote/basic.py#L242" target="_blank" style="float:right; font-size:smaller">source</a></p>
</section>
<section id="deep_in-1" class="level3">
<h3 class="anchored" data-anchor-id="deep_in-1">deep_in</h3>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb88"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb88-1"><a href="#cb88-1" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb88-2"><a href="#cb88-2" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> deep_in(</span>
<span id="cb88-3"><a href="#cb88-3" aria-hidden="true" tabindex="-1"></a>    o:Mapping \<span class="op">|</span> Iterable, val</span>
<span id="cb88-4"><a href="#cb88-4" aria-hidden="true" tabindex="-1"></a>):</span>
<span id="cb88-5"><a href="#cb88-5" aria-hidden="true" tabindex="-1"></a></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<p><em>return True if val is in nested collections</em></p>
</section>
</section>
</section>
<section id="dictionary-helpers" class="level1">
<h1>Dictionary Helpers</h1>
<p>Utilities for common dictionary operations: bulk popping, getting multiple keys, conditional updates.</p>
<section id="pops_" class="level2">
<h2 class="anchored" data-anchor-id="pops_">pops_</h2>
<p>Pop multiple keys from a dict into a new dict. Useful for extracting specific kwargs or splitting a config dict.</p>
<p><strong>Related:</strong> <a href="https://civvic.github.io/pote/basic.html#pops_values_"><code>pops_values_</code></a> returns a tuple of values instead of a dict; <a href="https://civvic.github.io/pote/basic.html#gets"><code>gets</code></a> for non-destructive retrieval.</p>
<hr>
<p><a href="https://github.com/civvic/pote/blob/main/pote/basic.py#L254" target="_blank" style="float:right; font-size:smaller">source</a></p>
<section id="pops_-1" class="level3">
<h3 class="anchored" data-anchor-id="pops_-1">pops_</h3>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb89"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb89-1"><a href="#cb89-1" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-2"><a href="#cb89-2" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> pops_(</span>
<span id="cb89-3"><a href="#cb89-3" aria-hidden="true" tabindex="-1"></a>    d:<span class="bu">dict</span>, ks:Hashable</span>
<span id="cb89-4"><a href="#cb89-4" aria-hidden="true" tabindex="-1"></a>)<span class="op">-&gt;</span><span class="bu">dict</span>:</span>
<span id="cb89-5"><a href="#cb89-5" aria-hidden="true" tabindex="-1"></a></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<p><em>Pop existing <code>ks</code> items from <code>d</code> in-place into a dictionary.</em></p>
<div id="0f029827" class="cell" data-quarto-private-1="{&quot;key&quot;:&quot;brd&quot;,&quot;value&quot;:{&quot;id&quot;:&quot;a54e68bf-250b-4c98-953f-6c263e8ac857&quot;}}" data-execution_count="77">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb90"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb90-1"><a href="#cb90-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Usage: extract specific keys from a dict</span></span>
<span id="cb90-2"><a href="#cb90-2" aria-hidden="true" tabindex="-1"></a>d <span class="op">=</span> {<span class="st">'a'</span>: <span class="dv">1</span>, <span class="st">'b'</span>: <span class="dv">2</span>, <span class="st">'c'</span>: <span class="dv">3</span>}</span>
<span id="cb90-3"><a href="#cb90-3" aria-hidden="true" tabindex="-1"></a>extracted <span class="op">=</span> pops_(d, <span class="st">'a'</span>, <span class="st">'b'</span>)</span>
<span id="cb90-4"><a href="#cb90-4" aria-hidden="true" tabindex="-1"></a>test_eq(extracted, {<span class="st">'a'</span>: <span class="dv">1</span>, <span class="st">'b'</span>: <span class="dv">2</span>})</span>
<span id="cb90-5"><a href="#cb90-5" aria-hidden="true" tabindex="-1"></a>test_eq(d, {<span class="st">'c'</span>: <span class="dv">3</span>})  <span class="co"># original dict modified</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<div id="15cf5bd7" class="cell" data-quarto-private-1="{&quot;key&quot;:&quot;brd&quot;,&quot;value&quot;:{&quot;id&quot;:&quot;b4231609-fcf3-4931-9f90-4eb4d3fcc2db&quot;}}" data-execution_count="78">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb91"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb91-1"><a href="#cb91-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Coverage: missing keys, empty dict, duplicates</span></span>
<span id="cb91-2"><a href="#cb91-2" aria-hidden="true" tabindex="-1"></a>test_eq(pops_({<span class="st">'a'</span>: <span class="dv">1</span>, <span class="st">'b'</span>: <span class="dv">2</span>, <span class="st">'c'</span>: <span class="dv">3</span>}, <span class="st">'d'</span>), {})  <span class="co"># missing keys ignored</span></span>
<span id="cb91-3"><a href="#cb91-3" aria-hidden="true" tabindex="-1"></a>test_eq(pops_({<span class="st">'a'</span>: <span class="dv">1</span>, <span class="st">'b'</span>: <span class="dv">2</span>, <span class="st">'c'</span>: <span class="dv">3</span>}, <span class="st">'a'</span>, <span class="st">'c'</span>, <span class="st">'d'</span>), {<span class="st">'a'</span>: <span class="dv">1</span>, <span class="st">'c'</span>: <span class="dv">3</span>})  <span class="co"># some missing</span></span>
<span id="cb91-4"><a href="#cb91-4" aria-hidden="true" tabindex="-1"></a>test_eq(pops_({}, <span class="st">'a'</span>), {})  <span class="co"># empty dict</span></span>
<span id="cb91-5"><a href="#cb91-5" aria-hidden="true" tabindex="-1"></a>test_eq(pops_({<span class="st">'a'</span>: <span class="dv">1</span>}, <span class="st">'a'</span>, <span class="st">'a'</span>), {<span class="st">'a'</span>: <span class="dv">1</span>})  <span class="co"># duplicate keys</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
</section>
</section>
<section id="pops_values_" class="level2">
<h2 class="anchored" data-anchor-id="pops_values_">pops_values_</h2>
<p>Like <a href="https://civvic.github.io/pote/basic.html#pops_"><code>pops_</code></a> but returns a tuple of values instead of a dict. Missing keys get <code>Parameter.empty</code> as placeholder. Useful for unpacking: <code>a, b, c = pops_values_(d, 'a', 'b', 'c')</code></p>
<p><strong>Related:</strong> <a href="https://civvic.github.io/pote/basic.html#pops_"><code>pops_</code></a> returns a dict; <a href="https://civvic.github.io/pote/basic.html#gets"><code>gets</code></a> for non-destructive retrieval.</p>
<hr>
<p><a href="https://github.com/civvic/pote/blob/main/pote/basic.py#L259" target="_blank" style="float:right; font-size:smaller">source</a></p>
<section id="pops_values_-1" class="level3">
<h3 class="anchored" data-anchor-id="pops_values_-1">pops_values_</h3>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb92"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb92-1"><a href="#cb92-1" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb92-2"><a href="#cb92-2" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> pops_values_(</span>
<span id="cb92-3"><a href="#cb92-3" aria-hidden="true" tabindex="-1"></a>    d:<span class="bu">dict</span>, ks:Hashable</span>
<span id="cb92-4"><a href="#cb92-4" aria-hidden="true" tabindex="-1"></a>)<span class="op">-&gt;</span><span class="bu">tuple</span>:</span>
<span id="cb92-5"><a href="#cb92-5" aria-hidden="true" tabindex="-1"></a></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<p><em>Pop existing <code>ks</code> items from <code>d</code> in-place into a tuple of values or <code>Parameter.empty</code> for missing keys.</em></p>
<div id="47ed5a66" class="cell" data-quarto-private-1="{&quot;key&quot;:&quot;brd&quot;,&quot;value&quot;:{&quot;id&quot;:&quot;2fb80faa-d7f9-48c8-a9e0-731a310f6f44&quot;}}" data-execution_count="80">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb93"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb93-1"><a href="#cb93-1" aria-hidden="true" tabindex="-1"></a>test_eq(pops_values_({<span class="st">'a'</span>: <span class="dv">1</span>, <span class="st">'b'</span>: <span class="dv">2</span>, <span class="st">'c'</span>: <span class="dv">3</span>}, <span class="st">'a'</span>, <span class="st">'b'</span>), (<span class="dv">1</span>, <span class="dv">2</span>))</span>
<span id="cb93-2"><a href="#cb93-2" aria-hidden="true" tabindex="-1"></a>test_eq(pops_values_({<span class="st">'a'</span>: <span class="dv">1</span>, <span class="st">'b'</span>: <span class="dv">2</span>, <span class="st">'c'</span>: <span class="dv">3</span>}, <span class="st">'d'</span>), (Parameter.empty,))</span>
<span id="cb93-3"><a href="#cb93-3" aria-hidden="true" tabindex="-1"></a>test_eq(pops_values_({<span class="st">'a'</span>: <span class="dv">1</span>, <span class="st">'b'</span>: <span class="dv">2</span>, <span class="st">'c'</span>: <span class="dv">3</span>}, <span class="st">'a'</span>, <span class="st">'c'</span>, <span class="st">'d'</span>), (<span class="dv">1</span>, <span class="dv">3</span>, Parameter.empty))</span>
<span id="cb93-4"><a href="#cb93-4" aria-hidden="true" tabindex="-1"></a>test_eq(pops_values_({}, <span class="st">'a'</span>), (Parameter.empty,))</span>
<span id="cb93-5"><a href="#cb93-5" aria-hidden="true" tabindex="-1"></a>test_eq(pops_values_({<span class="st">'a'</span>: <span class="dv">1</span>}, <span class="st">'a'</span>, <span class="st">'a'</span>), (<span class="dv">1</span>, Parameter.empty))</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
</section>
</section>
<section id="gets" class="level2">
<h2 class="anchored" data-anchor-id="gets">gets</h2>
<p>Fetch multiple values from a dict as a tuple. Missing keys return <code>Parameter.empty</code>. Useful for unpacking multiple config values at once.</p>
<p><strong>Related:</strong> <a href="https://civvic.github.io/pote/basic.html#pops_"><code>pops_</code></a> / <a href="https://civvic.github.io/pote/basic.html#pops_values_"><code>pops_values_</code></a> for destructive (modifying) retrieval.</p>
<hr>
<p><a href="https://github.com/civvic/pote/blob/main/pote/basic.py#L264" target="_blank" style="float:right; font-size:smaller">source</a></p>
<section id="gets-1" class="level3">
<h3 class="anchored" data-anchor-id="gets-1">gets</h3>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb94"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb94-1"><a href="#cb94-1" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb94-2"><a href="#cb94-2" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> gets(</span>
<span id="cb94-3"><a href="#cb94-3" aria-hidden="true" tabindex="-1"></a>    d:Mapping, ks:Hashable</span>
<span id="cb94-4"><a href="#cb94-4" aria-hidden="true" tabindex="-1"></a>):</span>
<span id="cb94-5"><a href="#cb94-5" aria-hidden="true" tabindex="-1"></a></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<p><em>Fetches <code>ks</code> values, or <code>Parameter.empty</code> for missing keys, from <code>d</code> into a tuple.</em></p>
<div id="42e99660" class="cell" data-quarto-private-1="{&quot;key&quot;:&quot;brd&quot;,&quot;value&quot;:{&quot;id&quot;:&quot;537f2df6-8713-4381-8eb6-f553c144a409&quot;}}" data-execution_count="82">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb95"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb95-1"><a href="#cb95-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Usage: unpack multiple config values at once</span></span>
<span id="cb95-2"><a href="#cb95-2" aria-hidden="true" tabindex="-1"></a>config <span class="op">=</span> {<span class="st">'host'</span>: <span class="st">'localhost'</span>, <span class="st">'port'</span>: <span class="dv">8080</span>, <span class="st">'debug'</span>: <span class="va">True</span>}</span>
<span id="cb95-3"><a href="#cb95-3" aria-hidden="true" tabindex="-1"></a>host, port <span class="op">=</span> gets(config, <span class="st">'host'</span>, <span class="st">'port'</span>)</span>
<span id="cb95-4"><a href="#cb95-4" aria-hidden="true" tabindex="-1"></a>test_eq((host, port), (<span class="st">'localhost'</span>, <span class="dv">8080</span>))</span>
<span id="cb95-5"><a href="#cb95-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb95-6"><a href="#cb95-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Missing keys return Parameter.empty</span></span>
<span id="cb95-7"><a href="#cb95-7" aria-hidden="true" tabindex="-1"></a>test_eq(gets({<span class="st">'a'</span>: <span class="dv">1</span>, <span class="st">'b'</span>: <span class="dv">2</span>}, <span class="st">'a'</span>, <span class="st">'c'</span>, <span class="st">'b'</span>), (<span class="dv">1</span>, Parameter.empty, <span class="dv">2</span>))</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<div id="74fcfd56" class="cell" data-quarto-private-1="{&quot;key&quot;:&quot;brd&quot;,&quot;value&quot;:{&quot;id&quot;:&quot;39477ac7-6eaf-432b-bcff-b7205bcdba55&quot;}}" data-execution_count="83">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb96"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb96-1"><a href="#cb96-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Coverage: empty args, Path keys, reordering</span></span>
<span id="cb96-2"><a href="#cb96-2" aria-hidden="true" tabindex="-1"></a>test_eq(gets({<span class="st">'a'</span>: <span class="dv">1</span>, <span class="st">'b'</span>: <span class="dv">2</span>}), ())  <span class="co"># no keys requested</span></span>
<span id="cb96-3"><a href="#cb96-3" aria-hidden="true" tabindex="-1"></a>a, b <span class="op">=</span> gets({<span class="st">'a'</span>: <span class="dv">1</span>, <span class="st">'b'</span>: <span class="dv">2</span>}, <span class="st">'b'</span>, <span class="st">'a'</span>)  <span class="co"># reordered</span></span>
<span id="cb96-4"><a href="#cb96-4" aria-hidden="true" tabindex="-1"></a>test_eq((a, b), (<span class="dv">2</span>, <span class="dv">1</span>))</span>
<span id="cb96-5"><a href="#cb96-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb96-6"><a href="#cb96-6" aria-hidden="true" tabindex="-1"></a>d <span class="op">=</span> {Path(<span class="st">'a'</span>): <span class="dv">1</span>, Path(<span class="st">'b'</span>): <span class="dv">2</span>}  <span class="co"># non-string keys</span></span>
<span id="cb96-7"><a href="#cb96-7" aria-hidden="true" tabindex="-1"></a>test_eq(gets(d, Path(<span class="st">'a'</span>), Path(<span class="st">'c'</span>), Path(<span class="st">'b'</span>)), (<span class="dv">1</span>, Parameter.empty, <span class="dv">2</span>))</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
</section>
</section>
<section id="update_" class="level2">
<h2 class="anchored" data-anchor-id="update_">update_</h2>
<p>Update dict/object with kwargs, skipping values equal to <code>empty_value</code>. Useful for conditional updates where you don’t want to set <code>None</code> or other sentinel values.</p>
<div id="9406395b" class="cell" data-quarto-private-1="{&quot;key&quot;:&quot;brd&quot;,&quot;value&quot;:{&quot;id&quot;:&quot;06221cde-27b8-4714-8afe-235c2a5e509a&quot;}}" data-execution_count="84">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb97"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb97-1"><a href="#cb97-1" aria-hidden="true" tabindex="-1"></a><span class="co"># def update_(d:dict|None=None, /, empty_value=None, **kwargs):</span></span>
<span id="cb97-2"><a href="#cb97-2" aria-hidden="true" tabindex="-1"></a><span class="co">#     "Update `d` in-place with `kwargs` whose values aren't `empty_value`"</span></span>
<span id="cb97-3"><a href="#cb97-3" aria-hidden="true" tabindex="-1"></a><span class="co">#     d = d if d is not None else {}</span></span>
<span id="cb97-4"><a href="#cb97-4" aria-hidden="true" tabindex="-1"></a><span class="co">#     for k, v in kwargs.items():</span></span>
<span id="cb97-5"><a href="#cb97-5" aria-hidden="true" tabindex="-1"></a><span class="co">#         if v is not empty_value: d[k] = v</span></span>
<span id="cb97-6"><a href="#cb97-6" aria-hidden="true" tabindex="-1"></a><span class="co">#     return d</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<hr>
<p><a href="https://github.com/civvic/pote/blob/main/pote/basic.py#L269" target="_blank" style="float:right; font-size:smaller">source</a></p>
<section id="update_-1" class="level3">
<h3 class="anchored" data-anchor-id="update_-1">update_</h3>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb98"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb98-1"><a href="#cb98-1" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb98-2"><a href="#cb98-2" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> update_(</span>
<span id="cb98-3"><a href="#cb98-3" aria-hidden="true" tabindex="-1"></a>    dest:NoneType<span class="op">=</span><span class="va">None</span>, empty_value:NoneType<span class="op">=</span><span class="va">None</span>, kwargs:VAR_KEYWORD</span>
<span id="cb98-4"><a href="#cb98-4" aria-hidden="true" tabindex="-1"></a>)<span class="op">-&gt;</span>Any:</span>
<span id="cb98-5"><a href="#cb98-5" aria-hidden="true" tabindex="-1"></a></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<p><em>Update <code>dest</code> in-place with <code>kwargs</code> whose values aren’t <code>empty_value</code></em></p>
<p>Helper for conditionally updating dictionaries/namespaces.</p>
<div id="3465b9e4" class="cell" data-quarto-private-1="{&quot;key&quot;:&quot;brd&quot;,&quot;value&quot;:{&quot;id&quot;:&quot;11706105-880c-4a17-ae01-36bc0666c9d1&quot;}}" data-execution_count="86">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb99"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb99-1"><a href="#cb99-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Usage: conditionally update dict (skip None by default)</span></span>
<span id="cb99-2"><a href="#cb99-2" aria-hidden="true" tabindex="-1"></a>d <span class="op">=</span> {<span class="st">'a'</span>: <span class="dv">1</span>}</span>
<span id="cb99-3"><a href="#cb99-3" aria-hidden="true" tabindex="-1"></a>update_(d, b<span class="op">=</span><span class="dv">2</span>, c<span class="op">=</span><span class="va">None</span>)</span>
<span id="cb99-4"><a href="#cb99-4" aria-hidden="true" tabindex="-1"></a>test_eq(d, {<span class="st">'a'</span>: <span class="dv">1</span>, <span class="st">'b'</span>: <span class="dv">2</span>})  <span class="co"># c=None was skipped</span></span>
<span id="cb99-5"><a href="#cb99-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb99-6"><a href="#cb99-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Custom empty_value sentinel</span></span>
<span id="cb99-7"><a href="#cb99-7" aria-hidden="true" tabindex="-1"></a>d <span class="op">=</span> {}</span>
<span id="cb99-8"><a href="#cb99-8" aria-hidden="true" tabindex="-1"></a>update_(d, a<span class="op">=</span><span class="va">True</span>, b<span class="op">=</span>Parameter.empty, empty_value<span class="op">=</span>Parameter.empty)</span>
<span id="cb99-9"><a href="#cb99-9" aria-hidden="true" tabindex="-1"></a>test_eq(d, {<span class="st">'a'</span>: <span class="va">True</span>})  <span class="co"># b was skipped</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<div id="7de803db" class="cell" data-quarto-private-1="{&quot;key&quot;:&quot;brd&quot;,&quot;value&quot;:{&quot;id&quot;:&quot;1f70e871-261e-4028-8d7c-27f03c3bbe81&quot;}}" data-execution_count="87">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb100"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb100-1"><a href="#cb100-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Works with objects too (uses setattr)</span></span>
<span id="cb100-2"><a href="#cb100-2" aria-hidden="true" tabindex="-1"></a><span class="kw">class</span> Config: host <span class="op">=</span> <span class="st">'localhost'</span><span class="op">;</span> port <span class="op">=</span> <span class="dv">8000</span></span>
<span id="cb100-3"><a href="#cb100-3" aria-hidden="true" tabindex="-1"></a>cfg <span class="op">=</span> update_(Config(), host<span class="op">=</span><span class="st">'0.0.0.0'</span>, timeout<span class="op">=</span><span class="va">None</span>)</span>
<span id="cb100-4"><a href="#cb100-4" aria-hidden="true" tabindex="-1"></a>test_eq(cfg.host, <span class="st">'0.0.0.0'</span>)</span>
<span id="cb100-5"><a href="#cb100-5" aria-hidden="true" tabindex="-1"></a>test_eq(cfg.port, <span class="dv">8000</span>)  <span class="co"># unchanged</span></span>
<span id="cb100-6"><a href="#cb100-6" aria-hidden="true" tabindex="-1"></a>test_is(<span class="bu">hasattr</span>(cfg, <span class="st">'timeout'</span>), <span class="va">False</span>)  <span class="co"># None was skipped</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<div id="f7e00b76" class="cell" data-quarto-private-1="{&quot;key&quot;:&quot;brd&quot;,&quot;value&quot;:{&quot;id&quot;:&quot;94af8d44-619e-4244-9e99-522cd055f7ab&quot;}}" data-execution_count="88">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb101"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb101-1"><a href="#cb101-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Coverage: create new dict, AD dict</span></span>
<span id="cb101-2"><a href="#cb101-2" aria-hidden="true" tabindex="-1"></a>d <span class="op">=</span> update_(a<span class="op">=</span><span class="dv">1</span>, b<span class="op">=</span><span class="va">None</span>)  <span class="co"># dest=None creates new dict</span></span>
<span id="cb101-3"><a href="#cb101-3" aria-hidden="true" tabindex="-1"></a>test_eq(d, {<span class="st">'a'</span>: <span class="dv">1</span>})</span>
<span id="cb101-4"><a href="#cb101-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb101-5"><a href="#cb101-5" aria-hidden="true" tabindex="-1"></a>ad <span class="op">=</span> AD(a<span class="op">=</span><span class="dv">1</span>, b<span class="op">=</span><span class="dv">2</span>)</span>
<span id="cb101-6"><a href="#cb101-6" aria-hidden="true" tabindex="-1"></a>update_(ad, a<span class="op">=</span><span class="dv">3</span>, b<span class="op">=</span><span class="dv">4</span>, c<span class="op">=</span><span class="dv">5</span>)</span>
<span id="cb101-7"><a href="#cb101-7" aria-hidden="true" tabindex="-1"></a>test_eq(ad.a, <span class="dv">3</span>)</span>
<span id="cb101-8"><a href="#cb101-8" aria-hidden="true" tabindex="-1"></a>test_eq(ad.c, <span class="dv">5</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<div id="b7a3da40" class="cell" data-quarto-private-1="{&quot;key&quot;:&quot;brd&quot;,&quot;value&quot;:{&quot;id&quot;:&quot;e042c436-9bf5-4e93-aa24-69e9dd411e60&quot;}}" data-execution_count="89">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb102"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb102-1"><a href="#cb102-1" aria-hidden="true" tabindex="-1"></a>ad <span class="op">=</span> AD(a<span class="op">=</span><span class="dv">1</span>, b<span class="op">=</span><span class="dv">2</span>)</span>
<span id="cb102-2"><a href="#cb102-2" aria-hidden="true" tabindex="-1"></a>update_(ad, a<span class="op">=</span><span class="dv">3</span>, b<span class="op">=</span><span class="dv">4</span>, c<span class="op">=</span><span class="dv">5</span>)</span>
<span id="cb102-3"><a href="#cb102-3" aria-hidden="true" tabindex="-1"></a>test_eq(ad.a, <span class="dv">3</span>)</span>
<span id="cb102-4"><a href="#cb102-4" aria-hidden="true" tabindex="-1"></a>test_eq(ad.b, <span class="dv">4</span>)</span>
<span id="cb102-5"><a href="#cb102-5" aria-hidden="true" tabindex="-1"></a>test_eq(ad.c, <span class="dv">5</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
</section>
</section>
</section>
<section id="get_globals" class="level1">
<h1>_get_globals</h1>
<p>Internal utility for accessing the caller’s global namespace. This enables functions to dynamically resolve names from the calling module’s context, useful for metaprogramming and dynamic imports.</p>
<p><strong>Note:</strong> This is an internal helper (marked <code>#| exporti</code>). Most users won’t need it directly.</p>
<div id="a5bdf5c4" class="cell" data-quarto-private-1="{&quot;key&quot;:&quot;brd&quot;,&quot;value&quot;:{&quot;id&quot;:&quot;9a636fa7-c413-49ab-b876-cf05e1bbc888&quot;}}" data-execution_count="91">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb103"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb103-1"><a href="#cb103-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> _gtest(): <span class="cf">return</span> _get_globals(<span class="va">__name__</span>)</span>
<span id="cb103-2"><a href="#cb103-2" aria-hidden="true" tabindex="-1"></a>g1 <span class="op">=</span> _gtest()</span>
<span id="cb103-3"><a href="#cb103-3" aria-hidden="true" tabindex="-1"></a>g2 <span class="op">=</span> <span class="bu">globals</span>()</span>
<span id="cb103-4"><a href="#cb103-4" aria-hidden="true" tabindex="-1"></a>test_eq(g1, g2)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
</section>
<section id="path-utilities" class="level1">
<h1>Path Utilities</h1>
<section id="bundle_path" class="level2">
<h2 class="anchored" data-anchor-id="bundle_path">bundle_path</h2>
<p>Get the directory containing a module. Useful for finding resources bundled with your package.</p>
<hr>
<p><a href="https://github.com/civvic/pote/blob/main/pote/basic.py#L285" target="_blank" style="float:right; font-size:smaller">source</a></p>
<section id="bundle_path-1" class="level3">
<h3 class="anchored" data-anchor-id="bundle_path-1">bundle_path</h3>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb104"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb104-1"><a href="#cb104-1" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb104-2"><a href="#cb104-2" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> bundle_path(</span>
<span id="cb104-3"><a href="#cb104-3" aria-hidden="true" tabindex="-1"></a>    mod:<span class="bu">str</span> \<span class="op">|</span> ModuleType</span>
<span id="cb104-4"><a href="#cb104-4" aria-hidden="true" tabindex="-1"></a>):</span>
<span id="cb104-5"><a href="#cb104-5" aria-hidden="true" tabindex="-1"></a></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<p><em>Return the path to the module’s directory or current directory.</em></p>
<div id="54705d47" class="cell" data-quarto-private-1="{&quot;key&quot;:&quot;brd&quot;,&quot;value&quot;:{&quot;id&quot;:&quot;67bf5525-8c4a-4f3a-b8f3-865f9eae795b&quot;}}" data-execution_count="93">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb105"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb105-1"><a href="#cb105-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pote</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<div id="634b238e" class="cell" data-quarto-private-1="{&quot;key&quot;:&quot;brd&quot;,&quot;value&quot;:{&quot;id&quot;:&quot;e0594d10-1d51-46fe-866e-edc52b5e53a6&quot;}}" data-execution_count="94">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb106"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb106-1"><a href="#cb106-1" aria-hidden="true" tabindex="-1"></a>test_eq(bundle_path(<span class="va">__name__</span>), Path(<span class="st">'.'</span>))</span>
<span id="cb106-2"><a href="#cb106-2" aria-hidden="true" tabindex="-1"></a>test_eq(bundle_path(<span class="st">'pote'</span>).resolve(), Path(pote.<span class="va">__file__</span>).parent)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
</section>
</section>
</section>
<section id="id-generation" class="level1">
<h1>ID Generation</h1>
<p>Utilities for generating unique identifiers in the current session.</p>
<section id="kounter" class="level2">
<h2 class="anchored" data-anchor-id="kounter">Kounter</h2>
<p>A callable counter that increments and returns the count for each key. Useful for generating sequential IDs grouped by type.</p>
<hr>
<p><a href="https://github.com/civvic/pote/blob/main/pote/basic.py#L291" target="_blank" style="float:right; font-size:smaller">source</a></p>
<section id="kounter-1" class="level3">
<h3 class="anchored" data-anchor-id="kounter-1">Kounter</h3>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb107"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb107-1"><a href="#cb107-1" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb107-2"><a href="#cb107-2" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> Kounter(</span>
<span id="cb107-3"><a href="#cb107-3" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb107-4"><a href="#cb107-4" aria-hidden="true" tabindex="-1"></a>):</span>
<span id="cb107-5"><a href="#cb107-5" aria-hidden="true" tabindex="-1"></a></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<p><em>Initialize self. See help(type(self)) for accurate signature.</em></p>
<div id="abddb425" class="cell" data-quarto-private-1="{&quot;key&quot;:&quot;brd&quot;,&quot;value&quot;:{&quot;id&quot;:&quot;4ad830d2-c907-4aee-99e0-61843089d28a&quot;}}" data-execution_count="96">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb108"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb108-1"><a href="#cb108-1" aria-hidden="true" tabindex="-1"></a>kounter <span class="op">=</span> Kounter()</span>
<span id="cb108-2"><a href="#cb108-2" aria-hidden="true" tabindex="-1"></a>cntr <span class="op">=</span> Kounter()</span>
<span id="cb108-3"><a href="#cb108-3" aria-hidden="true" tabindex="-1"></a>cntr(<span class="st">'a'</span>)</span>
<span id="cb108-4"><a href="#cb108-4" aria-hidden="true" tabindex="-1"></a>cntr(<span class="st">'b'</span>)</span>
<span id="cb108-5"><a href="#cb108-5" aria-hidden="true" tabindex="-1"></a>cntr(<span class="st">'a'</span>)</span>
<span id="cb108-6"><a href="#cb108-6" aria-hidden="true" tabindex="-1"></a>cntr(<span class="st">'a'</span>)</span>
<span id="cb108-7"><a href="#cb108-7" aria-hidden="true" tabindex="-1"></a>cntr(<span class="st">'b'</span>)</span>
<span id="cb108-8"><a href="#cb108-8" aria-hidden="true" tabindex="-1"></a>cntr(<span class="st">'b'</span>)</span>
<span id="cb108-9"><a href="#cb108-9" aria-hidden="true" tabindex="-1"></a>cntr(<span class="st">'b'</span>)</span>
<span id="cb108-10"><a href="#cb108-10" aria-hidden="true" tabindex="-1"></a>test_eq(cntr.d, {<span class="st">'a'</span>: <span class="dv">3</span>, <span class="st">'b'</span>: <span class="dv">4</span>})</span>
<span id="cb108-11"><a href="#cb108-11" aria-hidden="true" tabindex="-1"></a>test_eq(cntr(<span class="st">'int'</span>), <span class="dv">1</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
</section>
</section>
<section id="id_gen" class="level2">
<h2 class="anchored" data-anchor-id="id_gen">id_gen</h2>
<p>Create a function that generates unique IDs for objects. Without arguments returns a random ID, with an object returns <code>TypeName_N</code> where N increments per type.</p>
<div id="535801a4" class="cell" data-quarto-private-1="{&quot;key&quot;:&quot;brd&quot;,&quot;value&quot;:{&quot;id&quot;:&quot;d3c27827-fc49-4a5d-9f7c-b6ff4a969d07&quot;}}" data-execution_count="97">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb109"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb109-1"><a href="#cb109-1" aria-hidden="true" tabindex="-1"></a>lines <span class="op">=</span> Path(<span class="st">"static/wordlist.txt"</span>).read_text().splitlines()</span>
<span id="cb109-2"><a href="#cb109-2" aria-hidden="true" tabindex="-1"></a>words <span class="op">=</span> [line.strip() <span class="cf">for</span> line <span class="kw">in</span> lines <span class="cf">if</span> line.isalpha()]</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<div id="bb0c152d" class="cell" data-quarto-private-1="{&quot;key&quot;:&quot;brd&quot;,&quot;value&quot;:{&quot;id&quot;:&quot;42a33312-fe66-447d-be34-c7c8262d1164&quot;}}" data-execution_count="98">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb110"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb110-1"><a href="#cb110-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> modify_word(word):</span>
<span id="cb110-2"><a href="#cb110-2" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Randomly capitalize the first or second letter</span></span>
<span id="cb110-3"><a href="#cb110-3" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="bu">len</span>(word) <span class="op">&gt;</span> <span class="dv">1</span>:</span>
<span id="cb110-4"><a href="#cb110-4" aria-hidden="true" tabindex="-1"></a>        idx_to_capitalize <span class="op">=</span> random.choice([<span class="dv">0</span>, <span class="dv">1</span>])</span>
<span id="cb110-5"><a href="#cb110-5" aria-hidden="true" tabindex="-1"></a>        word <span class="op">=</span> word[:idx_to_capitalize] <span class="op">+</span> word[idx_to_capitalize].upper() <span class="op">+</span> word[idx_to_capitalize <span class="op">+</span> <span class="dv">1</span>:]</span>
<span id="cb110-6"><a href="#cb110-6" aria-hidden="true" tabindex="-1"></a>    <span class="cf">else</span>:</span>
<span id="cb110-7"><a href="#cb110-7" aria-hidden="true" tabindex="-1"></a>        word <span class="op">=</span> word.upper()  <span class="co"># If single letter, capitalize it</span></span>
<span id="cb110-8"><a href="#cb110-8" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb110-9"><a href="#cb110-9" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Randomly add a number (0–99) at the start or end</span></span>
<span id="cb110-10"><a href="#cb110-10" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> random.choice([<span class="va">True</span>, <span class="va">False</span>]):</span>
<span id="cb110-11"><a href="#cb110-11" aria-hidden="true" tabindex="-1"></a>        number <span class="op">=</span> random.randint(<span class="dv">0</span>, <span class="dv">99</span>)</span>
<span id="cb110-12"><a href="#cb110-12" aria-hidden="true" tabindex="-1"></a>        <span class="co"># if random.choice([True, False]):</span></span>
<span id="cb110-13"><a href="#cb110-13" aria-hidden="true" tabindex="-1"></a>        <span class="co">#     word = f"{number}{word}"  # Number at the start</span></span>
<span id="cb110-14"><a href="#cb110-14" aria-hidden="true" tabindex="-1"></a>        <span class="co"># else:</span></span>
<span id="cb110-15"><a href="#cb110-15" aria-hidden="true" tabindex="-1"></a>        word <span class="op">=</span> <span class="ss">f"</span><span class="sc">{</span>word<span class="sc">}{</span>number<span class="sc">}</span><span class="ss">"</span>  <span class="co"># Number at the end</span></span>
<span id="cb110-16"><a href="#cb110-16" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb110-17"><a href="#cb110-17" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> word</span>
<span id="cb110-18"><a href="#cb110-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb110-19"><a href="#cb110-19" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> generate_readable_id(num_words<span class="op">=</span><span class="dv">3</span>):</span>
<span id="cb110-20"><a href="#cb110-20" aria-hidden="true" tabindex="-1"></a>    words_part <span class="op">=</span> [modify_word(random.choice(words)) <span class="cf">for</span> _ <span class="kw">in</span> <span class="bu">range</span>(num_words)]</span>
<span id="cb110-21"><a href="#cb110-21" aria-hidden="true" tabindex="-1"></a>    id_candidate <span class="op">=</span> <span class="st">'-'</span>.join(words_part)</span>
<span id="cb110-22"><a href="#cb110-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb110-23"><a href="#cb110-23" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Ensure it's a valid CSS identifier</span></span>
<span id="cb110-24"><a href="#cb110-24" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="kw">not</span> re.match(<span class="vs">r"</span><span class="dv">^</span><span class="pp">[a-zA-Z_][</span><span class="dv">\w</span><span class="ch">\-</span><span class="pp">]</span><span class="op">*</span><span class="dv">$</span><span class="vs">"</span>, id_candidate):  <span class="co"># Add '_' if invalid</span></span>
<span id="cb110-25"><a href="#cb110-25" aria-hidden="true" tabindex="-1"></a>        id_candidate <span class="op">=</span> <span class="ss">f"_</span><span class="sc">{</span>id_candidate<span class="sc">}</span><span class="ss">"</span></span>
<span id="cb110-26"><a href="#cb110-26" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb110-27"><a href="#cb110-27" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="ss">f"</span><span class="sc">{</span>id_candidate<span class="sc">}</span><span class="ss">-</span><span class="sc">{</span>random<span class="sc">.</span>randint(<span class="dv">0</span>, <span class="dv">9999</span>)<span class="sc">}</span><span class="ss">"</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<div id="0b54a691" class="cell" data-quarto-private-1="{&quot;key&quot;:&quot;brd&quot;,&quot;value&quot;:{&quot;id&quot;:&quot;73cfde78-18c4-4c08-84ce-d48fb5b42996&quot;}}" data-execution_count="99">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb111"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb111-1"><a href="#cb111-1" aria-hidden="true" tabindex="-1"></a>generate_readable_id(), generate_readable_id()</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-display" data-execution_count="99">
<pre><code>('sEssions-Proportion4-rEminds-1249', 'rApidly37-Not-mEeting-8905')</code></pre>
</div>
</div>
<hr>
<p><a href="https://github.com/civvic/pote/blob/main/pote/basic.py#L299" target="_blank" style="float:right; font-size:smaller">source</a></p>
<section id="id_gen-1" class="level3">
<h3 class="anchored" data-anchor-id="id_gen-1">id_gen</h3>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb113"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb113-1"><a href="#cb113-1" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb113-2"><a href="#cb113-2" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> id_gen(</span>
<span id="cb113-3"><a href="#cb113-3" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb113-4"><a href="#cb113-4" aria-hidden="true" tabindex="-1"></a>):</span>
<span id="cb113-5"><a href="#cb113-5" aria-hidden="true" tabindex="-1"></a></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<hr>
<p><a href="https://github.com/civvic/pote/blob/main/pote/basic.py#L296" target="_blank" style="float:right; font-size:smaller">source</a></p>
</section>
<section id="simple_id" class="level3">
<h3 class="anchored" data-anchor-id="simple_id">simple_id</h3>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb114"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb114-1"><a href="#cb114-1" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb114-2"><a href="#cb114-2" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> simple_id(</span>
<span id="cb114-3"><a href="#cb114-3" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb114-4"><a href="#cb114-4" aria-hidden="true" tabindex="-1"></a>):</span>
<span id="cb114-5"><a href="#cb114-5" aria-hidden="true" tabindex="-1"></a></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<p>The <a href="https://civvic.github.io/pote/basic.html#id_gen"><code>id_gen</code></a> function creates a function that takes any object and generates an unique Id valid during the current session. Useful for creating unique element IDs in dynamic HTML content.</p>
<div id="d41eeabb" class="cell" data-quarto-private-1="{&quot;key&quot;:&quot;brd&quot;,&quot;value&quot;:{&quot;id&quot;:&quot;b4d2b3b6-2620-45e6-a2ca-8f58b4a2de1a&quot;}}" data-execution_count="101">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb115"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb115-1"><a href="#cb115-1" aria-hidden="true" tabindex="-1"></a>new_id <span class="op">=</span> id_gen()</span>
<span id="cb115-2"><a href="#cb115-2" aria-hidden="true" tabindex="-1"></a>new_id(), new_id()</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-display" data-execution_count="101">
<pre><code>('b0b32310b-f0774158-a0c54127-c5617c81',
 'b9e8bcb6f-9d75594a-dfc71bee-4edd51bc')</code></pre>
</div>
</div>
<div id="e515c079" class="cell" data-quarto-private-1="{&quot;key&quot;:&quot;brd&quot;,&quot;value&quot;:{&quot;id&quot;:&quot;91cb414b-28cb-464b-9c9e-18d0dcfbede9&quot;}}" data-execution_count="102">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb117"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb117-1"><a href="#cb117-1" aria-hidden="true" tabindex="-1"></a>int_id <span class="op">=</span> id_gen()</span>
<span id="cb117-2"><a href="#cb117-2" aria-hidden="true" tabindex="-1"></a>int_id(<span class="dv">7</span>), int_id(<span class="dv">8</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-display" data-execution_count="102">
<pre><code>('int_1', 'int_2')</code></pre>
</div>
</div>
<div id="d251c8de" class="cell" data-quarto-private-1="{&quot;key&quot;:&quot;brd&quot;,&quot;value&quot;:{&quot;id&quot;:&quot;186aeda3-a06f-4acb-ba4f-4c48794d11d9&quot;}}" data-execution_count="103">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb119"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb119-1"><a href="#cb119-1" aria-hidden="true" tabindex="-1"></a>obj_id <span class="op">=</span> id_gen()</span>
<span id="cb119-2"><a href="#cb119-2" aria-hidden="true" tabindex="-1"></a>o1, o2 <span class="op">=</span> <span class="bu">object</span>(), <span class="bu">object</span>()</span>
<span id="cb119-3"><a href="#cb119-3" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(obj_id(o1), obj_id(o2))</span>
<span id="cb119-4"><a href="#cb119-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb119-5"><a href="#cb119-5" aria-hidden="true" tabindex="-1"></a>dict_id <span class="op">=</span> id_gen()</span>
<span id="cb119-6"><a href="#cb119-6" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(dict_id(d1 <span class="op">:=</span> {<span class="st">'a'</span>: <span class="dv">1</span>}), dict_id(d2 <span class="op">:=</span> {<span class="st">'a'</span>: <span class="dv">1</span>}))</span>
<span id="cb119-7"><a href="#cb119-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb119-8"><a href="#cb119-8" aria-hidden="true" tabindex="-1"></a>pth_id <span class="op">=</span> id_gen()</span>
<span id="cb119-9"><a href="#cb119-9" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(pth_id(Path(<span class="st">'.'</span>)), pth_id(Path()), pth_id(Path(<span class="st">'./bin'</span>)))</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>object_1 object_2
dict_1 dict_2
PosixPath_1 PosixPath_2 PosixPath_3</code></pre>
</div>
</div>
</section>
</section>
</section>
<section id="metaclasses" class="level1">
<h1>Metaclasses</h1>
<section id="withcountermeta" class="level2">
<h2 class="anchored" data-anchor-id="withcountermeta">WithCounterMeta</h2>
<p>A metaclass that adds automatic instance counting. Each instance gets a <code>_cnt_</code> attribute with its creation order number.</p>
<hr>
<p><a href="https://github.com/civvic/pote/blob/main/pote/basic.py#L308" target="_blank" style="float:right; font-size:smaller">source</a></p>
<section id="withcountermeta-1" class="level3">
<h3 class="anchored" data-anchor-id="withcountermeta-1">WithCounterMeta</h3>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb121"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb121-1"><a href="#cb121-1" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb121-2"><a href="#cb121-2" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> WithCounterMeta(</span>
<span id="cb121-3"><a href="#cb121-3" aria-hidden="true" tabindex="-1"></a>    args:VAR_POSITIONAL, kwargs:VAR_KEYWORD</span>
<span id="cb121-4"><a href="#cb121-4" aria-hidden="true" tabindex="-1"></a>):</span>
<span id="cb121-5"><a href="#cb121-5" aria-hidden="true" tabindex="-1"></a></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<p><em>Adds a <code>_cnt_</code> attribute to its classes and increments it for each new instance.</em></p>
<div id="22124d15" class="cell" data-quarto-private-1="{&quot;key&quot;:&quot;brd&quot;,&quot;value&quot;:{&quot;id&quot;:&quot;044cf841-04c4-4f2f-8905-684da87a148c&quot;}}" data-execution_count="105">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb122"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb122-1"><a href="#cb122-1" aria-hidden="true" tabindex="-1"></a><span class="kw">class</span> _T1(metaclass<span class="op">=</span>WithCounterMeta): <span class="cf">pass</span></span>
<span id="cb122-2"><a href="#cb122-2" aria-hidden="true" tabindex="-1"></a><span class="kw">class</span> _T2(metaclass<span class="op">=</span>WithCounterMeta): <span class="cf">pass</span></span>
<span id="cb122-3"><a href="#cb122-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb122-4"><a href="#cb122-4" aria-hidden="true" tabindex="-1"></a>test_is(_T1._cnt_, <span class="dv">0</span>)</span>
<span id="cb122-5"><a href="#cb122-5" aria-hidden="true" tabindex="-1"></a>test_is(_T2._cnt_, <span class="dv">0</span>)</span>
<span id="cb122-6"><a href="#cb122-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb122-7"><a href="#cb122-7" aria-hidden="true" tabindex="-1"></a>test_is(_T1()._cnt_, <span class="dv">0</span>)</span>
<span id="cb122-8"><a href="#cb122-8" aria-hidden="true" tabindex="-1"></a>test_is(_T1._cnt_, <span class="dv">1</span>)</span>
<span id="cb122-9"><a href="#cb122-9" aria-hidden="true" tabindex="-1"></a>test_is(_T2._cnt_, <span class="dv">0</span>)</span>
<span id="cb122-10"><a href="#cb122-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb122-11"><a href="#cb122-11" aria-hidden="true" tabindex="-1"></a>test_is(_T1()._cnt_, <span class="dv">1</span>)</span>
<span id="cb122-12"><a href="#cb122-12" aria-hidden="true" tabindex="-1"></a>test_is(_T2()._cnt_, <span class="dv">0</span>)</span>
<span id="cb122-13"><a href="#cb122-13" aria-hidden="true" tabindex="-1"></a>test_eq(_T1._cnt_, <span class="dv">2</span>)</span>
<span id="cb122-14"><a href="#cb122-14" aria-hidden="true" tabindex="-1"></a>test_eq(_T2._cnt_, <span class="dv">1</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<hr>
<!-- # Colophon -->


</section>
</section>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
  window.document.addEventListener("DOMContentLoaded", function (event) {
    const icon = "";
    const anchorJS = new window.AnchorJS();
    anchorJS.options = {
      placement: 'right',
      icon: icon
    };
    anchorJS.add('.anchored');
    const isCodeAnnotation = (el) => {
      for (const clz of el.classList) {
        if (clz.startsWith('code-annotation-')) {                     
          return true;
        }
      }
      return false;
    }
    const onCopySuccess = function(e) {
      // button target
      const button = e.trigger;
      // don't keep focus
      button.blur();
      // flash "checked"
      button.classList.add('code-copy-button-checked');
      var currentTitle = button.getAttribute("title");
      button.setAttribute("title", "Copied!");
      let tooltip;
      if (window.bootstrap) {
        button.setAttribute("data-bs-toggle", "tooltip");
        button.setAttribute("data-bs-placement", "left");
        button.setAttribute("data-bs-title", "Copied!");
        tooltip = new bootstrap.Tooltip(button, 
          { trigger: "manual", 
            customClass: "code-copy-button-tooltip",
            offset: [0, -8]});
        tooltip.show();    
      }
      setTimeout(function() {
        if (tooltip) {
          tooltip.hide();
          button.removeAttribute("data-bs-title");
          button.removeAttribute("data-bs-toggle");
          button.removeAttribute("data-bs-placement");
        }
        button.setAttribute("title", currentTitle);
        button.classList.remove('code-copy-button-checked');
      }, 1000);
      // clear code selection
      e.clearSelection();
    }
    const getTextToCopy = function(trigger) {
      const outerScaffold = trigger.parentElement.cloneNode(true);
      const codeEl = outerScaffold.querySelector('code');
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
    const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
      text: getTextToCopy
    });
    clipboard.on('success', onCopySuccess);
    if (window.document.getElementById('quarto-embedded-source-code-modal')) {
      const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
        text: getTextToCopy,
        container: window.document.getElementById('quarto-embedded-source-code-modal')
      });
      clipboardModal.on('success', onCopySuccess);
    }
      var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
      var mailtoRegex = new RegExp(/^mailto:/);
        var filterRegex = new RegExp("https:\/\/civvic\.github\.io\/pote");
      var isInternal = (href) => {
          return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
      }
      // Inspect non-navigation links and adorn them if external
     var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
      for (var i=0; i<links.length; i++) {
        const link = links[i];
        if (!isInternal(link.href)) {
          // undo the damage that might have been done by quarto-nav.js in the case of
          // links that we want to consider external
          if (link.dataset.originalHref !== undefined) {
            link.href = link.dataset.originalHref;
          }
        }
      }
    function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
      const config = {
        allowHTML: true,
        maxWidth: 500,
        delay: 100,
        arrow: false,
        appendTo: function(el) {
            return el.parentElement;
        },
        interactive: true,
        interactiveBorder: 10,
        theme: 'quarto',
        placement: 'bottom-start',
      };
      if (contentFn) {
        config.content = contentFn;
      }
      if (onTriggerFn) {
        config.onTrigger = onTriggerFn;
      }
      if (onUntriggerFn) {
        config.onUntrigger = onUntriggerFn;
      }
      window.tippy(el, config); 
    }
    const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
    for (var i=0; i<noterefs.length; i++) {
      const ref = noterefs[i];
      tippyHover(ref, function() {
        // use id or data attribute instead here
        let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
        try { href = new URL(href).hash; } catch {}
        const id = href.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note) {
          return note.innerHTML;
        } else {
          return "";
        }
      });
    }
    const xrefs = window.document.querySelectorAll('a.quarto-xref');
    const processXRef = (id, note) => {
      // Strip column container classes
      const stripColumnClz = (el) => {
        el.classList.remove("page-full", "page-columns");
        if (el.children) {
          for (const child of el.children) {
            stripColumnClz(child);
          }
        }
      }
      stripColumnClz(note)
      if (id === null || id.startsWith('sec-')) {
        // Special case sections, only their first couple elements
        const container = document.createElement("div");
        if (note.children && note.children.length > 2) {
          container.appendChild(note.children[0].cloneNode(true));
          for (let i = 1; i < note.children.length; i++) {
            const child = note.children[i];
            if (child.tagName === "P" && child.innerText === "") {
              continue;
            } else {
              container.appendChild(child.cloneNode(true));
              break;
            }
          }
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(container);
          }
          return container.innerHTML
        } else {
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(note);
          }
          return note.innerHTML;
        }
      } else {
        // Remove any anchor links if they are present
        const anchorLink = note.querySelector('a.anchorjs-link');
        if (anchorLink) {
          anchorLink.remove();
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        if (note.classList.contains("callout")) {
          return note.outerHTML;
        } else {
          return note.innerHTML;
        }
      }
    }
    for (var i=0; i<xrefs.length; i++) {
      const xref = xrefs[i];
      tippyHover(xref, undefined, function(instance) {
        instance.disable();
        let url = xref.getAttribute('href');
        let hash = undefined; 
        if (url.startsWith('#')) {
          hash = url;
        } else {
          try { hash = new URL(url).hash; } catch {}
        }
        if (hash) {
          const id = hash.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          if (note !== null) {
            try {
              const html = processXRef(id, note.cloneNode(true));
              instance.setContent(html);
            } finally {
              instance.enable();
              instance.show();
            }
          } else {
            // See if we can fetch this
            fetch(url.split('#')[0])
            .then(res => res.text())
            .then(html => {
              const parser = new DOMParser();
              const htmlDoc = parser.parseFromString(html, "text/html");
              const note = htmlDoc.getElementById(id);
              if (note !== null) {
                const html = processXRef(id, note);
                instance.setContent(html);
              } 
            }).finally(() => {
              instance.enable();
              instance.show();
            });
          }
        } else {
          // See if we can fetch a full url (with no hash to target)
          // This is a special case and we should probably do some content thinning / targeting
          fetch(url)
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.querySelector('main.content');
            if (note !== null) {
              // This should only happen for chapter cross references
              // (since there is no id in the URL)
              // remove the first header
              if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
                note.children[0].remove();
              }
              const html = processXRef(null, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      }, function(instance) {
      });
    }
        let selectedAnnoteEl;
        const selectorForAnnotation = ( cell, annotation) => {
          let cellAttr = 'data-code-cell="' + cell + '"';
          let lineAttr = 'data-code-annotation="' +  annotation + '"';
          const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
          return selector;
        }
        const selectCodeLines = (annoteEl) => {
          const doc = window.document;
          const targetCell = annoteEl.getAttribute("data-target-cell");
          const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
          const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
          const lines = annoteSpan.getAttribute("data-code-lines").split(",");
          const lineIds = lines.map((line) => {
            return targetCell + "-" + line;
          })
          let top = null;
          let height = null;
          let parent = null;
          if (lineIds.length > 0) {
              //compute the position of the single el (top and bottom and make a div)
              const el = window.document.getElementById(lineIds[0]);
              top = el.offsetTop;
              height = el.offsetHeight;
              parent = el.parentElement.parentElement;
            if (lineIds.length > 1) {
              const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
              const bottom = lastEl.offsetTop + lastEl.offsetHeight;
              height = bottom - top;
            }
            if (top !== null && height !== null && parent !== null) {
              // cook up a div (if necessary) and position it 
              let div = window.document.getElementById("code-annotation-line-highlight");
              if (div === null) {
                div = window.document.createElement("div");
                div.setAttribute("id", "code-annotation-line-highlight");
                div.style.position = 'absolute';
                parent.appendChild(div);
              }
              div.style.top = top - 2 + "px";
              div.style.height = height + 4 + "px";
              div.style.left = 0;
              let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
              if (gutterDiv === null) {
                gutterDiv = window.document.createElement("div");
                gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
                gutterDiv.style.position = 'absolute';
                const codeCell = window.document.getElementById(targetCell);
                const gutter = codeCell.querySelector('.code-annotation-gutter');
                gutter.appendChild(gutterDiv);
              }
              gutterDiv.style.top = top - 2 + "px";
              gutterDiv.style.height = height + 4 + "px";
            }
            selectedAnnoteEl = annoteEl;
          }
        };
        const unselectCodeLines = () => {
          const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
          elementsIds.forEach((elId) => {
            const div = window.document.getElementById(elId);
            if (div) {
              div.remove();
            }
          });
          selectedAnnoteEl = undefined;
        };
          // Handle positioning of the toggle
      window.addEventListener(
        "resize",
        throttle(() => {
          elRect = undefined;
          if (selectedAnnoteEl) {
            selectCodeLines(selectedAnnoteEl);
          }
        }, 10)
      );
      function throttle(fn, ms) {
      let throttle = false;
      let timer;
        return (...args) => {
          if(!throttle) { // first call gets through
              fn.apply(this, args);
              throttle = true;
          } else { // all the others get throttled
              if(timer) clearTimeout(timer); // cancel #2
              timer = setTimeout(() => {
                fn.apply(this, args);
                timer = throttle = false;
              }, ms);
          }
        };
      }
        // Attach click handler to the DT
        const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
        for (const annoteDlNode of annoteDls) {
          annoteDlNode.addEventListener('click', (event) => {
            const clickedEl = event.target;
            if (clickedEl !== selectedAnnoteEl) {
              unselectCodeLines();
              const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
              if (activeEl) {
                activeEl.classList.remove('code-annotation-active');
              }
              selectCodeLines(clickedEl);
              clickedEl.classList.add('code-annotation-active');
            } else {
              // Unselect the line
              unselectCodeLines();
              clickedEl.classList.remove('code-annotation-active');
            }
          });
        }
    const findCites = (el) => {
      const parentEl = el.parentElement;
      if (parentEl) {
        const cites = parentEl.dataset.cites;
        if (cites) {
          return {
            el,
            cites: cites.split(' ')
          };
        } else {
          return findCites(el.parentElement)
        }
      } else {
        return undefined;
      }
    };
    var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
    for (var i=0; i<bibliorefs.length; i++) {
      const ref = bibliorefs[i];
      const citeInfo = findCites(ref);
      if (citeInfo) {
        tippyHover(citeInfo.el, function() {
          var popup = window.document.createElement('div');
          citeInfo.cites.forEach(function(cite) {
            var citeDiv = window.document.createElement('div');
            citeDiv.classList.add('hanging-indent');
            citeDiv.classList.add('csl-entry');
            var biblioDiv = window.document.getElementById('ref-' + cite);
            if (biblioDiv) {
              citeDiv.innerHTML = biblioDiv.innerHTML;
            }
            popup.appendChild(citeDiv);
          });
          return popup.innerHTML;
        });
      }
    }
  });
  </script>
</div> <!-- /content -->




<footer class="footer"><div class="nav-footer"><div class="nav-footer-center"><div class="toc-actions d-sm-block d-md-none"><ul><li><a href="https://github.com/civvic/pote/issues/new" class="toc-action"><i class="bi bi-github"></i>Report an issue</a></li></ul></div></div></div></footer></body></html>